

% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{Active spectroscopy methodology: information-optimal probing, frequency-domain identification, and control-oriented surrogates}

We formalize pulsed SAI as an active-sensing experiment designed to extract the climate system's frequency-dependent gains, lags, and nonlinear distortions with minimal intrusion. Let the control input be the global-equivalent sulfur injection rate, decomposed as
\begin{equation}
u(t) \;=\; u_0 \;+\; \delta u(t), \qquad \mathrm{rms}(\delta u)\in[0.05,0.5]\ \mathrm{TgS\,yr^{-1}},
\end{equation}
superimposed on a steady baseline $u_0$ (e.g., $5\ \mathrm{TgS\,yr^{-1}}$). Outputs include global-mean surface temperature (GMST), regional precipitation indices, circulation metrics, and stratospheric aerosol optical depth (SAOD), all routinely simulated in intermediate and comprehensive Earth system models with interactive aerosols and chemistry \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}. The central premise is that frequency-domain system identification under designed perturbations is the most direct and data-efficient approach to learn control-relevant dynamics \cite{ljung1999system,pintelon2012system} and to support closed-loop SAI design \cite{macmartin2014dynamicsof}.

\paragraph{Information-optimal probe design}
We excite the system with multi-sine, chirp, and pseudo-random binary sequences (PRBS) over monthly-to-interannual bands ($f_k\in[0.02,2]$ cycles yr$^{-1}$):
\begin{equation}
\delta u(t) \;=\; \sum_{k=1}^{K} a_k \sin\!\big(2\pi f_k t + \phi_k\big) \;+\; \mathrm{PRBS}(t) \;+\; \mathrm{chirp}(t).
\end{equation}
Phases $\{\phi_k\}$ are chosen to minimize the crest factor $CF(\delta u)=\|\delta u\|_\infty/\mathrm{rms}(\delta u)$ (reducing instantaneous extremes), while amplitudes $\{a_k\}$ target bands with favorable signal-to-noise ratio (SNR) under internal variability. We cast input design as a constrained Fisher-information maximization \cite{ljung1999system,pintelon2012system}:
\begin{align}
\max_{\{a_k,\phi_k\}} \;\; & \Phi\!\left(\mathcal{I}(\theta)\right) \quad \text{s.t.} \quad \mathrm{rms}(\delta u)\leq A_{\max},\ \ CF(\delta u)\leq C_{\max}, \nonumber\\
& \mathrm{SAOD}(t;\delta u)\leq \mathrm{SAOD}_{\max},\ \ \Delta\mathrm{O}_3(\delta u)\leq \Delta\mathrm{O}_3^{\max},
\label{eq:OID}
\end{align}
where $\theta$ are parameters of a chosen surrogate (e.g., rational FRF), $\mathcal{I}(\theta)$ is the Fisher information matrix aggregated over excited lines $\{f_k\}$ with noise power spectral density $S_{\varepsilon\varepsilon}(\omega)$ estimated from control runs, and $\Phi$ is an A- or D-optimal criterion. The environmental constraints reflect risk-aware bounds on SAOD and ozone perturbations as characterized in SAI protocols and assessments \cite{tilmes2018stratospheric,richter2022assessingresponses,robock200820reasons}. For nonstationary noise and leakage control, experiments use multi-taper windowing and line-synchronized observation windows to preserve spectral orthogonality \cite{pintelon2012system}.

\paragraph{Frequency-response estimation}
Assuming local linearity around $u_0$, the output spectrum decomposes as
\begin{equation}
Y(\omega) \;=\; G(\omega)U(\omega) + \varepsilon(\omega),
\end{equation}
with complex frequency response $G(\omega)$. We estimate the frequency response function (FRF) at excited lines via spectral regression \cite{pintelon2012system}:
\begin{equation}
\widehat{G}(\omega_k) \;=\; \frac{\widehat{S}_{yu}(\omega_k)}{\widehat{S}_{uu}(\omega_k)}, \qquad
\gamma^2(\omega_k) \;=\; \frac{|\widehat{S}_{yu}(\omega_k)|^2}{\widehat{S}_{uu}(\omega_k)\,\widehat{S}_{yy}(\omega_k)},
\label{eq:FRFest}
\end{equation}
where $\widehat{S}_{\cdot\cdot}$ are multi-taper cross/auto-spectral estimates and $\gamma^2$ is the magnitude-squared coherence used for quality control and uncertainty quantification. Confidence intervals follow standard large-sample approximations with degrees of freedom set by the number of tapers, segments, and ensemble members \cite{pintelon2012system}. We subsequently fit stable, low-order rational models $G(z^{-1};\theta)$ to $\{\widehat{G}(\omega_k)\}$ to obtain compact, control-ready surrogates \cite{ljung1999system}.

\paragraph{Nonlinear distortion characterization}
To capture harmonic and intermodulation effects induced by state dependence and feedbacks, we augment the linear surrogate with a second-order Volterra model \cite{ljung1999system}:
\begin{equation}
y[n] \;=\; \sum_{\tau} h_1[\tau]\,u[n-\tau] \;+\; \sum_{\tau_1}\sum_{\tau_2} h_2[\tau_1,\tau_2]\,u[n-\tau_1]\,u[n-\tau_2] \;+\; e[n],
\label{eq:Volterra}
\end{equation}
estimated via sparsity-promoting regression on polynomial-convolution features to recover the dominant kernels with limited data. Harmonic distortion is summarized by
\begin{equation}
\mathrm{HDI}(f_k) \;=\; \frac{\sum_{m\ge 2} |Y(m f_k)|^2}{|Y(f_k)|^2}, \qquad
\mathrm{IMD}(f_i,f_j) \;=\; \frac{|Y(f_i\!+\!f_j)|^2+|Y(|f_i\!-\!f_j|)|^2}{|Y(f_i)|^2+|Y(f_j)|^2},
\end{equation}
computed at spectral lines generated by the input set. Validation uses held-out single-tone tests to assess coherence, normalized RMSE, and cross-frequency prediction error.

\paragraph{Control synthesis from identified surrogates}
Using the fitted $G(z^{-1})$ and, when beneficial, a quadratic Volterra correction linearized along the operating trajectory, we synthesize controllers that trade off GMST tracking, regional hydrological stability, and actuation economy, complementing prior closed-loop SAI studies \cite{macmartin2014dynamicsof}. We consider:
\begin{itemize}
\item H-infinity mixed-sensitivity design minimizing $\|T_{zw}\|_\infty$ for a generalized plant $P$ with weights $W_T$ (tracking error), $W_P$ (penalizing regional precipitation variance proxies), and $W_U$ (injection variability), implemented on a stable rational fit of $\widehat{G}$.
\item Constrained MPC with horizon $H$, cost
$J=\sum_{t=0}^{H-1}\big\|y_t-y_t^\star\big\|_Q^2 + \|\Delta u_t\|_R^2$,
and linear inequality constraints enforcing SAOD bounds and regional anomaly limits, with robustness to model mismatch via tube or stochastic MPC formulations.
\end{itemize}
Controllers are benchmarked against continuous and naive pulsed baselines under internal variability and scenario shocks (e.g., volcano analogs) in ensemble simulations \cite{tilmes2018stratospheric,richter2022assessingresponses}. Performance metrics include tracking RMSE, constraint violation rate, controller effort (TV norm), worst-case regional anomaly, and regret relative to an oracle with access to the true model.

\paragraph{Early-warning via spectral phase and distortion}
We monitor changes in phase lag and nonlinearity as the baseline forcing ramps, estimating $\angle \widehat{G}(\omega_k;t)$ and $\mathrm{HDI}(f_k;t)$ in sliding windows. The working indicator is
\begin{equation}
\mathrm{EWI}_\phi(t) \;=\; \mathrm{median}_{\omega_k\in\mathcal{B}}\left[\Delta \angle \widehat{G}(\omega_k;t)\right], \qquad
\mathrm{EWI}_\mathrm{HD}(t) \;=\; \mathrm{slope}_t\left[\log \mathrm{HDI}(f_k;t)\right],
\end{equation}
computed over selected bands $\mathcal{B}$ with high coherence. Hypothesized signatures of approaching instabilities include phase drift toward $-\pi$ and growth in harmonic/intermodulation content, which we compare against passive variance and lag-1 autocorrelation baselines using lead-time and AUC metrics. This aligns with general early-warning logic in complex dynamical systems while exploiting the added leverage of designed excitation.

\paragraph{Cross-model robustness and practicality}
We implement the framework across model tiers—from aquaplanets or EMICs to CESM-like ESMs with stratospheric chemistry—leveraging established SAI protocols for comparability \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Controllers trained on identified surrogates in one model are transferred to others to assess generalization and robustness margins. Finally, we quantify practicality bounds by varying probe amplitude, duration, and ensemble size, reporting Fisher information growth, estimation bias/variance, and computational cost. By design, the active spectroscopy experiments use small amplitudes, short durations, and ensemble averaging to remain minimally invasive in silico, consistent with calls for careful, incremental research on solar climate interventions \cite{keith2010researchon,robock200820reasons}.

Overall, the methodology integrates frequency-domain system identification \cite{ljung1999system,pintelon2012system} with SAI-specific modeling infrastructures \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering} and control-theoretic synthesis \cite{macmartin2014dynamicsof}, yielding compact, control-ready surrogates and early-warning indicators tailored to the temporal pathways by which SAI modulates coupled climate dynamics.


% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{SAI impacts and uncertainties: a control-oriented motivation for active spectroscopy}

Model intercomparison and large-ensemble studies consistently show that stratospheric aerosol injection (SAI) can offset a substantial fraction of greenhouse-gas-driven warming in global-mean temperature, but with heterogeneous regional responses, hydrological side effects, and sizable uncertainty that depends on injection strategy and model configuration \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Internal variability can mask or amplify SAI-driven signals even under idealized protocols, motivating ensemble designs and careful signal extraction \citep{tilmes2018stratospheric,richter2022assessingresponses}. From a governance and risk perspective, these uncertainties underscore the need for research approaches that are both information-efficient and minimally invasive \citep{robock200820reasons,keith2010researchon}. In parallel, closed-loop analyses suggest that control-oriented reasoning is essential to understand potential feedbacks between intervention and climate dynamics \citep{macmartin2014dynamicsof}. Yet most SAI experiments to date emphasize step/ramp forcing or scenario contrasts, leaving the temporal (frequency-dependent) pathways by which SAI couples to climate outputs only coarsely resolved. This gap limits our ability to design controllers that respect regional constraints and to detect incipient instabilities before they manifest in large excursions.

We frame SAI as a plant-probing problem in which small, information-optimized perturbations reveal the frequency response and low-order nonlinear distortions between an input $u_t$ (injection rate, e.g., TgS\,yr$^{-1}$) and outputs $y_t$ (e.g., GMST, regional precipitation indices, stratospheric winds). For weakly nonlinear systems, the leading-order input–output relation in the frequency domain is captured by the complex frequency response $H(\omega)$ \citep{ljung1999system,pintelon2012system}. Under cyclostationary excitation and ergodicity, a nonparametric estimate follows from spectral regression,
\begin{equation}
\label{eq:Hhat}
\widehat{H}(\omega)\;=\;\frac{S_{yu}(\omega)}{S_{uu}(\omega)}\,,
\end{equation}
with $S_{yu}$ the cross-spectrum of $(y,u)$ and $S_{uu}$ the input spectrum. The magnitude–phase pair $(|\widehat{H}(\omega)|,\angle\widehat{H}(\omega))$ constitutes a Bode characterization of gain and lag, while the magnitude-squared coherence
\begin{equation}
\label{eq:coherence}
\gamma^2(\omega)\;=\;\frac{|S_{yu}(\omega)|^2}{S_{yy}(\omega)\,S_{uu}(\omega)}
\end{equation}
quantifies the fraction of output power linearly explained by the probe at frequency $\omega$ \citep{pintelon2012system}. We recover compact parametric surrogates by fitting $H(\omega;\theta)$ (e.g., stable rational forms) via frequency-domain weighted least squares,
\begin{equation}
\label{eq:WLS}
J(\theta)\;=\;\sum_{\omega\in\Omega} w(\omega)\,\bigl|S_{yu}(\omega) - H(\omega;\theta)\,S_{uu}(\omega)\bigr|^2,
\end{equation}
regularized for smoothness to mitigate leakage and sampling artifacts. This approach directly targets the temporal modulation question—how outcomes change with injection frequency—without conflating responses across timescales.

To expose weak nonlinearities relevant for risk (e.g., harmonic generation and intermodulation that can contaminate regional hydrology bands), we augment the linear surrogate with a second-order Volterra term,
\begin{equation}
\label{eq:volterra}
y_t\;=\;\sum_{k\ge 0} h_1[k]\,u_{t-k}\;+\;\sum_{k_1,k_2\ge 0} h_2[k_1,k_2]\,u_{t-k_1}\,u_{t-k_2}\;+\;e_t,
\end{equation}
and estimate sparse kernels using regularized regression on polynomial–convolution features \citep{ljung1999system}. A scalar harmonic distortion index (HDI) monitors nonlinear leakage of power from the set of excited tones $\mathcal{F}$ into harmonics and intermodulation products $\mathcal{H}$,
\begin{equation}
\label{eq:HDI}
\mathrm{HDI}\;=\;\frac{\sum_{\omega\in\mathcal{H}} |Y(\omega)|^2}{\sum_{\omega\in\mathcal{F}} |Y(\omega)|^2}\,,
\end{equation}
where $Y(\omega)$ is the output spectrum. Rising HDI under slowly increasing baseline forcing is a hypothesized early-warning signature of approaching nonlinear regimes or mode-coupling instabilities, complementing variance/autocorrelation diagnostics.

Information efficiency is central because internal variability and model noise limit identifiability. For a parametric frequency response $H(\omega;\theta)$ with approximately white, frequency-local residuals and known $S_{uu}$, an asymptotic Fisher information matrix (FIM) for $\theta$ under frequency-domain WLS takes the form \citep{ljung1999system,pintelon2012system}
\begin{equation}
\label{eq:FIM}
\mathcal{I}(\theta)\;\approx\;\sum_{\omega\in\Omega}\bigl(\partial_\theta H(\omega;\theta)\bigr)^{\!\!*}\,W(\omega)\,\bigl(\partial_\theta H(\omega;\theta)\bigr)\,|S_{uu}(\omega)|,
\end{equation}
with $W(\omega)$ a weighting proportional to the inverse noise spectrum. We design multi-sine and PRBS probes by maximizing $\log\det \mathcal{I}(\theta)$ subject to environmental and operational constraints (e.g., RMS amplitude bounds to keep SAOD excursions modest and ozone/stratospheric-dynamics constraints consistent with ARISE-SAI protocols) \citep{richter2022assessingresponses}. Classic results in input design and multisine identification guide tone selection, phase optimization, and leakage control \citep{ljung1999system,pintelon2012system}.

The frequency-domain surrogates identified by these active probes provide a principled basis for robust controller synthesis. In contrast to open-loop scenario tuning or naive pulsing, closed-loop designs can trade global-mean tracking against regional constraints explicitly, and they make stability margins transparent \citep{macmartin2014dynamicsof}. For monitoring, we operationalize two early-warning indicators: (i) phase-drift toward $-\pi$ at key bands,
\begin{equation}
\label{eq:phasedrift}
\Delta\phi_t(\omega)\;=\;\operatorname{unwrap}\!\Bigl(\angle \widehat{H}_t(\omega) - \angle \widehat{H}_{t_0}(\omega)\Bigr),
\end{equation}
and (ii) HDI growth from \eqref{eq:HDI}. Both can be extracted from the same minimally invasive, information-optimized probes that support identification and control.

This control-oriented, active-sensing perspective is complementary to GeoMIP-style intercomparisons and large-ensemble protocols \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}: it targets the spectral structure of SAI impacts that determines both controller performance and risk monitoring. By design, the perturbations remain small relative to baseline injection levels, aligning with calls for careful, bounded research \citep{keith2010researchon} while directly reducing the uncertainties most consequential for decision-making.


% === AREA: Information theory applications in climate science and modeling. ===

\subsection{Information-theoretic experiment design for active climate spectroscopy}

We formalize the active-sensing element of our framework as an information-optimal input design problem for a stochastic, weakly nonlinear, input–output mapping between stratospheric aerosol injection rate and climate responses of interest. Let
\begin{equation}
y_t = G(q,\theta)\,u_t + v_t, \qquad v_t \sim \text{zero-mean, stationary, colored},
\label{eq:lti}
\end{equation}
where $y_t$ collects target outputs (e.g., GMST, monsoon indices, SAOD), $u_t$ is the small-amplitude SAI perturbation superimposed on a steady baseline, $G(q,\theta)$ denotes the (unknown) stable linear operator parameterized by $\theta$ around the chosen operating point, and $v_t$ represents internal variability and model noise. In the small-signal regime considered in E1–E2, we excite the system with an $L$-year multi-sine/PRBS/chirp input,
\begin{equation}
u_t=\sum_{k=1}^{K} a_k \cos(\omega_k t + \phi_k),
\label{eq:multisine}
\end{equation}
with $\omega_k \in [2\pi/(\text{50 months}),\,2\pi/(\text{6 months})]$ to span monthly–interannual bands (0.02–2 cycles/year), amplitudes $a_k \in [0.02,0.5]$ TgS/yr RMS aggregated across lines, and phases $\phi_k$ chosen to control crest factor and leakage \citep{pintelon2012system,ljung1999system}. This design aligns with the SAI contexts and constraints articulated by GeoMIP, ARISE-SAI, and CESM/WACCM ensembles \citep{kravitz2011thegeoengineering,richter2022assessingresponses,tilmes2018stratospheric} and reflects the need for careful risk-aware experimentation underscored in \citet{robock200820reasons} and \citet{keith2010researchon}.

For linear time-invariant $G$ and sufficiently long records, spectral regression yields cross- and auto-spectra satisfying $S_{yu}(\omega_k) \approx G(\omega_k) S_{uu}(\omega_k)$ and $S_{yy}(\omega_k) \approx |G(\omega_k)|^2 S_{uu}(\omega_k)+S_{vv}(\omega_k)$ \citep{pintelon2012system}. The magnitude-squared coherence
\begin{equation}
\gamma^2(\omega_k)=\frac{|G(\omega_k)|^2 S_{uu}(\omega_k)}{|G(\omega_k)|^2 S_{uu}(\omega_k)+S_{vv}(\omega_k)}
\label{eq:coherence}
\end{equation}
controls estimator variance and bias leakage. Targeting a minimum $\gamma_\star^2$ across bands implies a design rule for the input spectrum
\begin{equation}
S_{uu}(\omega_k)\;\ge\;\frac{\gamma_\star^2}{1-\gamma_\star^2}\,\frac{S_{vv}(\omega_k)}{|G(\omega_k)|^2},
\label{eq:coherence_target}
\end{equation}
where $S_{vv}(\omega_k)$ is estimated from baseline (no-probe) runs and $|G(\omega_k)|$ is updated iteratively from previous identification passes (E1–E2). With Welch-type estimators and random-phase multisines, a first-order variance proxy for the frequency response estimate is
\begin{equation}
\mathrm{Var}\!\left[\hat{G}(\omega_k)\right]\;\approx\;\frac{c_k}{N_\mathrm{seg}}\;\frac{S_{vv}(\omega_k)}{S_{uu}(\omega_k)},
\label{eq:frf_variance}
\end{equation}
with $c_k=O(1)$ depending on windowing/overlap and $N_\mathrm{seg}$ the effective number of averaged segments \citep{pintelon2012system}. Equations \eqref{eq:coherence}–\eqref{eq:frf_variance} make explicit the core amplitude–duration–identifiability trade-off explored in E6.

We cast probe design as maximizing the Fisher information about $\theta$ subject to environmental and operational constraints. Linearizing $G(\omega,\theta)$ around $\theta_0$ with Jacobians $J_k=\partial G(\omega_k,\theta)/\partial\theta|_{\theta_0}$ and assuming asymptotic normality of spectral estimators, the Fisher information for a design $\mathbf{a}=\{a_k\}$ is
\begin{equation}
\mathcal{I}(\mathbf{a})\;=\;\sum_{k=1}^{K} J_k^{\mathsf{H}}\,W_k(\mathbf{a})\,J_k,\qquad
W_k(\mathbf{a})\;\propto\; \frac{N_\mathrm{seg}\,S_{uu}(\omega_k)}{S_{vv}(\omega_k)},
\label{eq:fim}
\end{equation}
where proportionality hides known estimator constants \citep{ljung1999system,pintelon2012system}. For a Gaussian-linearized prior $\theta\sim\mathcal{N}(\bar{\theta},\Sigma_\mathrm{pr})$, the expected mutual information gained by the experiment is
\begin{equation}
\mathrm{MI}(\mathbf{a})\;=\;\tfrac{1}{2}\log\det\!\left(I+\Sigma_\mathrm{pr}^{1/2}\,\mathcal{I}(\mathbf{a})\,\Sigma_\mathrm{pr}^{1/2}\right),
\label{eq:mi}
\end{equation}
linking classical optimal input design to information-theoretic value-of-information (VOI) \citep{enhanced_2_20250812,enhanced_6_20250812}. We solve
\begin{align}
\max_{\mathbf{a},\,\boldsymbol{\phi}} \quad & \Phi\!\left(\mathcal{I}(\mathbf{a})\right) \;\;\text{or}\;\; \mathrm{MI}(\mathbf{a}) \label{eq:design_obj}\\
\text{s.t.}\quad & \sum_{k} \tfrac{1}{2} a_k^2 \le A_{\mathrm{RMS}}^2,\;\; a_k \in [a_\mathrm{min},a_\mathrm{max}], \nonumber\\
& \mathrm{CF}(\mathbf{a},\boldsymbol{\phi}) = \frac{\max_t |u_t|}{\sqrt{T^{-1}\sum_t u_t^2}} \le \mathrm{CF}_{\max}, \nonumber\\
& \|H_\mathrm{SAOD}\,u\|_2 \le \delta_\mathrm{SAOD},\;\; \|H_\mathrm{chem}\,u\|_2 \le \delta_\mathrm{chem}, \nonumber\\
& \text{chance/robust constraints for regional precipitation and winds,} \nonumber
\end{align}
where $\Phi$ is a design criterion (e.g., D-optimal $\log\det$, A-optimal $\mathrm{tr}[\mathcal{I}^{-1}]$), $H_\mathrm{SAOD}$ and $H_\mathrm{chem}$ are linearized maps from injection to SAOD and stratospheric chemistry diagnostics, and $\mathrm{CF}$ controls intermittency and peak excursions \citep{pintelon2012system,richter2022assessingresponses}. The constraints operationalize governance concerns and safe-experiment desiderata from the SAI literature \citep{tilmes2018stratospheric,kravitz2011thegeoengineering,robock200820reasons,keith2010researchon}. In practice, we combine: (i) coherence targeting via \eqref{eq:coherence_target} for guaranteed per-band SNR; (ii) convex relaxations of \eqref{eq:design_obj} using surrogates for $W_k(\mathbf{a})$; and (iii) phase optimization to minimize crest factor and spectral leakage. PRBS and chirps provide complementary, spectrally flat or sweeping coverage when $S_{vv}$ is uncertain, with MI-adaptive reweighting across successive campaigns \citep{pintelon2012system,enhanced_6_20250812}.

Information-aware design propagates naturally to control and early warning. First, posterior covariance after an identification campaign satisfies
\begin{equation}
\Sigma_\mathrm{post} \;=\; \left(\Sigma_\mathrm{pr}^{-1}+\mathcal{I}(\mathbf{a})\right)^{-1},
\label{eq:posterior}
\end{equation}
which we map to predicted performance risk for H-infinity/MPC via first-order sensitivity of the closed-loop loss $J$,
\begin{equation}
\Delta \mathbb{E}[J]\;\approx\;\mathrm{tr}\!\left(M\,\Sigma_\mathrm{post}\right)-\mathrm{tr}\!\left(M\,\Sigma_\mathrm{pr}\right),
\label{eq:voi_control}
\end{equation}
for an application-specific metric tensor $M$ derived from controller robustness margins \citep{macmartin2014dynamicsof,enhanced_4_20250812}. This yields experiment designs prioritized by expected regret reduction (VOI) relative to control objectives \citep{enhanced_2_20250812}.

Second, the same information geometry defines early-warning tests. Let $\hat{g}_m=\{\hat{G}_m(\omega_k)\}$ denote the frequency-response estimate in a sliding window $m$ under gradually increasing baseline forcing (E4). With Gaussian approximations $\hat{g}_m \sim \mathcal{N}(g_m,\Sigma_m)$ and a nominal reference $(g_\mathrm{ref},\Sigma_\mathrm{ref})$ estimated at low forcing, a sequential Kullback–Leibler statistic
\begin{equation}
D_m \;=\; \tfrac{1}{2}\left[(\hat{g}_m-g_\mathrm{ref})^\mathsf{H}\Sigma_\mathrm{ref}^{-1}(\hat{g}_m-g_\mathrm{ref}) - \log\frac{\det\Sigma_m}{\det\Sigma_\mathrm{ref}} + \mathrm{const}\right]
\label{eq:kl}
\end{equation}
accumulates evidence for dynamical change, complementary to variance/autocorrelation-based early-warning indicators \citep{enhanced_5_20250812}. We monitor (i) phase drift toward $-\pi$ at targeted bands as a sign of approaching feedback reversal and oscillatory instability; and (ii) harmonic distortion growth detected by second-order Volterra spectral lines (E2), both quantifiable within the same MI/Fisher calculus \citep{pintelon2012system,enhanced_9_20250812}. Because the probes are designed to maximize per-sample information, these indicators achieve higher lead time at fixed false-alarm rate than passive baselines in our proposed benchmarks.

Finally, the framework supports practical identifiability budgeting central to E6. Combining \eqref{eq:frf_variance}–\eqref{eq:fim}, per-frequency information scales as $\mathcal{I}_k \propto L\,S_{uu}(\omega_k)/S_{vv}(\omega_k)$, establishing a near-linear trade between experiment length $L$ (years), RMS amplitude, and ensemble replication to hit target confidence on Bode gain/phase and low-order Volterra kernels \citep{ljung1999system,pintelon2012system,enhanced_6_20250812}. This offers a transparent, information-theoretic rationale for the perturbation magnitudes, durations, and ensemble sizes we propose, while remaining compatible with existing SAI modeling protocols and governance constraints \citep{richter2022assessingresponses,tilmes2018stratospheric}.


% === AREA: Volterra kernel methods for nonlinear system identification in climate models. ===

\subsection{Volterra-kernel spectroscopy for nonlinear climate response under pulsed SAI}

Closed-loop geoengineering studies and coordinated model intercomparisons point to low-frequency lags and regional sensitivities that are not strictly linear in the SAI forcing, especially for hydrological and dynamical indices \cite{macmartin2014dynamicsof,kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. To resolve how temporal modulation excites these nonlinear pathways, we model the input–output map from small-amplitude, information-optimized pulsed injections to climate observables with low-order Volterra series. Volterra kernels provide a compact, frequency-domain characterization that captures harmonic generation and intermodulation while remaining tractable for identification and control \cite{ljung1999system,pintelon2012system}. In our framework (E2), they complement linear Bode analysis by quantifying nonlinear distortion that is invisible to passive or single-tone experiments.

We consider a discrete-time, single-input/multi-output setting with monthly sampling, where the input $u_t$ is the zero-mean SAI rate perturbation (e.g., a multisine/PRBS superimposed on a baseline injection) and $y_t$ denotes a scalar climate diagnostic (GMST, Sahel JJA precipitation, QBO winds, etc.). A second-order Volterra model
\begin{equation}
y_t \;=\; \sum_{\tau \ge 0} h_1(\tau)\,u_{t-\tau}
\;+\; \sum_{\tau_1,\tau_2 \ge 0} h_2(\tau_1,\tau_2)\,u_{t-\tau_1}\,u_{t-\tau_2}
\;+\; e_t
\label{eq:volterra_time}
\end{equation}
captures the dominant quadratic effects at the small amplitudes we consider (RMS 0.05–0.5 TgS/yr around a nominal baseline), with $e_t$ representing colored internal variability. In the frequency domain, the corresponding nonlinear frequency response functions (NFRFs) \cite{pintelon2012system} satisfy, on the excited discrete lines $\Omega=\{\omega_k\}$,
\begin{equation}
Y(\omega_k) \;=\; G_1(\omega_k)\,U(\omega_k)
\;+\; \sum_{(i,j)\in \mathcal{T}_k} G_2(\omega_i,\omega_j)\,U(\omega_i)\,U(\omega_j)
\;+\; E(\omega_k),
\label{eq:volterra_freq}
\end{equation}
where $\mathcal{T}_k=\{(i,j): \omega_i+\omega_j=\omega_k\}$ indexes sum/difference interactions induced by the multisine/PRBS input. As in nonlinear spectral analysis \cite{pintelon2012system}, the linear FRF $G_1$ governs the fundamental lines, while the quadratic kernel $G_2$ controls power re-distribution to intermodulation and harmonic lines. Under random-phase multisines with carefully chosen, non-overlapping frequency grids, these contributions can be separated nonparametrically with controlled leakage \cite{pintelon2012system}.

Input design and identifiability. We excite monthly-to-interannual bands (0.02–2 cycles yr$^{-1}$) using random-phase multisines and PRBS, optimizing amplitudes and phases to maximize the Fisher information for $\{G_1,G_2\}$ subject to variance and chemistry constraints (SAOD, ozone) \cite{ljung1999system,enhanced_6_20250812}. Following best practice in frequency-domain identification, we (i) exclude specific lines to create detection slots for nonlinear distortion and noise, (ii) randomize phases across ensemble members to decorrelate internal variability, and (iii) select experiment duration and line spacing to mitigate leakage, as quantified by an L-curve trade-off between smoothness and variance \cite{pintelon2012system,enhanced_9_20250812}. Feasibility with existing ESMs and ensemble protocols is supported by prior large-ensemble SAI experiments \cite{tilmes2018stratospheric,richter2022assessingresponses}.

Estimation. We estimate $G_1$ and $G_2$ via spectral regression with leakage correction:
\begin{align}
\widehat{G}_1(\omega_k)
&= \arg\min_{g}\; \big|Y(\omega_k) - g\,U(\omega_k) - \sum_{(i,j)\in \mathcal{T}_k}\widehat{G}_2(\omega_i,\omega_j)\,U(\omega_i)U(\omega_j)\big|^2, \label{eq:G1est}\\
\widehat{G}_2
&= \arg\min_{G_2}\; \sum_{k}\bigg|Y^\perp(\omega_k) - \sum_{(i,j)\in \mathcal{T}_k} G_2(\omega_i,\omega_j)\,U(\omega_i)U(\omega_j)\bigg|^2
+ \lambda \,\|W \odot G_2\|_{1}, \label{eq:G2est}
\end{align}
with $Y^\perp(\omega_k)=Y(\omega_k)-\widehat{G}_1(\omega_k)U(\omega_k)$ and $W$ a frequency-weighting promoting smoothness. The $\ell_1$ penalty selects a sparse set of active interactions, reflecting the expectation that only a few cross-frequency couplings dominate at small amplitudes; orthogonal forward selection and regularized least squares provide efficient alternatives \cite{enhanced_12_20250812}. Colored-noise bias is reduced using ensemble-averaged cross-spectra and instrumental-variable variants of spectral regression \cite{ljung1999system,enhanced_9_20250812}. We iterate \eqref{eq:G1est}–\eqref{eq:G2est} to convergence and validate on held-out single-tone and chirp tests.

Diagnostics and early warning. We quantify nonlinear distortion via:
(i) harmonic distortion index,
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega_k \in \text{non-fundamental}} |Y(\omega_k)|^2}{\sum_{\omega_k \in \text{fundamental}} |Y(\omega_k)|^2},
\end{equation}
(ii) bicoherence,
\begin{equation}
b^2(\omega_i,\omega_j) \;=\;
\frac{\big|\mathbb{E}[Y(\omega_i+\omega_j)\,U^*(\omega_i)\,U^*(\omega_j)]\big|^2}{\mathbb{E}[|Y(\omega_i+\omega_j)|^2]\;\mathbb{E}[|U(\omega_i)U(\omega_j)|^2]},
\end{equation}
and (iii) cross-frequency prediction error on held-out lines. Within E4, we monitor trends in phase lag of $\widehat{G}_1$ and growth of HDI/bicoherence as baseline forcing is increased. Theory and empirical work on early warning suggest that rising nonlinear coupling and phase drift toward $-\pi$ precede instabilities in complex systems \cite{enhanced_5_20250812}; our active probes are designed to detect such changes earlier and more specifically than passive variance/autocorrelation metrics.

Connection to control. For MPC and $\mathcal{H}_\infty$ synthesis (E3), we use two surrogates derived from the identified kernels:
(i) a linear predictor based on $\widehat{G}_1$ for nominal tracking and robustness analysis \cite{ljung1999system,pintelon2012system}, and
(ii) an augmented regression with polynomial–convolution features induced by $\widehat{h}_2$ to capture small but consequential nonlinearities in constraints (e.g., precipitation variance sensitivity), enabling tube-based or constraint-tightening MPC \cite{enhanced_4_20250812}. This balances tractability with fidelity and leverages the same spectral data products used for identifiability.

Practicality and robustness. We explore probe amplitude and duration trade-offs via Fisher information growth and estimation error scaling (E6) \cite{enhanced_6_20250812}, and test cross-model portability of the identified kernels and controllers (E5) \cite{enhanced_7_20250812}. Together with established SAI ensemble protocols \cite{tilmes2018stratospheric,richter2022assessingresponses} and cautions about unintended consequences \cite{robock200820reasons}, this Volterra-kernel spectroscopy provides a minimally invasive yet high-information route to uncover the frequency-dependent nonlinear structure most relevant for decision support.


% === AREA: Robust control techniques (H-infinity, MPC) for climate stabilization. ===

\subsection{Robust control synthesis informed by active spectroscopy (H$\infty$ and MPC)}
Active spectroscopy yields frequency-domain surrogates that are expressly amenable to robust controller design. Let $u$ denote the stratospheric SO$_2$ injection rate (TgS yr$^{-1}$), and $y\in\mathbb{R}^{p}$ collect target outputs (e.g., GMST, regional precipitation indices, circulation metrics). From multi-sine/PRBS experiments (E1–E2), we estimate the plant’s complex frequency response $\hat G\!\left(e^{j\omega}\right)$ and coherence, with leakage-corrected confidence bounds via spectral regression \citep{pintelon2012system,enhanced_9_20250812}. A sparse second-order Volterra representation identifies leading nonlinear distortions and cross-frequency couplings \citep{enhanced_12_20250812}. We then synthesize controllers that (i) track GMST while shaping regional hydrological variability and stratospheric aerosol optical depth (SAOD), and (ii) maintain stability/performance under uncertainty and internal variability, building on prior closed-loop SAI ideas \citep{macmartin2014dynamicsof} and evaluation protocols from GeoMIP, ARISE-SAI, and CESM(WACCM) \citep{kravitz2011thegeoengineering,richter2022assessingresponses,tilmes2018stratospheric}.

\paragraph{Uncertainty set from spectroscopy.}
We model the plant as an LTI part plus bounded uncertainty capturing estimation error, variability, and weak nonlinear residuals:
\begin{align}
y(t) \;=\; G(q^{-1})\,u(t)\;+\;D(q^{-1})\,w(t)\;+\;n(t),\quad
G \;=\; \hat G\,(I + W_m \Delta_m), \label{eq:mulUnc}
\end{align}
where $w$ aggregates exogenous variability (e.g., ENSO-like disturbances, volcanic aerosol shocks), $n$ is measurement error, and $\Delta_m$ is a stable, bounded operator with $\lVert \Delta_m\rVert_\infty \le 1$. The frequency-shaped weight $W_m(e^{j\omega})$ is constructed from identification residuals and coherence $C_{uy}(\omega)$, for example,
\begin{align}
\left|\frac{G(e^{j\omega_k}) - \hat G(e^{j\omega_k})}{\hat G(e^{j\omega_k})}\right|
\;\le\; |W_m(e^{j\omega_k})|
\;\doteq\;
\alpha\,\sqrt{\frac{1 - C_{uy}(\omega_k)}{C_{uy}(\omega_k)}} \,,
\end{align}
with safety factor $\alpha$ inflated to cover cross-ensemble and cross-model discrepancies (E5). Second-order Volterra residual energy yields an additional input channel for harmonic distortions $\upsilon$, bounded in $\ell_2$ by a weight $W_h$ identified from held-out single-tone tests (E2), which we route through the closed loop for robust synthesis.

\paragraph{Mixed-sensitivity H$\infty$ design.}
Let $S=(I+GK)^{-1}$ and $T=I-S$ denote the sensitivity and complementary sensitivity, respectively. We solve the standard mixed-sensitivity optimization
\begin{align}
\min_{K \text{ stabilizing}} \;\gamma
\quad\text{s.t.}\quad 
\Big\lVert 
\begin{bmatrix}
W_S S \\[2pt]
W_T T \\[2pt]
W_U K S \\[2pt]
W_h\, T
\end{bmatrix}
\Big\rVert_\infty
\;<\;\gamma, \label{eq:msHinf}
\end{align}
where:
(i) $W_S$ shapes tracking and low-frequency disturbance rejection for GMST and selected regional outputs; (ii) $W_T$ limits mid-frequency peaking and phase fragility near dynamically sensitive bands (e.g., QBO/monsoon timescales identified in E2); (iii) $W_U$ penalizes control variability and SAOD excursions; and (iv) $W_h$ absorbs bounded nonlinear harmonic content inferred from the Volterra fit. To certify robust stability against multiplicative uncertainty \eqref{eq:mulUnc}, we enforce the small-gain condition $\lVert W_m T\rVert_\infty < 1$, and we include $W_m$ explicitly in the design loop when performing $\mu$-analysis for structured uncertainties across outputs and regions (E5). The weights are chosen directly from the spectroscopy: $W_S$ inverts the credible low-frequency gain where coherence is high; $W_T$ reflects phase-margin erosion where estimated phase lags approach $-\pi$; $W_U$ encodes admissible injection variability and SAOD bounds; and $W_h$ is set from the harmonic distortion index (HDI) maps of E2.

For implementation, we fit $\hat G(e^{j\omega})$ to a low-order state-space model $\hat G(z)$ via vector fitting or Loewner/subspace techniques using the identified FRF \citep{ljung1999system,pintelon2012system}. This compact model supports convex H$\infty$ synthesis and robustness analysis, while remaining traceable to the frequency-domain data. The resulting dynamic output-feedback $K(z)$ provides a baseline robust controller for E3, complementing MPC below. Prior SAI control studies highlight the value of closed-loop designs \citep{macmartin2014dynamicsof}; here, the novelty is a spectroscopy-calibrated robust controller with explicit frequency-shaped uncertainty and distortion channels.

\paragraph{Surrogate-driven MPC with hard constraints.}
To handle multivariate objectives and operational constraints (e.g., SAOD ceilings, rate limits), we formulate a monthly MPC atop a state-space surrogate identified from the spectroscopy and Koopman-regressed predictors (E2):
\begin{align}
x_{k+1} &= A x_k + B u_k + E w_k, \quad y_k = C x_k + D u_k. \label{eq:ss}
\end{align}
At each time $k$, we solve
\begin{align}
\min_{\{u_{k+i|k}\}} \;\; 
&\sum_{i=0}^{N_p-1} 
\Big(\lVert W_y\,(y_{k+i|k}-r_{k+i})\rVert_2^2 
+ \lVert W_{\Delta}\,\Delta u_{k+i|k}\rVert_2^2 \Big)
+ \rho \sum_{i=0}^{N_p-1} \lVert \zeta_{k+i|k}\rVert_1 \label{eq:mpc}\\
\text{s.t.}\;\;
&\text{\eqref{eq:ss} for predictions with } w\in\mathcal{W}, \nonumber\\
&u_{\min}\le u_{k+i|k}\le u_{\max},\quad |\Delta u_{k+i|k}|\le \delta_{\max}, \nonumber\\
&\text{SAOD}_{k+i|k} \le \text{SAOD}_{\max} + \zeta_{k+i|k},\;\; \zeta_{k+i|k}\ge 0,\nonumber
\end{align}
with horizon $N_p$, reference $r$ (GMST trajectory), and weights $W_y$ encoding the trade-off between mean temperature tracking and regional hydrological stability. The disturbance set $\mathcal{W}$ is built from ensemble variability and the identified $W_m$ and $W_h$ residuals; tube-based MPC or scenario MPC provide robustness to $w_k$ while preserving feasibility under chance constraints for regional precipitation variance. Rate and amplitude limits reflect governance and safety considerations \citep{robock200820reasons,keith2010researchon}. The MPC leverages spectroscopy to place the crossover and constraint-activation timing where the system exhibits controllable phase and high coherence, improving efficacy and reducing effort relative to heuristic pulsing or continuous schedules. Recent work on MPC for climate stabilization supports the tractability and value of such formulations \citep{enhanced_4_20250812}.

\paragraph{Design procedure and evaluation (E3).}
We adopt the following workflow:
(i) construct $W_m$, $W_h$ from E1–E2 (and E6 for amplitude/duration trade-offs using Fisher information \citep{enhanced_6_20250812,enhanced_2_20250812});
(ii) fit a low-order $\hat G(z)$ and verify residuals vs.\ FRF \citep{pintelon2012system};
(iii) synthesize $K(z)$ via \eqref{eq:msHinf} and certify $\lVert W_m T\rVert_\infty<1$ (and structured margins) on the identification band and extrapolated low/high frequencies;
(iv) instantiate MPC \eqref{eq:mpc} with constraint sets derived from policy thresholds (SAOD, injection rate/TV norms) and variability envelopes;
(v) benchmark H$\infty$, MPC, continuous injection, and naive square-wave pulsing under ENSO-like stochastic variability and exogenous volcanic eruptions, using GMST tracking RMSE, constraint violations, controller effort, worst-case regional anomalies, and regret vs.\ an oracle with the true model.

\paragraph{Why robust control improves over passive baselines.}
Passive observation or single impulses cannot expose phase–gain structure and nonlinear distortions across monthly–interannual bands with comparable data efficiency \citep{pintelon2012system,ljung1999system}; spectroscopy-enabled weights and uncertainty sets thus tailor H$\infty$/MPC to the climate’s controllable pathways. Relative to prior SAI control studies \citep{macmartin2014dynamicsof}, our controllers are anchored in frequency-domain evidence and carry explicit robustness certificates. They integrate seamlessly with established modeling infrastructures \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} and align with governance imperatives for quantified uncertainty and safety constraints. This closes the loop between active information gathering and robust decision-making, a synergy increasingly recognized as critical for climate intervention under deep uncertainty \citep{enhanced_4_20250812}.


% === AREA: Early warning signals for climate tipping points and instability. ===

\subsection{Active early-warning via phase and harmonic spectroscopy}
A central premise of our framework is that small, information-optimized pulses reveal incipient instabilities sooner and more specifically than passive indicators based on ambient variability. Classical early-warning signals (EWS) such as rising variance, autocorrelation, and spectral reddening are powerful in generic slow–fast systems, but they depend on the ambient noise spectrum and require long, stationary records to achieve power \cite{enhanced_5_20250812}. In contrast, active spectroscopy places energy at selected frequencies with known phases, enabling direct tracking of the plant’s frequency response—both its linear phase/gain and its nonlinear distortions—under controlled excitation \cite{pintelon2012system,ljung1999system}. This section specifies operational EWS based on (i) phase-lag drift and (ii) harmonic/intermodulation growth, and outlines their evaluation in the E4 experiments.

We excite the Earth system model with a small-amplitude, information-optimized multisine superimposed on a steady SAI baseline:
\begin{equation}
u_t \;=\; \bar{u} \;+\; \sum_{j=1}^{m} a_j \sin(2\pi f_j t + \phi_j), \qquad f_j \in \Omega_1 \subset [0.02,\,2]\ \text{yr}^{-1},
\label{eq:multisine}
\end{equation}
where amplitudes/phases are chosen to maximize the Fisher information for targeted parameters subject to variance and chemistry constraints \cite{pintelon2012system,enhanced_6_20250812}. The output $y_t$ denotes a scalar or vector diagnostic (e.g., GMST, monsoon indices, QBO metrics, SAOD). In sliding windows indexed by $k$ (e.g., 5–10 years with 50\% overlap), we estimate the frequency response at the injected lines by spectral regression:
\begin{equation}
\hat{H}_k(\omega) \;=\; \frac{\hat{S}_{yu,k}(\omega)}{\hat{S}_{uu,k}(\omega)}, 
\qquad 
\hat{\gamma}^2_k(\omega) \;=\; \frac{|\hat{S}_{yu,k}(\omega)|^2}{\hat{S}_{uu,k}(\omega)\,\hat{S}_{yy,k}(\omega)},
\label{eq:frf}
\end{equation}
where $\hat{S}_{\cdot\cdot,k}$ are windowed, leakage-corrected spectral estimates at $\omega\in\Omega_1$; $\hat{\gamma}^2$ is the magnitude-squared coherence that diagnoses the linearity/time-invariance of the input–output map at each line \cite{pintelon2012system,enhanced_9_20250812}. We define the unwrapped phase $\hat{\phi}_k(\omega)=\arg \hat{H}_k(\omega)$.

Phase-drift EWS. Approaching loss of stability or resonance typically manifests as additional lag in the dominant pathways at interannual to decadal bands; in control parlance, phase margin erodes as dynamics become more oscillatory or transport delays lengthen. We track a robust band-aggregated phase-drift statistic relative to an initial baseline window $k_0$:
\begin{equation}
D_{\phi}(k; \mathcal{B}) \;=\; \mathrm{median}_{\omega \in \mathcal{B}} \Big[\, \mathrm{unwrap}\big(\hat{\phi}_k(\omega)\big) - \mathrm{unwrap}\big(\hat{\phi}_{k_0}(\omega)\big) \,\Big],
\qquad \mathcal{B}\subseteq \Omega_1.
\label{eq:phasedrift}
\end{equation}
We compute confidence bands using asymptotic variance of cross-spectral estimators and by block bootstrap over years within each window \cite{pintelon2012system}. Persistent negative drift toward $-\pi$ in bands associated with internal modes (e.g., ENSO-like or QBO-coupled bands in the chosen outputs) is flagged as an early warning that the effective loop delay or oscillatory tendency is increasing under the prevailing forcing trajectory.

Harmonic/intermodulation EWS. Nonlinear distortions appear as power leaking into harmonics $2f_j,\,3f_j,\ldots$ and into intermodulation products $|f_i\pm f_j|$ not present in the input \cite{pintelon2012system}. We define the harmonic distortion index (HDI) in window $k$ as the ratio of output power at nonlinear lines to that at the excited fundamentals:
\begin{equation}
\mathrm{HDI}(k) \;=\; 
\frac{\sum_{\omega \in \Omega_{\mathrm{nl}}} \hat{S}_{yy,k}(\omega)}
{\sum_{\omega \in \Omega_{1}} \hat{S}_{yy,k}(\omega)},
\qquad \Omega_{\mathrm{nl}} \;=\; \{\,2f_j,\,3f_j,\,|f_i\pm f_j|\,:\, f_i,f_j\in\Omega_1\,\}.
\label{eq:hdi}
\end{equation}
To attribute these distortions to quadratic mechanisms and reduce confounding by broadband variability, we estimate a sparse second-order Volterra kernel $\hat{H}_{2,k}(\omega_1,\omega_2)$ over a grid of $(\omega_1,\omega_2)\in \Omega_1\times\Omega_1$ via regularized regression on polynomial-convolution features and report its Frobenius norm:
\begin{equation}
\mathcal{N}_2(k) \;=\; \Big\| \hat{H}_{2,k} \Big\|_{\mathrm{F}} 
\;=\; \Big( \sum_{\omega_1,\omega_2\in \Omega_1} \big|\hat{H}_{2,k}(\omega_1,\omega_2)\big|^2 \Big)^{1/2}.
\label{eq:volterra_norm}
\end{equation}
Growth in HDI and $\mathcal{N}_2$—especially concentrated at cross-frequency pairs linked to known couplings (e.g., seasonal–interannual beating in monsoons)—signals increasing nonlinearity that often precedes qualitative shifts \cite{enhanced_12_20250812,enhanced_3_20250812,enhanced_5_20250812}.

Composite index and decision rule. We combine phase, distortion, and coherence into a standardized early-warning index:
\begin{equation}
\mathrm{EWI}(k) \;=\; w_{\phi}\, Z\!\big(D_{\phi}(k;\mathcal{B})\big) 
\;+\; w_{\mathrm{HDI}}\, Z\!\big(\log \mathrm{HDI}(k)\big)
\;+\; w_{2}\, Z\!\big(\log \mathcal{N}_2(k)\big)
\;+\; w_{\gamma}\, Z\!\big(-\overline{\hat{\gamma}^2_k(\mathcal{B})}\big),
\label{eq:ewi}
\end{equation}
where $Z(\cdot)$ denotes standardization relative to the baseline distribution across $k_0$, $\overline{\hat{\gamma}^2_k(\mathcal{B})}$ is the band-averaged coherence over $\mathcal{B}$, and $w_{\cdot}$ are nonnegative weights (equal weights in the default). A rising EWI indicates concurrent lag growth, increasing nonlinear coupling, and reduced linear coherence with the probe. Because the numerator terms in \eqref{eq:ewi} are computed at input-synchronous spectral lines, the index is specific to the SAI–climate pathway rather than to background variability.

Evaluation protocol (E4). We gradually increase the baseline SAI forcing (e.g., to offset escalating warming) while maintaining small probe RMS amplitudes, and compute $\mathrm{EWI}(k)$, $D_{\phi}$, HDI, and $\mathcal{N}_2$ in moving windows for multiple outputs. Detection skill is assessed by lead time and AUC relative to passive EWS (variance, lag-1 autocorrelation), using thresholds chosen by cross-validation across ensembles and scenarios. We quantify robustness to exogenous shocks by including an imposed volcanic eruption experiment and ENSO-like stochastic variability, leveraging existing protocols and ensembles \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Information-optimal probe design ensures sufficient SNR at target lines while respecting environmental constraints \cite{enhanced_6_20250812,pintelon2012system}. 

Integration with control. The same frequency-response estimates that feed EWI also inform controller robustness margins (e.g., phase margin at crossover for candidate controllers), enabling preemptive adjustment of MPC or $H_{\infty}$ designs when EWI rises \cite{macmartin2014dynamicsof,enhanced_4_20250812}. This closes the loop between diagnosis and action: phase-drift and distortion growth under designed excitation act as actionable triggers to retune gains, tighten constraints on regional hydrology, or temporarily reduce modulation depth, thereby reducing the probability of crossing stability boundaries \cite{robock200820reasons,keith2010researchon}.

Practical considerations. Window lengths must balance bias from slow nonstationarity against variance of spectral estimates; we adopt multitaper/narrowband strategies and leakage control as in frequency-domain identification \cite{pintelon2012system}. Because active lines are known a priori, false alarms from broadband climate variability are reduced relative to passive EWS. Residual confounding from time-variation is monitored by coherence loss and by discrepancies between line-based $\hat{H}_k(\omega)$ and time-domain predictions from the identified Volterra surrogate. All procedures are repeated across model tiers for cross-model robustness (E5), reusing the same probe lines to facilitate transfer of both control designs and EWS thresholds.


% === AREA: Fisher information maximization for experimental design in complex systems. ===

\subsection{Information-optimal active probing via Fisher information maximization}

We formalize the design of small-amplitude pulsed SAI experiments as an optimal input design problem that maximizes the statistical information content about a chosen surrogate model while respecting environmental and operational constraints. In our setting, the injected SO$_2$ rate $u_t$ is a scalar control input superimposed on a steady baseline (e.g., 5 TgS yr$^{-1}$), and the outputs $y_t \in \mathbb{R}^p$ include global and regional climate indicators (GMST, Sahel JJA precipitation, monsoon indices, stratospheric winds, SAOD). For sufficiently small perturbations (0.05–0.5 TgS yr$^{-1}$ RMS), the Earth system model (ESM) response around the operating point is well-approximated by a locally linear, time-invariant map filtered through internal variability \cite{ljung1999system,pintelon2012system}:
\begin{equation}
y_t \approx G(q;\theta^\star)\,u_t + v_t,\quad v_t \sim \mathcal{W}\mathcal{S}\mathcal{S}\text{ with PSD }S_v(\omega),
\label{eq:lti}
\end{equation}
where $G(q;\theta)$ is a scalar-input/multi-output transfer function parameterized by a compact vector $\theta$ (e.g., a low-order stable rational form or a nonparametric set of complex gains at selected Fourier lines), $q$ is the time-shift operator, and $v_t$ captures internally-generated colored variability. We consider multi-sine, PRBS, and chirp excitations with fundamental frequencies spanning monthly to interannual bands (0.02–2 cycles yr$^{-1}$), tailored to stratosphere–troposphere coupling time scales and known modes (seasonal cycle, QBO, ENSO) \cite{pintelon2012system,kravitz2011thegeoengineering,richter2022assessingresponses}.

\paragraph{Frequency-domain Fisher information.}
With a periodic multi-sine $u_t = \sum_{k \in \mathcal{K}} A_k \cos(\omega_k t + \phi_k)$ over $N$ samples (duration $T$), the discrete Fourier transform at excited lines yields
\begin{equation}
Y(\omega_k) = H(\omega_k;\theta^\star)\,U(\omega_k) + E(\omega_k),
\end{equation}
where $H$ is the frequency response of $G$, $U(\omega_k)$ is the complex input spectrum at line $\omega_k$, and $E$ is colored noise with spectral density $S_v(\omega_k)$. Under standard regularity conditions for Gaussian (or large-sample) likelihoods, the Fisher Information Matrix (FIM) for $\theta$ is, to first order \cite[Chs. 8–13]{ljung1999system,pintelon2012system}:
\begin{equation}
\mathcal{I}(\theta^\star;\{U(\omega_k)\}) \;=\; 2N \sum_{\omega_k \in \mathcal{K}} \left[\frac{\partial H(\omega_k;\theta)}{\partial \theta}\Big|_{\theta^\star}\right]^{\!\!\top}\!
\left(S_v^{-1}(\omega_k)\right)
\left[\frac{\partial H(\omega_k;\theta)}{\partial \theta}\Big|_{\theta^\star}\right] \,\left|U(\omega_k)\right|^2,
\label{eq:fim}
\end{equation}
with a sum over outputs implicit in $S_v^{-1}$ and the sensitivity Jacobian. For multi-output $y_t$, the contributions add across outputs. Importantly, the FIM scales linearly with the effective sample size $N$ and with the per-line input power $\left|U(\omega_k)\right|^2$, and inversely with the background variability $S_v(\omega_k)$ at each frequency. This directly encodes the central experimental-design trade-offs: focus energy where sensitivities are large and internal variability is low, subject to operational and environmental limits.

\paragraph{Design objective and constraints.}
We allocate spectral amplitudes $s_k \equiv |U(\omega_k)|^2$ and phases $\phi_k$ to maximize information with constraints reflecting feasibility and risk management. We consider A-optimal designs (convex in this setting) and, where computationally acceptable, D-optimal designs:
\begin{align}
\text{A-opt: } \quad & \min_{\{s_k,\phi_k\}} \;\; \mathrm{tr}\left(\mathcal{I}^{-1}(\theta_0;\{s_k\})\right), \label{eq:aopt}\\
\text{D-opt: } \quad & \max_{\{s_k,\phi_k\}} \;\; \log\det\left(\mathcal{I}(\theta_0;\{s_k\})\right), \label{eq:dopt}
\end{align}
subject to:
\begin{align}
& 0 \le s_k \le \bar{s}_k,\;\; \sum_{k \in \mathcal{K}} s_k \le E_{\mathrm{tot}}, \label{eq:energy}\\
& \|u\|_\infty \le u_{\max} \quad \text{(crest-factor managed by phases $\phi_k$; Schroeder phasing \cite{pintelon2012system})}, \label{eq:crest}\\
& \mathrm{Var}_T(\mathrm{SAOD}) \le \sigma^2_{\mathrm{SAOD}},\;\; \Delta \mathrm{SAOD}_{\max} \le \delta_{\mathrm{SAOD}}, \label{eq:saod}\\
& \mathrm{E}\left[\Delta \mathrm{O}_3\right] \le \delta_{\mathrm{O}_3}} \quad \text{(proxy or emulator-based constraint)}. \label{eq:ozone}
\end{align}
The parameter $\theta_0$ is a nominal operating-point estimate obtained from a short pilot experiment or prior ESM knowledge. The bounds in \eqref{eq:saod}–\eqref{eq:ozone} reflect the need to keep stratospheric aerosol optical depth variability and composition perturbations within ranges where chemistry–dynamics feedbacks remain small and reversible \cite{tilmes2018stratospheric,richter2022assessingresponses}. Constraint \eqref{eq:crest} ensures implementability (peaks in the superposed multi-sine do not violate injection-rate limits). We estimate $S_v(\omega)$ from a no-excitation baseline ensemble at the same model resolution and forcings, which is standard practice to whiten colored variability in frequency-domain identification \cite{pintelon2012system}.

For PRBS and chirp excitations, the same FIM framework applies in expectation: PRBS approximately flattens $|U(\omega)|^2$ over a design band, while chirps provide smoothly varying frequency coverage; both can be tuned to respect \eqref{eq:energy}–\eqref{eq:ozone} and are useful when operational simplicity is prioritized over fine-grained line selection \cite{pintelon2012system,ljung1999system}.

\paragraph{Targeted information for volatility, lag, and stability.}
Because control synthesis and early warning hinge on accurate frequency-dependent gains and phases near policy-relevant bands, we weight the design to emphasize:
- phase sensitivity near anticipated lag transitions (e.g., where $H(\omega)$ phase approaches $-\pi$), which is diagnostic for closed-loop robustness margins \cite{macmartin2014dynamicsof};
- frequencies where internal variability is manageable yet dynamically informative (annual to interannual), in line with ARISE-SAI and GeoMIP protocols \cite{kravitz2011thegeoengineering,richter2022assessingresponses};
- outputs entering the controller and risk metrics (GMST and regional precipitation), using multi-output FIM aggregation.

Concretely, we may incorporate a weight matrix $W$ on parameters or directly on sensitivities to favor information that reduces controller regret or tightens stability margins, aligning experiment design with decision objectives.

\paragraph{Nonlinear extensions for second-order distortions.}
To probe quadratic nonlinearities captured by a second-order Volterra kernel, we augment the design with frequency pairs $(\omega_i,\omega_j)$ whose sum and difference tones $(\omega_i \pm \omega_j)$ fall on unexcited or deliberately monitored lines. This avoids spectral collisions and maximizes identifiability of intermodulation terms in sparse kernel regressions \cite{pintelon2012system}. The resulting Fisher information for the quadratic kernel coefficients inherits the structure of \eqref{eq:fim} but with regressors formed by quadratic convolution features; sparsity-promoting estimators then exploit the designed pair coverage for efficient recovery and uncertainty quantification.

\paragraph{Robustness to model and noise uncertainty.}
Internal variability spectra and nominal sensitivities are uncertain. We thus adopt a robust design that hedges over an admissible set $\mathcal{S}$ of $(\theta,S_v)$ pairs obtained from pilot runs and prior ensembles:
\begin{equation}
\max_{\{s_k\}} \;\; \min_{(\theta,S_v)\in\mathcal{S}} \;\; \lambda_{\min}\big(\mathcal{I}(\theta;\{s_k\})\big)
\quad \text{s.t.} \quad \eqref{eq:energy}\text{--}\eqref{eq:ozone}.
\label{eq:robust}
\end{equation}
The E-optimal inner criterion maximizes the worst-case local identifiability and yields conservative confidence bounds. In practice, we solve a sequence of convex A-opt problems across a finite scenario set and enforce the worst-case constraint, which is computationally tractable at the modest number of excited lines used here.

\paragraph{Time–amplitude–ensemble trade-offs (E6).}
Equation \eqref{eq:fim} implies $\mathcal{I} \propto N \sum_k s_k$, so that, to first order, the size of parameter confidence ellipsoids scales as $\mathrm{Cov}(\hat{\theta}) \approx \mathcal{I}^{-1} \sim \mathcal{O}\big((N\,\bar{s})^{-1}\big)$. Thus, for a target prediction error or coherence threshold, one can trade experiment length $T$, ensemble size $n_{\mathrm{ens}}$, and RMS amplitude via $N = T \times n_{\mathrm{ens}}$ and $\sum_k s_k = \|u\|_2^2$ subject to constraints \eqref{eq:energy}–\eqref{eq:ozone}. This directly operationalizes the practicality analysis in E6 and quantifies the marginal value of increasing amplitude versus extending the record or adding ensemble members \cite{ljung1999system,pintelon2012system}. Because red internal variability inflates $S_v(\omega)$ at low frequencies, designs that place more energy at sub-annual bands often achieve faster information gain, provided they remain within acceptable SAOD variability.

\paragraph{Leakage control, windowing, and crest-factor management.}
Finite-duration records introduce spectral leakage that biases spectral regression if unmitigated. We follow frequency-domain identification best practice \cite{pintelon2012system}: excite on exact DFT lines; apodize outputs with suitable windows; apply leakage corrections; and choose Schroeder phases to reduce crest factor, thereby increasing usable RMS amplitude without violating $u_{\max}$ or SAOD constraints.

\paragraph{Integration with the experimental workflow.}
We adopt a two-stage loop:
- Stage 1 (pilot): run a short low-amplitude multi-sine/PRBS experiment to estimate $S_v(\omega)$ and a nominal $H(\omega;\theta_0)$ across outputs; screen candidate frequency lines to avoid collisions with strong exogenous modes (e.g., seasonal harmonics, QBO).
- Stage 2 (designed): solve \eqref{eq:aopt} or \eqref{eq:robust} for $\{s_k\}$ and phases, implement the optimized probe respecting \eqref{eq:energy}–\eqref{eq:ozone}, then re-estimate $H$ and (optionally) second-order kernels with uncertainty bounds. Iterate if necessary.

This information-theoretic input design is standard in engineering system identification \cite{ljung1999system,pintelon2012system} and, when tailored to SAI constraints and Earth system variability, provides the most data-efficient route to learn Bode gain/phase and nonlinear distortions relevant for robust control and early warning. It complements and sharpens existing SAI simulation protocols by making temporal modulation an instrumented measurement, not just a policy scenario \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses,macmartin2014dynamicsof}.


% === AREA: Cross-model validation techniques for climate models and surrogate models. ===

\subsection{Cross-model validation and transferability of identified dynamics and controllers}

A central requirement for using active spectroscopy to inform policy is demonstrating that identified surrogate dynamics and synthesized controllers generalize beyond a single Earth system model (ESM). Multi-model protocols such as GeoMIP have repeatedly shown that responses to idealized forcings differ across models in magnitude, pattern, and variability, underscoring the need for standardized experiments and cross-model evaluation of any proposed strategy (Kravitz et al., 2011). Contemporary SAI protocols such as ARISE-SAI further emphasize reproducible forcing specifications and common diagnostics (Richter et al., 2022), while large-ensemble designs with interactive stratospheric aerosols (Tilmes et al., 2018) provide the variance estimates needed to quantify identifiability and uncertainty. We operationalize these principles by embedding cross-model validation into all stages of our framework (E5), leveraging frequency-domain system identification and robust control diagnostics from engineering (Ljung, 1999; Pintelon and Schoukens, 2012) and closed-loop analysis in the geoengineering context (MacMartin et al., 2014).

\paragraph{Interface harmonization and experimental comparability.}
We impose a common input–output interface across model tiers. The input is the zonally integrated SO$_2$ (or sulfate) injection rate, $u(t)$, superimposed as small-amplitude, information-optimized probes around a steady baseline. Outputs are standardized to anomalies relative to each model’s steady forced baseline and deseasonalized: $y_m(t) \in \mathbb{R}^p$ for model $m \in \{A,B,\dots\}$ include GMST, regional precipitation indices (e.g., Sahel JJA), circulation metrics, and stratospheric aerosol optical depth (SAOD). Protocols (frequency content, amplitude bounds, run length) follow ARISE-SAI/GeoMIP-style specifications to facilitate comparability (Kravitz et al., 2011; Richter et al., 2022), with ensemble realizations used to quantify internal variability (Tilmes et al., 2018).

\paragraph{Frequency-domain generalization metrics.}
For each model $m$, we write the linear input–output relation in the frequency domain:
\begin{equation}
Y_m(\omega) \;=\; G_m(\omega)\,U(\omega) \;+\; N_m(\omega),
\end{equation}
with $G_m(\omega)\in \mathbb{C}^{p\times 1}$ the empirical frequency response function (FRF), estimated via spectral regression with leakage and bias corrections (Pintelon and Schoukens, 2012). Given an FRF $\widehat{G}_A(\omega)$ identified in model $A$, we quantify cross-model generalization to model $B$ with a weighted discrepancy
\begin{equation}
J_{\mathrm{gen}}(W) \;=\; \frac{1}{|\Omega|}\sum_{\omega\in\Omega} \big\| W(\omega)\,\big(G_B(\omega)-\widehat{G}_A(\omega)\big)\big\|_F^2,
\label{eq:Jgen}
\end{equation}
where $\Omega$ is the excited frequency set and $W(\omega)\succ 0$ weights outputs according to scientific or policy priorities (e.g., precipitation stability) and input power spectral density. A relative variant,
\begin{equation}
J_{\mathrm{rel}} \;=\; \frac{\sum_{\omega}\|W(\omega)(G_B-\widehat{G}_A)\|_F^2}{\sum_{\omega}\|W(\omega)G_B\|_F^2},
\end{equation}
normalizes by the target model’s gain. We additionally compare input–output coherence,
\begin{equation}
\gamma_m^2(\omega)\;=\; \frac{|S_{y u,m}(\omega)|^2}{S_{y y,m}(\omega)\,S_{u u}(\omega)},
\end{equation}
as a model-agnostic SNR diagnostic for identifiability across tiers (Pintelon and Schoukens, 2012).

\paragraph{Nonlinear distortion transfer and Volterra cross-validation.}
To assess portability of nonlinear structure, we estimate second-order Volterra kernels $\widehat{H}_A(\omega_1,\omega_2)$ from multi-sine experiments with line separation and phase randomization designed to isolate intermodulation products (Pintelon and Schoukens, 2012). We evaluate prediction of harmonic and intermodulation lines in model $B$ via
\begin{equation}
J_{\mathrm{V2}} \;=\; \frac{1}{|\mathcal{L}|}\sum_{(\omega_1,\omega_2)\in\mathcal{L}} \big| H_B(\omega_1,\omega_2) - \widehat{H}_A(\omega_1,\omega_2) \big|^2,
\end{equation}
where $\mathcal{L}$ indexes the probed frequency pairs. We also track a harmonic distortion index (HDI) in each model,
\begin{equation}
\mathrm{HDI}_m \;=\; \frac{\sum_{\ell\in \mathcal{H}} P_m(\ell)}{\sum_{k\in \mathcal{F}} P_m(k)},
\end{equation}
i.e., the ratio of power at harmonic/intermodulation lines $\mathcal{H}$ to the fundamental set $\mathcal{F}$, to test whether nonlinear growth trends under increased baseline forcing are consistent across models (cf. E4).

\paragraph{Residual diagnostics and statistical tests.}
Cross-model predictive residuals under the identified linear surrogate from model $A$ are
\begin{equation}
e_B(t) \;=\; y_B(t) - \mathcal{F}^{-1}\!\left\{\widehat{G}_A(\omega)\,U(\omega)\right\}(t).
\end{equation}
Following standard identification practice (Ljung, 1999), we require residual whiteness (e.g., portmanteau $Q$-test) and low cross-correlation with inputs:
\begin{equation}
Q \;=\; N(N+2)\sum_{k=1}^{L} \frac{\widehat{r}_e(k)^2}{N-k}, \qquad \widehat{r}_e(k) = \frac{1}{N}\sum_{t} e_B(t)\,e_B(t-k).
\end{equation}
Failure of these tests indicates unmodeled dynamics or structural mismatch that jeopardizes transferability.

\paragraph{Controller transfer and robustness checks.}
Let $K_A$ be a controller (H-infinity or MPC) synthesized on $\widehat{G}_A$ to track GMST while constraining regional precipitation variance and SAOD excursions (MacMartin et al., 2014). We evaluate closed-loop transfer on model $B$ using standard performance metrics (tracking RMSE, constraint violation rate, total variation of $u$, and worst-case regional anomalies), and quantify a frequency-domain stability proxy via multiplicative mismatch
\begin{equation}
\Delta_m(\omega) \;=\; \frac{G_B(\omega) - \widehat{G}_A(\omega)}{\widehat{G}_A(\omega)}, \qquad
\rho(K_A;B) \;=\; \sup_{\omega\in\Omega} \bar{\sigma}\big(\Delta_m(\omega)\,T_A(\omega)\big),
\end{equation}
where $T_A(\omega)$ is the complementary sensitivity of the $\widehat{G}_A$–$K_A$ loop and $\bar{\sigma}$ denotes the maximum singular value. Values $\rho<1$ provide a practical small-gain check for robustness, to be corroborated by direct time-domain simulation (Ljung, 1999). We report regret relative to an oracle controller $K^\star_B$ tuned on $G_B$:
\begin{equation}
\mathcal{R}(K_A;B) \;=\; J_{\mathrm{cl}}(K_A;B)\,-\,J_{\mathrm{cl}}(K^\star_B;B),
\end{equation}
where $J_{\mathrm{cl}}$ aggregates the operational metrics above.

\paragraph{Protocol and success criteria.}
Cross-model validation proceeds as:
\begin{enumerate}
\item Design identical probe spectra and amplitudes under ARISE-SAI/GeoMIP-style constraints; run ensembles in model $A$ and a second-tier model $B$ (Kravitz et al., 2011; Richter et al., 2022; Tilmes et al., 2018).
\item Identify $\widehat{G}_A$ and $\widehat{H}_A$ using frequency-domain regression and multi-sine-based nonlinearity separation (Pintelon and Schoukens, 2012); perform standard validation in $A$ (Ljung, 1999).
\item Compute $J_{\mathrm{gen}}$, $J_{\mathrm{rel}}$, $J_{\mathrm{V2}}$, HDI consistency, residual tests, and coherence comparisons in $B$.
\item Synthesize $K_A$; evaluate closed-loop metrics, $\rho(K_A;B)$, and regret $\mathcal{R}(K_A;B)$ in $B$ (MacMartin et al., 2014).
\end{enumerate}
We deem a surrogate/controller transferable if: (i) $J_{\mathrm{rel}}$ and $J_{\mathrm{V2}}$ are below pre-specified thresholds across policy-relevant bands; (ii) residuals are white and input-uncorrelated; (iii) early-warning trends (phase drift toward $-\pi$ and HDI growth) are concordant across models within uncertainty; and (iv) closed-loop constraint violations remain within tolerance with low regret. These criteria are motivated by the need for reproducibility and risk-aware governance of SAI (Robock, 2008; Keith et al., 2010) and leverage established intercomparison practices and identification diagnostics (Kravitz et al., 2011; Ljung, 1999; Pintelon and Schoukens, 2012; Richter et al., 2022).

\paragraph{Remarks on uncertainty and practicality.}
Large ensembles facilitate reliable spectral estimates and Fisher-information-aware input design in each model tier (Tilmes et al., 2018; Ljung, 1999; Pintelon and Schoukens, 2012). When probe amplitudes or run lengths are limited (E6), we propagate estimation uncertainty into $J_{\mathrm{gen}}$ and $\rho$ via bootstrapped spectra and report confidence intervals, ensuring that claims of transferability are supported by statistically robust evidence consistent with standardized protocols (Richter et al., 2022; Kravitz et al., 2011).


% === AREA: Uncertainty quantification methods in climate modeling and control. ===

\subsection{Uncertainty quantification and robust design for active spectroscopy and control}

Quantifying and propagating uncertainty is central to turning active spectroscopy into actionable control for SAI. Stratospheric interventions are characterized by large internal variability and structural model error, and governance requires credible uncertainty bounds on both identified dynamics and closed-loop outcomes \citep{robock200820reasons, keith2010researchon}. We build UQ into every stage of the framework, from probe design (E1) through control synthesis (E3) and early warning (E4), and validate across ensembles and models (E5), leveraging existing protocols and multi-ensemble resources \citep{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}.

\paragraph{Uncertainty sources and bookkeeping}
We distinguish:
(i) internal variability treated as colored output disturbance with spectral density $\Phi_{ee}(\omega)$; 
(ii) parameter uncertainty of identified surrogate models (linear frequency response and second-order Volterra terms); 
(iii) structural error from model discrepancy between tiers (idealized, intermediate, ESM); and 
(iv) exogenous scenario uncertainty (e.g., ENSO-like variability and episodic volcanic aerosol).
We propagate these via (a) asymptotic covariance from frequency-domain system identification \citep{ljung1999system, pintelon2012system}, (b) ensemble resampling/blocks bootstrap to capture low-frequency variability, and (c) robust control uncertainty sets for synthesis and certification.

\paragraph{Information-optimal probing under constraints}
Let $u(t)$ be a multi-sine probe with discrete frequencies $\Omega=\{\omega_k\}$ and complex amplitudes $U(\omega_k)$. For a parametric frequency response $G(\omega;\theta)$, the Fisher information matrix for $\theta$ under colored disturbances is, asymptotically,
\begin{equation}
\label{eq:FIM}
\mathcal{I}(\theta; \Omega, U) \;\approx\; \sum_{\omega\in\Omega} 
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\,U(\omega)\right]^{\!H}
\,\Phi_{ee}^{-1}(\omega)\,
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\,U(\omega)\right],
\end{equation}
with $\Phi_{ee}(\omega)$ estimated from a no-probe baseline. We choose amplitudes/phases to maximize an information criterion (e.g., $\log\det \mathcal{I}$) subject to operational and environmental constraints (RMS injection budget $\|u\|_2\leq B$, bounds on SAOD excursions, and avoidance of specified spectral bands if needed):
\begin{equation}
\label{eq:OID}
\max_{U(\omega),\,\omega\in\Omega}\; \log\det \mathcal{I}(\theta_0; \Omega, U)
\quad \text{s.t.}\quad 
\sum_{\omega\in\Omega}|U(\omega)|^2 \le B^2,\;\; \mathcal{C}_{\text{env}}(U)\leq c_{\max}.
\end{equation}
The design leverages standard results that tie parameter covariance to the inverse Fisher information \citep{ljung1999system} and that relate frequency-by-frequency signal-to-noise to coherence $\gamma^2(\omega)=|S_{yu}(\omega)|^2/(S_{yy}(\omega)S_{uu}(\omega))$ \citep{pintelon2012system}. Frequencies with low $\gamma^2$ receive more power until constraints bind, trading probe amplitude, duration, and ensemble size to meet target confidence widths (E6).

\paragraph{Spectral estimation error quantification}
We estimate the FRF nonparametrically via $ \widehat{G}(\omega)=\widehat{S}_{yu}(\omega)/\widehat{S}_{uu}(\omega)$ and then fit compact parametric/Volterra models. Under Welch averaging with $M$ segments, $\widehat{G}(\omega)$ is asymptotically complex normal with covariance shrinking as $\mathcal{O}(1/M)$ and inflating as $(1-\gamma^2(\omega))/\gamma^2(\omega)$ when coherence is low \citep{pintelon2012system}. We therefore report frequency-resolved confidence tubes
\begin{equation}
\label{eq:tube}
\mathcal{T}_{\alpha}(\omega)=\Big\{G: \big(\widehat{G}(\omega)-G\big)^{\!*}\Sigma^{-1}(\omega)\big(\widehat{G}(\omega)-G\big)\le \chi^2_{2,1-\alpha}\Big\},
\end{equation}
and propagate $\Sigma(\omega)$ through the parametric fit to obtain $\mathrm{cov}(\widehat{\theta})\approx \mathcal{I}^{-1}$ \citep{ljung1999system}. For nonlinear distortion metrics (HDI, intermodulation), we use held-out single-tone tests and block bootstrap to form empirical uncertainty bands that respect low-frequency climate memory.

\paragraph{Model-discrepancy sets for robustness}
Cross-tier validation (E5) yields empirical multiplicative/additive error bounds between the identified surrogate $G_{\mathrm{id}}(\omega)$ and the higher-fidelity model $G_{\ast}(\omega)$. We define frequency-shaped uncertainty sets
\begin{equation}
\label{eq:uncertainty}
G(\omega)= G_{\mathrm{id}}(\omega)\,\big(1+W_m(\omega)\Delta_m(\omega)\big) + W_a(\omega)\Delta_a(\omega), 
\quad \|\Delta_m\|_{\infty},\|\Delta_a\|_{\infty}\le 1,
\end{equation}
where $W_m,W_a$ are chosen as tight envelopes of cross-model residuals and ensemble spread. This yields a standard robust control formulation in which the controller $K$ is synthesized and certified against all admissible plants in \eqref{eq:uncertainty}. Following \citet{macmartin2014dynamicsof}, who showed the value of closed-loop SAI under uncertainty, we use $H_{\infty}$ mixed-sensitivity design to guarantee robust stability/performance and MPC with chance constraints for multi-objective tracking.

\paragraph{Risk-aware control objectives and certification}
Let $z$ collect weighted objectives (GMST tracking error, regional hydrological anomalies, SAOD deviations). We design $K$ by solving
\begin{equation}
\label{eq:hinf}
\min_{K}\; \| F_{\ell}(P,W,K)\|_{\infty}
\quad\text{subject to}\quad \eqref{eq:uncertainty},
\end{equation}
with $W$ encoding performance/actuator weights; the resulting bound is a worst-case performance certificate over uncertainty sets. In parallel, MPC solves
\begin{equation}
\label{eq:chance}
\min_{u_{0:T-1}} \mathbb{E}\big[\sum_{t=0}^{T-1}\|z_t\|_2^2+\lambda\|u_t\|_2^2\big] 
\;\;\text{s.t.}\;\; \mathbb{P}\big(|r^{(i)}_t|\le r^{(i)}_{\max}\big)\ge 1-\alpha,\;\forall i,t,
\end{equation}
where $r^{(i)}_t$ are regional constraints. Chance constraints are enforced via scenario ensembles drawn from the identified uncertainty and internal-variability models, consistent with ensemble-based practice in SAI simulations \citep{tilmes2018stratospheric, richter2022assessingresponses}. We report not only mean performance but distributions of regret versus an oracle controller with access to the true model, emphasizing robustness margins rather than single-scenario success.

\paragraph{Sequential design and stopping rules}
We adopt a sequential loop: prior $\rightarrow$ probe $\rightarrow$ identify $\rightarrow$ certify $\rightarrow$ adapt. After each experiment, we update $\widehat{\Sigma}_{\theta}$ and recompute \eqref{eq:OID}. We stop when (i) all Bode magnitudes/phases over the control-relevant band have confidence widths below pre-specified thresholds, (ii) robust-stability margins exceed targets, and (iii) early-warning detectors (phase drift, HDI growth) achieve desired detection power under block-bootstrap nulls. The stopping criteria are feasible within existing multi-ensemble SAI infrastructures \citep{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses} and align with best practice in identification where Fisher information and parameter covariance guide experimental sufficiency \citep{ljung1999system, pintelon2012system}.

\paragraph{Governance-facing uncertainty reporting}
Given the societal salience of tail risks in SAI \citep{robock200820reasons, keith2010researchon}, we translate technical UQ into governance-relevant summaries: (i) frequency-resolved confidence tubes for key gains/phases with clear SNR and coherence diagnostics; (ii) robust control certificates (guaranteed bounds on worst-case regional anomalies) alongside ensemble quantiles; and (iii) early-warning lead-time distributions relative to passive baselines. This makes explicit what is known from active probing, what remains uncertain, and how control can be designed to be safe-to-fail under those uncertainties.


% === AREA: Spectral regression techniques for climate data analysis and system identification. ===

\subsection{Spectral regression for active SAI spectroscopy}

We leverage frequency-domain system identification to estimate the climate system’s small-signal frequency response and nonlinear distortions from designed, small-amplitude SAI perturbations. Frequency-domain estimators are natural for multi-sine, PRBS, and chirp inputs, provide direct Bode gain/phase with uncertainty, and integrate seamlessly with information-optimal input design and robust control synthesis [\cite{ljung1999system,pintelon2012system}]. In contrast to step or impulse experiments typical of GeoMIP-style protocols [\cite{kravitz2011thegeoengineering}] and scenario ensembles [\cite{tilmes2018stratospheric,richter2022assessingresponses}], spectral regression under designed excitations exposes frequency-dependent pathways—gain, lag, and harmonics—central to both controller design [\cite{macmartin2014dynamicsof}] and early-warning diagnostics.

\paragraph{Problem setup and assumptions.}
Consider a small perturbation $\{u_t\}$ to a baseline SAI scenario (e.g., $5$ TgS/yr) designed as a periodic multi-sine (or PRBS/chirp) with RMS $0.05$–$0.5$ TgS/yr, and outputs $y_t \in \mathbb{R}^p$ (GMST, regional precipitation indices, circulation metrics). For sufficiently small amplitudes and over windows where the operating point is quasi-stationary, the output can be decomposed as
\begin{equation}
y_t \;=\; (g \star u)_t \;+\; e_t \;+\; \mathcal{O}(\alpha^2), \quad \alpha=\mathrm{RMS}(u),
\label{eq:linmodel}
\end{equation}
where $g$ is the (matrix) impulse response linearized about the operating point, and $e_t$ aggregates internal variability and model noise, assumed wide-sense stationary after removing seasonal cycles and slow trends. Nonlinear contributions enter at $\mathcal{O}(\alpha^2)$ via Volterra terms and can be quantified separately (below). We work in discrete time with sampling $\Delta t$ (monthly by default), and analyze integer periods of the designed input to control leakage [\cite{pintelon2012system}].

\paragraph{Nonparametric frequency response and leakage-aware estimators.}
Let $U_k$ and $Y_k$ denote the discrete Fourier transforms at excited angular frequencies $\Omega=\{\omega_k\}$, with potential averaging over $M$ independent realizations obtained by ensembles, Welch segments, or tapers. The cross- and auto-spectral estimates are
\begin{equation}
\widehat{S}_{yu}(\omega_k) \;=\; \frac{1}{M} \sum_{m=1}^M Y_k^{(m)} \, U_k^{(m)\,*}, 
\quad
\widehat{S}_{uu}(\omega_k) \;=\; \frac{1}{M} \sum_{m=1}^M U_k^{(m)} \, U_k^{(m)\,*},
\end{equation}
yielding the classical $H_1$ estimator for the frequency response function (FRF) [\cite{pintelon2012system}]
\begin{equation}
\widehat{G}(\omega_k) \;=\; \widehat{S}_{yu}(\omega_k)\, \widehat{S}_{uu}^{-1}(\omega_k),
\label{eq:frf}
\end{equation}
which is consistent when noise enters additively on the output and is uncorrelated with $u$—appropriate for our designed SAI inputs. For MIMO settings (e.g., multiple latitude–altitude injection channels), \eqref{eq:frf} generalizes with $\widehat{S}_{yu}\in\mathbb{C}^{p\times m}$ and $\widehat{S}_{uu}\in\mathbb{C}^{m\times m}$; independent excitation across channels ensures identifiability [\cite{pintelon2012system}]. The magnitude-squared coherence
\begin{equation}
\gamma^2(\omega_k) \;=\; 
\frac{\lVert \widehat{S}_{yu}(\omega_k) \rVert_F^2}{\mathrm{trace}\big(\widehat{S}_{yy}(\omega_k)\big)\,\mathrm{trace}\big(\widehat{S}_{uu}(\omega_k)\big)}
\label{eq:coherence}
\end{equation}
diagnoses signal-to-noise ratio (SNR) and line selection; $\gamma^2\rightarrow 1$ indicates high SNR at $\omega_k$ [\cite{pintelon2012system}]. Variance can be reduced via multi-taper spectral estimation; with $K$ orthogonal tapers, the degrees of freedom scale as $\nu\approx 2KM$.

Leakage is managed by two complementary strategies: (i) design of periodic multi-sines with frequencies on the DFT grid over an integer number of periods, and separated harmonic sets to isolate nonlinear products; (ii) a leakage-corrected local polynomial method (LPM) that regresses $Y(\omega)$ on $U(\omega)$ in a small neighborhood of each excited line to remove bias from nearby colored spectra [\cite{pintelon2012system}]. We regularize the nonparametric FRF with a smoothness prior across frequency using a second-difference penalty,
\begin{equation}
\min_{\{G_k\}} \;\sum_{\omega_k\in\Omega} w_k\, \lVert Y_k - G_k U_k\rVert_2^2 \;+\; \lambda\, \sum_k \lVert \Delta^2 G_k\rVert_2^2,
\quad w_k \propto \gamma^2(\omega_k),
\label{eq:smoothfrf}
\end{equation}
and select $\lambda$ via an L-curve criterion, as in E1.

\paragraph{Parametric spectral regression and uncertainty.}
For compact surrogate models, we fit parametric FRFs $G(\omega,\theta)$ (e.g., low-order rational forms or basis expansions) by frequency-domain output-error minimization with noise weighting,
\begin{equation}
\widehat{\theta} \;=\; \arg\min_{\theta}\; 
\sum_{\omega_k\in\Omega} \big\lVert \widehat{S}_{ee}^{-1/2}(\omega_k)\, \big(Y_k - G(\omega_k,\theta) U_k\big) \big\rVert_2^2,
\label{eq:pdo}
\end{equation}
with $\widehat{S}_{ee}$ estimated from unexcited lines or residuals. Under Whittle-type approximations, the asymptotic Fisher information is [\cite{ljung1999system,pintelon2012system}]
\begin{equation}
\mathcal{I}_{ij}(\theta) \;\approx\; 
\sum_{\omega_k\in\Omega} 
2\,\mathrm{Re}\!\left\{
\frac{\partial G^\ast}{\partial \theta_i}(\omega_k,\theta)\,
\frac{\partial G}{\partial \theta_j}(\omega_k,\theta)
\right\}
\frac{\lVert U_k\rVert_2^2}{S_{ee}(\omega_k)}.
\label{eq:fim}
\end{equation}
Equation \eqref{eq:fim} links directly to information-optimal probe design: subject to constraints on total variance, SAOD, and ozone chemistry, allocate input power $|U_k|^2$ across $\Omega$ to maximize $\log\det \mathcal{I}(\theta)$ or minimize a posteriori parameter covariance [\cite{ljung1999system}, cf. input design reviews]. In climate applications, spectral regression has been used to extract sensitivities from short simulations with colored noise, reinforcing its suitability for our designed experiments [e.g., spectral regression approaches in climate, \cite{enhanced_9_20250812}].

\paragraph{Nonlinear distortion: BLA, harmonics, and Volterra cross-bispectra.}
At small but finite amplitudes, the Best Linear Approximation (BLA) $G_{\mathrm{BLA}}(\omega)$ captures the effective linear response in the presence of nonlinearities and colored noise; deviations at unexcited harmonics quantify distortion [\cite{pintelon2012system}]. We define a harmonic distortion index (HDI) for output $y$ as
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega_h \in \mathcal{H}} \lVert Y(\omega_h)\rVert_2^2}{\sum_{\omega_k\in\Omega} \lVert Y(\omega_k)\rVert_2^2},
\label{eq:hdi}
\end{equation}
where $\mathcal{H}$ collects nonlinearly generated lines (harmonics and intermodulation) not present in $\Omega$. For mechanistic insight and cross-frequency prediction (E2), we estimate the second-order Volterra kernel $H_2(\omega_1,\omega_2)$ on a sparse grid using cross-bispectra,
\begin{equation}
\widehat{H}_2(\omega_1,\omega_2) \;=\; 
\frac{\widehat{B}_{yuu}(\omega_1,\omega_2)}{\widehat{S}_{uu}(\omega_1)\,\widehat{S}_{uu}(\omega_2)},
\qquad
\widehat{B}_{yuu}(\omega_1,\omega_2)\!=\!\frac{1}{M}\!\sum_{m}\! Y^{(m)}_{\omega_1+\omega_2} U^{(m)\,*}_{\omega_1} U^{(m)\,*}_{\omega_2},
\label{eq:bispec}
\end{equation}
with sparsity-promoting regularization to control the number of active kernel coefficients, consistent with recent advances in sparse Volterra identification [\cite{enhanced_12_20250812}]. The multi-sine design allocates disjoint odd/even line grids to separate linear and quadratic contributions and to avoid spectral overlap of mixing products [\cite{pintelon2012system}]. Cross-frequency prediction skill and HDI reductions on held-out single-tone tests validate nonlinear surrogates (E2).

\paragraph{Practical considerations in E1–E2.}
To address red, seasonally modulated variability and limited records typical of ESMs, we: (i) pre-process outputs to remove the seasonal cycle and slow drifts (high-pass or co-trending with baseline forcing); (ii) use multi-taper averaging to stabilize spectra; (iii) align input periods with analysis windows to minimize leakage; and (iv) bootstrap across ensemble members and segments for uncertainty quantification. Identifiability diagnostics combine $\gamma^2(\omega)$, the condition number of $\widehat{S}_{uu}(\omega)$ (for MIMO designs), and the smoothness of $\widehat{G}(\omega)$ via the L-curve in \eqref{eq:smoothfrf}. The chosen frequency band (monthly–interannual) targets known modes relevant for SAI impacts and internal variability sampled in ARISE-SAI and CESM(WACCM) ensembles [\cite{tilmes2018stratospheric,richter2022assessingresponses}].

\paragraph{From identified spectra to control and early warning.}
The estimated FRFs provide frequency-weighted model fits for $H_\infty$ synthesis and constraints for MPC (e.g., penalizing gain peaking near hydrological sensitivity bands), advancing beyond static or ad hoc temporal modulation [\cite{macmartin2014dynamicsof}]. Repeated spectral identification as baseline forcing escalates enables tracking of phase-lag drift $\phi(\omega)$ and HDI growth as early-warning indicators of reduced stability margins—complementary to passive variance/autocorrelation metrics in complex systems [\cite{enhanced_5_20250812}]. The proposed active spectroscopy thus directly links information-optimal excitation, leakage-aware spectral regression, and compact surrogate dynamics to the design and governance of robust SAI controls, responding to longstanding calls for careful, quantitative experimentation in this domain [\cite{keith2010researchon,robock200820reasons}].


% === AREA: Pseudo-random binary sequences (PRBS) in climate model excitation. ===

\subsection{PRBS excitation for persistently exciting, information-optimal SAI spectroscopy}

Pseudo-random binary sequences (PRBS) provide an amplitude-limited, near-white input with low crest factor that is widely used to achieve persistence of excitation and efficient frequency-domain identification in noisy, time-varying environments \cite{ljung1999system,pintelon2012system}. In our framework, PRBS perturbations are superimposed on a steady SAI baseline to actively probe the Earth system’s linear and weakly nonlinear dynamics across monthly–interannual bands. Compared to single-tone or chirp inputs, PRBS offers three advantages critical in Earth system models (ESMs): (i) flat, shapeable spectra that maximize Fisher information under amplitude and rate limits \cite{comprehensive_discovery_system}, (ii) straightforward multi-input orthogonal coding for MIMO identification of geographically distinct injection actuators, and (iii) robustness to colored internal variability via coherence-weighted spectral regression \cite{pintelon2012system,Comprehensive Discovery System}. This section details the signal design, identifiability properties, and implementation choices for PRBS-based active spectroscopy of the climate response to SAI.

Designing the PRBS. Let the monthly-sampled injection-rate perturbation be u[k] added to a baseline g_{0} (e.g., 5 TgS yr^{-1}). We generate a binary sequence s[k] ∈ {−1,+1} using an m-stage linear-feedback shift register with period N=2^{m}-1 and bit clock T_{b} (nominally one month), then shape it with a stable, linear, time-invariant (LTI) filter h[k] to meet frequency and slew constraints:
u[k] = A (h⋆s)[k],  S_{uu}(ω) = A^{2}|H(e^{jω})|^{2} S_{ss}(ω),
where A controls RMS amplitude (0.05–0.5 TgS yr^{-1} in E1/E6), S_{ss}(ω) is approximately flat at the discrete PRBS lines over [0,π], and |H| shapes the spectrum to target 0.02–2 cycles yr^{-1} while suppressing submonthly content that would unrealistically stress aerosol microphysics. Because PRBS has crest factor ≈ 1, it utilizes the amplitude budget efficiently relative to multisines with the same RMS \cite{pintelon2012system}. We impose practical constraints from stratospheric aerosol and ozone sensitivities reported in WACCM and ARISE-SAI protocols \cite{tilmes2018stratospheric,richter2022assessingresponses}: |Δu[k]| ≤ δ_{\max} enforces actuator slew limits; ensemble-average SAOD and ozone proxies must remain within agreed bounds during probing.

Fisher-information optimality and coherence targeting. For a linear, time-invariant mapping y=G(q)u+v with colored disturbance v, the frequency-domain Fisher information matrix for parameters θ of G weighted by output-noise spectrum S_{vv} is approximately
F(θ) ≈ ∑_{ω∈Ω} Γ(ω;θ)^{H} Γ(ω;θ) W(ω),  W(ω)= S_{uu}(ω)/S_{vv}(ω),  Γ(ω;θ)=∂G(e^{jω};θ)/∂θ,
so maximizing F subject to amplitude and slew constraints reduces to shaping S_{uu}(ω) toward S_{vv}^{−1}(ω) within the band of interest \cite{Comprehensive Discovery System,Comprehensive Discovery System}. Band-limited PRBS with |H|^{2}∝S_{vv}^{−1} approximates this optimum while preserving low crest factor and implementability. A practical design rule selects A and H to meet target per-frequency magnitude-squared coherence
γ^{2}(ω) = |G(ω)|^{2} S_{uu}(ω) / (|G(ω)|^{2} S_{uu}(ω) + S_{vv}(ω)) ≥ γ_{*}^{2},
ensuring sufficient signal-to-noise for accurate Bode gain/phase estimation in the ENSO and monsoon bands most affected by internal variability \cite{pintelon2012system,Comprehensive Discovery System,Comprehensive Discovery System}. When |G| is uncertain, we iterate: start with conservative A, estimate |G| via H1 spectral regression \cite{pintelon2012system,Comprehensive Discovery System}, then update H to reallocate energy toward weakly observable bands subject to the environmental constraints.

MIMO and orthogonal coding across actuators. To separate regional actuation pathways (e.g., equatorial versus 30°–40° latitude injections, or multiple longitudes), we drive each input channel i with an independently seeded PRBS s_{i}[k] and orthogonalize them over the experiment window using Gold/Hadamard coding:
u_{i}[k] = A_{i} (h⋆s_{i})[k],  E[s_{i}[k] s_{j}[k−τ]] ≈ 0 for i≠j,
so that cross-spectra S_{u_{i}u_{j}}(ω) are negligible. The multi-input frequency response is then estimated from the spectral matrix S_{yu}(ω), S_{uu}(ω) via frequency-wise least squares, yielding Ĝ(ω)=S_{yu} S_{uu}^{−1} with leakage correction and Welch averaging \cite{pintelon2012system}. This design enables simultaneous identification of hemispheric/seasonal gains and lags without time-multiplexing, reducing experiment duration—a key practicality constraint \cite{comprehensive_discovery_system}.

Leakage control, synchronization, and colored-noise robustness. Spectral leakage arises if the record length is not an integer multiple of the PRBS period. Two mitigations are effective: (i) choose m and T_{b} so that T_{\text{exp}} contains an integer number of PRBS periods; (ii) apply segment-wise synchronous averaging over periods and Hann-tapered Welch averaging to reduce variance and leakage \cite{pintelon2012system}. Because internal variability is colored, we use H1/Hv estimators that are asymptotically unbiased in output-noise-dominated settings and explicitly weight frequencies by S_{vv}^{−1}(ω) estimated from control runs \cite{pintelon2012system,Comprehensive Discovery System,Comprehensive Discovery System}. These practices have close analogs in climate spectral regression for sensitivity estimation \cite{comprehensive_discovery_system} and in prior PRBS-like climate excitation studies employing spectral nudging \cite{comprehensive_discovery_system}.

Nonlinear distortions and Volterra probing. PRBS is persistently exciting for linear models and supports weakly nonlinear identification when augmented with multi-level or amplitude-modulated variants \cite{ljung1999system,pintelon2012system}. We adopt a tri-level sequence s̃∈{−1,0,+1} or amplitude-cycled PRBS to break odd/even symmetry and excite quadratic terms. Second-order Volterra kernels are then estimated by sparse regression on polynomial–convolution features, leveraging orthogonality of the coded inputs to separate self- and cross-frequency couplings \cite{Smart Discovery System,Smart Discovery System}. Harmonic Distortion Index (HDI) computed from single-tone validation (E2) quantifies the nonlinear energy leaking into harmonics and intermodulation products; rising HDI under gradually increased baseline forcing is used as an early-warning indicator of loss of linearity and approaching instability \cite{comprehensive_discovery_system}.

Parameter choices and practicality bounds. For monthly excitation and a 10–20 year experiment, m∈{7,8,9} (N=127,255,511) balances frequency resolution and stationarity. With A=0.05–0.5 TgS yr^{-1} RMS and low-pass cutoff near 2 cycles yr^{-1}, total variation in u is bounded by TV ≈ 2A transitions per month, consistent with actuator feasibility and microphysical adjustment timescales \cite{tilmes2018stratospheric,richter2022assessingresponses}. Ensemble sizes of 5–10 members reduce variance in Ŝ_{yu} and stabilize coherence in ENSO bands. Fisher information grows roughly linearly with experiment length and ensemble size until leakage and nonstationarity dominate, enabling E6 trade-off analysis of amplitude–duration–ensemble design under internal variability \cite{Comprehensive Discovery System,Comprehensive Discovery System}. Throughout, we adhere to risk-aware constraints motivated by known SAI side effects and governance considerations \cite{robock200820reasons,keith2010researchon} and benchmark against continuous-injection and naive pulsing baselines from GeoMIP/ARISE-style protocols \cite{kravitz2011thegeoengineering,richter2022assessingresponses}.

Integration with control and early warning. The PRBS-derived MIMO frequency responses and low-order Volterra surrogates feed directly into H∞ and MPC synthesis that allocate actuation across frequency and region to jointly track GMST and constrain hydrological variability \cite{macmartin2014dynamicsof,Smart Discovery System,Comprehensive Discovery System}. Sliding-window PRBS identification enables online monitoring of phase drift and HDI growth, providing early warnings that can outperform passive variance/autocorrelation metrics in detecting emerging instabilities in the closed-loop human–climate system \cite{macmartin2014dynamicsof,Comprehensive Discovery System}. In sum, PRBS excitation is a practical, high–information content probe that complements multi-sine/chirp designs in our active spectroscopy framework, delivering data-efficient, spectrally resolved insight into how temporally modulated SAI propagates through the coupled climate system.


% === AREA: Climate model emulation and surrogate modeling techniques. ===

\subsection{Spectral emulation and surrogate modeling for active SAI spectroscopy}

High-fidelity Earth system models (ESMs) are indispensable for assessing SAI responses, but their computational cost constrains the breadth of active experiments and the scope of controller synthesis and stress-testing. Climate emulators and surrogate models offer a path to close this gap by distilling input–output dynamics into compact predictors that are fast, uncertainty-aware, and control-ready, provided they are trained and validated against well-designed excitations that reveal the relevant frequency structure and nonlinearities. Recent reviews and demonstrations show that deep emulators can reproduce ESM behavior at orders-of-magnitude lower cost, especially when constrained by process knowledge and evaluated across scales and tasks \cite{enhanced_10_20250812,enhanced_7_20250812}. Our framework exploits this capability, but replaces conventional time-domain training targets with frequency-domain objectives and nonlinear distortion diagnostics obtained from information-optimized probes, building on mature system identification theory \cite{ljung1999system,pintelon2012system} and recent advances in spectral regression for climate \cite{enhanced_9_20250812}.

We denote the SAI injection-rate perturbation relative to a baseline by $u_t$ and the vector of outputs (GMST, regional precipitation and circulation indices, SAOD) by $y_t$. For small-amplitude probing, the response can be decomposed into a dominant linear time-invariant (LTI) operator plus low-order nonlinear distortions,
\begin{equation}
y_t \;=\; G(q^{-1})\,u_t \;+\; \sum_{\ell_1,\ell_2} K_2(\ell_1,\ell_2)\,u_{t-\ell_1}u_{t-\ell_2} \;+\; e_t,
\label{eq:lti-volterra}
\end{equation}
where $G$ is a multi-input–multi-output (MIMO) transfer operator, $K_2$ is the second-order Volterra kernel capturing harmonic generation and intermodulation, and $e_t$ is residual variability. Frequency-domain estimators provide $\widehat{G}(\omega_k)=\widehat{S}_{yu}(\omega_k)\widehat{S}_{uu}^{-1}(\omega_k)$ and harmonics/intermodulation power from cross-bispectra under multisine/PRBS/chirp excitation with leakage control \cite{pintelon2012system,enhanced_9_20250812}. These estimates define targets against which we train structured emulators and quantify uncertainty.

We construct a family of spectrally consistent surrogates:
(i) parametric LTI state-space models $\{\dot{x}=A_\theta x+B_\theta u,\,y=C_\theta x+D_\theta u\}$ with explicit time-delay channels to match phase; 
(ii) Hammerstein–Wiener and LTI–Volterra hybrids to represent weak nonlinearities; and 
(iii) Koopman-regressed linear predictors for multi-output dynamics. To encourage physical plausibility and control-compatibility, we impose priors such as smooth, minimum-phase Bode characteristics, strictly proper temperature channels, and sign/magnitude bounds motivated by ESM ensembles and GeoMIP/ARISE protocols \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Sparse Volterra identification stabilizes the nonlinear component and avoids overfitting \cite{enhanced_12_20250812,ljung1999system}.

Training minimizes a composite spectral loss that aligns emulator gain/phase and nonlinear distortion with estimates from active spectroscopy:
\begin{align}
\mathcal{L}(\theta) \;=\; &\sum_{k\in\mathcal{K}} w_k 
\Big\| \widehat{G}(\mathrm{j}\omega_k) - G_\theta(\mathrm{j}\omega_k) \Big\|_2^2 
\;+\; \alpha \sum_{k\in\mathcal{K}} w_k\, \Delta\phi_k^2
\notag\\
&+\; \beta \,\big\| \widehat{\mathcal{F}\{K_2\}} - \mathcal{F}\{K_{2,\theta}\}\big\|_F^2
\;+\; \lambda\,\mathcal{R}(\theta),
\label{eq:spectral-loss}
\end{align}
where $\Delta\phi_k$ is the phase error, $\mathcal{F}\{\cdot\}$ denotes the 2D Fourier transform over kernel lags, $w_k$ weights frequencies by Fisher information and governance-relevant bands, and $\mathcal{R}$ enforces smoothness/minimum-phase structure \cite{pintelon2012system,enhanced_6_20250812,enhanced_2_20250812}. The weights $w_k$ are computed from the designed probe spectrum and residual spectra, emphasizing frequencies that are both identifiable and decision-critical (monthly to interannual bands; E1). Because the excitation is designed, spectral leakage is controlled via synchronized multisine phases or DPSS tapers, yielding near-unbiased $\widehat{G}$ and low estimator variance for a given experiment length \cite{pintelon2012system}.

Uncertainty quantification is integrated at two levels. First, spectral regression furnishes parameter covariances for $\widehat{G}(\omega_k)$ that translate into frequency-dependent confidence sets for $G_\theta$ via Eq. \eqref{eq:spectral-loss}. Second, we place Bayesian last-layer or ensemble distributions over emulator parameters to capture structural uncertainty and to combine information across model tiers (aquaplanet, EMIC, ESM) using hierarchical priors \cite{enhanced_8_20250812,enhanced_7_20250812}. For robust control, we summarize emulator mismatch as a multiplicative uncertainty bound,
\begin{equation}
\Delta(\omega_k) \;=\; \frac{\big\| \widehat{G}(\mathrm{j}\omega_k) - G_\theta(\mathrm{j}\omega_k)\big\|_2}{\max\{\|G_\theta(\mathrm{j}\omega_k)\|_2,\varepsilon\}} \;\le\; W(\omega_k),
\label{eq:multiplicative-uncertainty}
\end{equation}
and select weighting $W$ so that $H_\infty$ and tube MPC synthesis guarantee tracking and constraint satisfaction under identified frequency-dependent uncertainty (E3) \cite{macmartin2014dynamicsof}. This yields controllers that explicitly trade off GMST regulation and regional hydrology variance while limiting SAOD excursions, and that can be stress-tested under ENSO-like variability and eruption shocks using the fast surrogate before targeted ESM confirmation.

The active-sensing design is essential for emulator quality and data efficiency. Information-optimal multisine/PRBS waveforms concentrate power in bands where $G$ is most uncertain and where policy-relevant tradeoffs reside, accelerating Fisher information growth subject to variance/chemistry constraints (E1, E6) \cite{ljung1999system,enhanced_6_20250812}. In turn, training on frequency-optimized experiments reduces emulator bias and variance relative to passive or single-impulse designs, which cannot recover cross-frequency structure or phase behavior with comparable data budgets. The nonlinear block is constrained by a harmonic distortion index (HDI) term in Eq. \eqref{eq:spectral-loss}; growth in HDI and phase drift toward $-\pi$ with escalating baseline forcing provide early-warning signals of emerging instability (E4), complementing classical variance/autocorrelation metrics \cite{enhanced_9_20250812,enhanced_10_20250812}. 

Validation proceeds along three axes. 
(i) Signal-space: reproduce held-out single-tone and multisine tests, reporting RMSE, coherence, and HDI (E2). 
(ii) Task-space: reproduce controller-in-the-loop performance statistics and constraint violation rates under stochastic forcings (E3). 
(iii) Model-space: cross-model transfer from intermediate to CESM-like configurations with stratospheric chemistry \cite{richter2022assessingresponses}, quantifying generalization error and robustness margins (E5) \cite{enhanced_7_20250812}. Throughout, we benchmark against GeoMIP-style continuous SAI baselines \cite{kravitz2011thegeoengineering} and employ ensembles from CESM1(WACCM) and ARISE-SAI protocols to contextualize surrogate uncertainty \cite{tilmes2018stratospheric,richter2022assessingresponses}. 

This spectral emulation layer operationalizes the proposed “active spectroscopy of the climate” by (a) fusing information-optimal experiments with frequency-domain identification \cite{pintelon2012system,ljung1999system}, (b) delivering compact, uncertainty-aware surrogates that are directly consumable by $H_\infty$/MPC, and (c) exposing early-warning features (phase drift, harmonic growth) unavailable to passive observation. Given the stakes of SAI and the need for transparent, stress-tested tools \cite{robock200820reasons,keith2010researchon}, such emulators enable rapid iteration in silico while reserving expensive ESM time for confirmatory runs and edge-case audits, thereby improving both the rigor and the governance relevance of temporal SAI strategy design \cite{enhanced_2_20250812,enhanced_10_20250812}.


% === AREA: Optimization algorithms for multi-objective climate control. ===

\subsection{Multi-objective robust control synthesis from active spectral identification}

Active spectroscopy yields frequency-domain surrogates that are directly usable for controller design: small, information-optimized multi-sine/PRBS perturbations produce estimates of the Bode gain/phase between injection rate and key outputs, together with uncertainty quantification from the Fisher information and residual spectra \citep{ljung1999system,pintelon2012system}. Building on these estimates, we pose SAI control as a multi-objective robust optimization that trades GMST tracking against regional hydrological stability and stratospheric aerosol/ozone constraints, consistent with the closed-loop framing in \citet{macmartin2014dynamicsof} and the scenario protocols in \citet{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}.

We write a spectrally identified surrogate between scalar (or low-dimensional) injection control $u_t$ and a stacked output vector $y_t = [T_t,\; P_t,\; S_t]^\top$ comprising GMST anomaly $T_t$, a regional precipitation index $P_t$, and a stratospheric aerosol optical depth metric $S_t$:
\begin{equation}
y_t \;=\; G(q^{-1};\hat\theta)\, u_t \;+\; H(q^{-1})\, w_t \;+\; e_t,
\label{eq:lin-surrogate}
\end{equation}
where $G$ is estimated from the designed probes via spectral regression with leakage correction, $H$ shapes exogenous variability $w_t$ (e.g., ENSO-like), and $e_t$ is small residual noise. Nonlinear distortions captured by a second-order Volterra model in the identification stage are treated in control synthesis as frequency-shaped disturbances and multiplicative uncertainty centered on the linear response \citep{pintelon2012system}. In the frequency domain this yields
\begin{equation}
G_\Delta(e^{j\omega}) \;=\; G(e^{j\omega};\hat\theta)\,\bigl[\,1 + W_\Delta(e^{j\omega})\,\Delta(e^{j\omega})\,\bigr],\quad \|\Delta\|_\infty \le 1,
\label{eq:mult-unc}
\end{equation}
with an uncertainty weight $W_\Delta$ computed from identification covariance and residual spectra:
\begin{equation}
|W_\Delta(e^{j\omega})| \;\approx\; \kappa \,\frac{\sqrt{\,\nabla_\theta G(e^{j\omega})\,\Sigma_\theta\,\nabla_\theta G(e^{j\omega})^\ast\, +\, S_{ee}(\omega)\,}}{\;|G(e^{j\omega};\hat\theta)| + \varepsilon\;},
\label{eq:WDelta}
\end{equation}
where $\Sigma_\theta$ is the parameter covariance from the Fisher information of the probing experiment, $S_{ee}$ is the residual power spectrum, and $\kappa$ sets a desired confidence level \citep{ljung1999system,pintelon2012system}.

We define a vector of regulated outputs that reflect policy-relevant objectives and safety limits via frequency-shaping weights $W_T, W_P, W_S, W_U$:
\begin{equation}
z_t \;=\; 
\begin{bmatrix}
W_T(q^{-1})\,(T_t - r_t) \\
W_P(q^{-1})\,P_t \\
W_S(q^{-1})\,S_t \\
W_U(q^{-1})\,\Delta u_t
\end{bmatrix},
\qquad \Delta u_t := u_t - u_{t-1}.
\label{eq:regulated-z}
\end{equation}
Here $r_t$ is the GMST reference, $W_P$ emphasizes bands where precipitation variability is most sensitive to forcing, and $W_S$ penalizes SAOD excursions in line with chemistry/ozone concerns \citep{richter2022assessingresponses}. The weights $W_\cdot$ are constructed from the identified Bode responses and governance priorities, emphasizing monthly–interannual bands where controllability is non-negligible \citep{pintelon2012system}.

Robust $\mathcal{H}_\infty$ synthesis. We consider standard mixed-sensitivity robust control with multiplicative uncertainty \eqref{eq:mult-unc}:
\begin{equation}
\min_{K} \;\;\max_{\|\Delta\|_\infty \le 1}\;\; \bigl\|\, T_{z w}(K; G_\Delta)\,\bigr\|_\infty,
\label{eq:hinf}
\end{equation}
where $K$ is a stabilizing controller and $T_{zw}$ is the closed-loop transfer from exogenous disturbances to the regulated outputs \eqref{eq:regulated-z}. To expose policy trade-offs, we compute a Pareto set by solving \eqref{eq:hinf} under a family of weightings $\{W_T,W_P,W_S,W_U\}$ that sweep priorities, or by using an $\varepsilon$-constraint formulation in which, for example, the SAOD and precipitation norms are bounded while minimizing the temperature-tracking norm. The uncertainty weight $W_\Delta$ in \eqref{eq:WDelta} propagates identification error and nonlinear residuals into robustness margins, ensuring that closed-loop guarantees reflect what the active probes actually resolved \citep{ljung1999system,pintelon2012system}. This addresses a key limitation noted in the SAI literature: open-loop comparisons can be misleading when feedbacks and delays are uncertain \citep{macmartin2014dynamicsof}.

Frequency-shaped MPC. For scenarios with constraints that are more naturally expressed in the time domain (e.g., SAOD caps, regional precipitation envelope), we build a lifted state-space surrogate by fitting a low-order predictor to the identified frequency response (e.g., via Prony/ERA or Koopman-regressed linear predictors):
\begin{equation}
x_{t+1} = A x_t + B u_t + B_w w_t,\qquad y_t = C x_t + D u_t.
\label{eq:ss-surrogate}
\end{equation}
We then solve a receding-horizon problem with multi-objective cost and hard safety constraints:
\begin{align}
\min_{\{u_{t:t+N-1}\}}\;& \sum_{\tau=t}^{t+N-1} \Bigl[ \|W_T(q^{-1})(T_\tau - r_\tau)\|_2^2 + \|W_P(q^{-1}) P_\tau\|_2^2 \nonumber\\
&\qquad\qquad + \|W_S(q^{-1}) S_\tau\|_2^2 + \|W_U(q^{-1}) \Delta u_\tau\|_2^2 \Bigr] \label{eq:mpc}\\
\text{s.t.}\;&\; S_\tau \le S_{\max},\;\; P_\tau \in \mathcal{P},\;\; u_{\min} \le u_\tau \le u_{\max},\nonumber
\end{align}
with tube or stochastic MPC variants to account for uncertainty informed by $W_\Delta$ and residual spectra. The frequency-shaping filters $W_\cdot(q^{-1})$ are implemented as stable IIR augmentations of \eqref{eq:ss-surrogate}, so that spectral priorities learned from active probes carry through to the time-domain optimizer \citep{pintelon2012system}. This closed-loop formulation complements existing scenario protocols \citep{kravitz2011thegeoengineering,richter2022assessingresponses} and large-ensemble demonstrations of SAI feasibility in ESMs \citep{tilmes2018stratospheric}.

Harmonic-distortion-aware safety margins. To reflect nonlinear risks, we include a distortion penalty derived from the identified second-order Volterra kernels. Let $\Omega_{\mathrm{ex}}$ denote the set of excited fundamentals; define a harmonic distortion index for each tone $\omega_k \in \Omega_{\mathrm{ex}}$ as
\begin{equation}
\mathrm{HDI}_k \;=\; \frac{\sum_{m\ge 2} \|Y(m\omega_k)\|_2^2}{\|Y(\omega_k)\|_2^2},
\label{eq:hdi}
\end{equation}
estimated from spectral regression using multi-sine/PRBS data. We either add $\lambda_{\mathrm{HD}}\sum_k \mathrm{HDI}_k$ to the objective in \eqref{eq:mpc} or enforce $\mathrm{HDI}_k \le \bar{h}$ as a constraint, thereby discouraging control actions that push the system into regimes with strong intermodulation or harmonic growth. Phase-lag drift toward $-\pi$ in identified Bode phase, together with rising HDI, can trigger conservative weight scheduling (e.g., increasing $W_P, W_S$ relative to $W_T$) to prioritize hydrological and stratospheric safety as instabilities are approached. These early-warning adaptations are implemented without changing the underlying controller structure, only its weights and constraint levels, and can be benchmarked against passive baselines within the same ESM experiments.

Cross-model robustness and governance mapping. To assess portability across models, we solve the robust design across an ensemble of surrogates $\{G^{(m)}\}$ identified from multiple ESMs or configurations:
\begin{equation}
\min_{K}\;\max_{m,\;\|\Delta\|_\infty\le 1}\;\bigl\|T_{z w}\bigl(K; G^{(m)}_\Delta\bigr)\bigr\|_\infty,
\label{eq:multi-model}
\end{equation}
mirroring intercomparison logic from GeoMIP \citep{kravitz2011thegeoengineering}. The resulting Pareto front is then a governance object: decision-makers choose a point reflecting acceptable trade-offs between tracking performance and regional/safety constraints, with uncertainty bounds that are traceable to the information content of the active probes. This research-only, in-silico workflow aligns with calls for careful, bounded investigation of solar climate intervention \citep{keith2010researchon,robock200820reasons}.

Evaluation metrics and expected gains. Within the protocol of Experiment E3, we compute: (i) tracking RMSE for GMST, (ii) precipitation constraint-violation rate, (iii) SAOD overshoot frequency, (iv) controller effort via total variation norm of $u_t$, (v) worst-case regional anomaly under volcanic and ENSO-like disturbances, and (vi) regret versus an oracle with the true model. Because the identification targets the controllable bandwidth and quantifies uncertainty where sensitivity is high, the proposed multi-objective robust synthesis is expected to dominate naive continuous or ad hoc pulsing baselines in both performance and safety margins, while remaining computationally feasible with surrogate orders and horizons commensurate with academic resources \citep{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.


% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{SAI impacts and uncertainties: motivating active spectroscopy and control}

Large-ensemble and intercomparison studies have established that stratospheric aerosol injection (SAI) produces spatially heterogeneous responses and significant uncertainties in hydrological and dynamical fields even when global-mean temperature is stabilized \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. These uncertainties underpin key governance concerns, including the potential for unintended regional impacts and policy lock-in \cite{robock200820reasons}, while also motivating systematic research on controllability and risk-aware operation \cite{keith2010researchon}. Prior work demonstrated that closed-loop control can, in principle, regulate global-mean temperature under model uncertainty \cite{macmartin2014dynamicsof}, yet the control-relevant dynamics by which temporally modulated SAI propagates through the coupled system remain poorly quantified. Most existing protocols rely on steps, ramps, or quasi-steady injection schedules and evaluate aggregate responses; this obscures frequency-dependent gains, lags, and nonlinear distortions that are central to robust controller synthesis and to early detection of emergent instabilities.

We propose to treat pulsed SAI as an in silico spectroscopy experiment: small-amplitude, information-optimized perturbations superimposed on a baseline scenario in Earth system models (ESMs) to directly estimate frequency response functions (FRFs) and low-order nonlinearities. Classical system identification shows that designed excitations maximize Fisher information and yield consistent, data-efficient FRF estimates even under colored disturbances and leakage \cite{ljung1999system,pintelon2012system}. Embedding such probes within established SAI protocols (e.g., GeoMIP-style scenarios and ARISE-SAI setups \cite{kravitz2011thegeoengineering,richter2022assessingresponses}) leverages community infrastructure while targeting the specific dynamical pathways that drive uncertainties highlighted by large ensembles \cite{tilmes2018stratospheric}.

Let the control input be the zonal-mean injection rate anomaly about a baseline, \(u(t)\) [TgS yr\(^{-1}\)], and \(y(t)\) a scalar or vector climate output (e.g., GMST, regional precipitation indices, stratospheric winds). We excite the system with an asynchronous multi-sine,
\begin{equation}
u(t) \;=\; u_0 \;+\; \sum_{k=1}^{K} a_k \cos\!\big(2\pi f_k t + \phi_k \big),
\label{eq:multisine}
\end{equation}
with small RMS amplitudes (e.g., 0.05–0.5 TgS yr\(^{-1}\)) to preserve a local approximation while remaining above internal-variability noise floors. Frequencies \(f_k\) span monthly to interannual bands relevant to coupled modes (0.02–2 yr\(^{-1}\)), and phases \(\phi_k\) are chosen to minimize crest factors and aliasing \cite{pintelon2012system}. For a quasi-linear time-invariant approximation over the perturbation scale, the FRF from \(u\) to each component of \(y\) is estimated by spectral regression with leakage correction,
\begin{equation}
\widehat{G}(\omega_m) \;=\; \frac{\widehat{S}_{yu}(\omega_m)}{\widehat{S}_{uu}(\omega_m)}, 
\qquad 
\gamma^2(\omega_m) \;=\; \frac{|\widehat{S}_{yu}(\omega_m)|^2}{\widehat{S}_{yy}(\omega_m)\,\widehat{S}_{uu}(\omega_m)},
\label{eq:frf}
\end{equation}
where hats denote windowed, locally averaged cross- and auto-spectra and \(\gamma^2\) is the magnitude-squared coherence used to quantify reliability and signal-to-noise \cite{pintelon2012system}. The FRF furnishes Bode gain/phase for temperature and hydrological pathways, revealing band-limited attenuation or amplification and phase lags that are obscured in step/ramp experiments.

To characterize weak nonlinearities that are prominent in moisture-convection feedbacks and in stratosphere–troposphere coupling, we adopt a second-order Volterra representation \cite{ljung1999system},
\begin{equation}
y(t) \;\approx\; (g_1*u)(t) \;+\; \iint h_2(\tau_1,\tau_2)\,u(t-\tau_1)\,u(t-\tau_2)\,d\tau_1 d\tau_2,
\label{eq:volterra}
\end{equation}
estimated from multi-sine/PRBS inputs by sparse regularization on polynomial–convolution features. Nonlinear harmonics and intermodulation terms are summarized by a harmonic distortion index,
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega \in \mathcal{H}} \widehat{P}_y(\omega)}{\sum_{\omega \in \mathcal{F}} \widehat{P}_y(\omega)},
\label{eq:hdi}
\end{equation}
where \(\mathcal{F}=\{2\pi f_k\}\) are fundamentals and \(\mathcal{H}\) collects generated harmonics and sum/difference frequencies. Trends in phase \(\angle \widehat{G}(\omega)\) and HDI under gradual forcing escalation are proposed as early-warning indicators of approaching instabilities, complementing variance-based diagnostics and directly tied to the control-relevant channels.

Input phases and amplitudes are selected by maximizing an information criterion subject to environmental constraints (e.g., limits on SAOD excursions or ozone-relevant exposure within WACCM-class chemistry \cite{tilmes2018stratospheric,richter2022assessingresponses}). For a parametric FRF \(G(\omega;\theta)\), the (approximate) Fisher information matrix aggregates over excited lines:
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \sum_{\omega \in \mathcal{F}} 
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\right]^{\!*}
\frac{\widehat{S}_{uu}(\omega)}{\widehat{S}_{\varepsilon\varepsilon}(\omega)}
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\right],
\qquad 
\max_{\,\{a_k,\phi_k\}} \;\log\det \mathcal{I}(\theta) \;\; \text{s.t.}\;\; \mathcal{C}(a,\phi)\leq c,
\label{eq:opt}
\end{equation}
with \(\widehat{S}_{\varepsilon\varepsilon}\) the disturbance spectrum and \(\mathcal{C}\) encoding constraints. This is directly aligned with best practice in frequency-domain identification \cite{pintelon2012system,ljung1999system}, while ensembles or moderate replication mitigate internal variability, consistent with large-ensemble design in \cite{tilmes2018stratospheric}.

The identified surrogates enable robust controller synthesis that explicitly trades off global-mean temperature tracking against regional hydrological stability. Building on \cite{macmartin2014dynamicsof}, we frame an \(H_\infty\) problem that penalizes tracking error, precipitation variance proxies, and SAOD excursions under exogenous disturbances (e.g., ENSO-like variability, volcanic forcing):
\begin{equation}
\min_{K} \;\;\| T_{zw}(K) \|_{\infty} 
\quad \text{with} \quad 
z = W_e\,e \oplus W_p\,p \oplus W_q\,\delta\mathrm{SAOD}, 
\quad w=\text{natural variability and scenario perturbations},
\label{eq:hinf}
\end{equation}
where \(T_{zw}\) is the closed-loop transfer matrix from disturbances \(w\) to weighted performance outputs \(z\), and \(K\) acts on the identified surrogate (frequency-domain weights or a Koopman-regressed predictor). Such controllers can be benchmarked against continuous and naive pulsed baselines within ARISE-SAI and GeoMIP-style experiments \cite{richter2022assessingresponses,kravitz2011thegeoengineering}.

In sum, by embedding small, well-designed perturbations into standard SAI modeling protocols, we directly resolve frequency-dependent pathways and weak nonlinearities that drive the most consequential uncertainties for both impacts and control. This approach is feasible with existing models and ensembles \cite{tilmes2018stratospheric,richter2022assessingresponses}, aligns with the information-theoretic advantages of designed excitation \cite{ljung1999system,pintelon2012system}, supports closed-loop operation under uncertainty \cite{macmartin2014dynamicsof}, and addresses calls for disciplined, decision-relevant SAI research while acknowledging risks and unknowns \cite{keith2010researchon,robock200820reasons}.


% === AREA: Information theory applications in climate science and modeling. ===

\subsection{Information-theoretic probe design for active climate spectroscopy}
A central premise of our framework is that rigorously designed inputs maximize the information content of model outputs relevant to identification and control. In established system identification, the choice of excitation strongly governs estimator variance and bias, and Fisher-information–based input design is the canonical way to formalize this trade-off under constraints (Ljung, 1999; Pintelon and Schoukens, 2012). We adapt these ideas to stratospheric aerosol injection (SAI) experiments in Earth system models (ESMs), embedding small-amplitude, information-optimized pulses within standardized SAI scenarios (Kravitz et al., 2011; Tilmes et al., 2018; Richter et al., 2022). This enables spectral ‘‘active sensing’’ of the climate response while remaining compatible with the ensemble protocols and operational constraints of SAI simulations.

We linearize the input–output map of each target variable around an SAI baseline, write in the frequency domain
\[
Y_j(\omega) \;=\; G_{j,\theta}(\omega)\,U(\omega) \;+\; E_j(\omega), \quad j=1,\dots,m,
\]
where $U$ is the designed perturbation (multi-sine/PRBS/chirp), $G_{j,\theta}$ is a parametric frequency response for output $y_j$ with parameters $\theta$, and $E_j$ collects internal-variability and model-noise contributions with power spectral density (PSD) $S_{e,j}(\omega)$. For spectral regression estimators, asymptotic covariance scales with the input spectrum and observation length; in particular, the variance of $\widehat{G}$ decreases like $S_{e}(\omega)/\big(N\,|U(\omega)|^2\big)$ at excited frequencies, up to leakage and windowing corrections (Pintelon and Schoukens, 2012). A convenient approximation to the Fisher information matrix (FIM) for $\theta$ aggregates contributions across frequencies and outputs as
\[
\mathcal{I}(\theta;U) \;\approx\; \sum_{\omega\in\Omega}\;\sum_{j=1}^{m}
\frac{N\,|U(\omega)|^2}{S_{e,j}(\omega)}\;
\Big(\partial_{\theta} G_{j,\theta}(\omega)\Big)^{\!\!H}\,
\Big(\partial_{\theta} G_{j,\theta}(\omega)\Big),
\]
where $N$ is the effective sample size and $\Omega$ is the set of excited frequencies. This expression, standard in frequency-domain identification, makes explicit the roles of (i) spectral placement and power of the probe, (ii) output-specific noise PSDs, and (iii) the sensitivity of the chosen model class to parameters (Ljung, 1999; Pintelon and Schoukens, 2012).

We pose input design as a constrained optimal experiment problem:
\[
\begin{aligned}
\max_{U\in\mathcal{U}} \quad & \Psi\big(\mathcal{I}(\theta_0;U)\big) \\
\text{s.t.}\quad & \text{RMS}(u)\leq A_{\max}, \;\; \text{CF}(u)\leq C_{\max}, \;\; \mathrm{Var}[\mathrm{SAOD}(u)]\leq V_{\max}, \\
& U(\omega)=0 \;\text{ for }\; \omega\notin[0.02,\,2]\;\text{cycles/yr}, \\
& u(t)=\sum_{k=1}^{K} a_k \sin(2\pi f_k t+\phi_k) \;\text{ or PRBS/chirp}.
\end{aligned}
\]
Here $\Psi$ is an information criterion (e.g., D-optimal $\log\det$, A-optimal $\operatorname{tr}$), $\theta_0$ is a prior nominal parameter vector, $A_{\max}$ enforces small-amplitude probing (0.05–0.5 TgS/yr RMS in E1/E6), $C_{\max}$ limits crest factor to avoid unrealistic peaks, $V_{\max}$ bounds aerosol optical depth variability to respect chemistry and radiative constraints present in ARISE-SAI-like simulations (Richter et al., 2022), and the frequency band matches the monthly–interannual scales of interest. Random-phase multisines and PRBS are classical choices to achieve broadband excitation with near-flat spectra and favorable leakage properties; phase optimization further concentrates power into high-sensitivity bands while controlling the crest factor (Pintelon and Schoukens, 2012).

This formulation directly links design choices to identifiability:
- Spectral allocation: The factor $|U(\omega)|^2/S_{e,j}(\omega)$ favors placing energy where outputs have high signal-to-noise ratio and where model parameters most affect $G_{j,\theta}(\omega)$. Multi-output design naturally trades off across variables (temperature, precipitation indices, circulation metrics) by summing their contributions in $\mathcal{I}$.
- Experiment length and ensembles: Information scales roughly linearly with $N$ and additively across independent realizations; thus, duration and ensemble size can be traded for amplitude within practical bounds (Ljung, 1999). E6 formalizes these trade-offs.
- Leakage control: Sparse line spectra (multisines) with window-aligned frequencies reduce leakage bias, improving the validity of the asymptotic covariance expressions underlying $\mathcal{I}$ (Pintelon and Schoukens, 2012).

We connect identification to control by quantifying the value-of-information (VoI) for SAI governance. Let $J_{\mathrm{ctrl}}(\pi,\theta)$ denote a closed-loop performance measure for policy $\pi$ (e.g., GMST tracking error with penalties on regional hydrological variance and SAOD excursions), and let $\Sigma_{\theta}$ be the parameter covariance implied by a prior or by an experiment via $\mathcal{I}^{-1}$. A simple VoI proxy for a candidate probing plan $U$ is
\[
\mathrm{VoI}(U) \;\equiv\; \mathbb{E}_{\theta\sim\mathcal{N}(\theta_0,\Sigma_{\theta}^{\text{prior}})}\!\big[J_{\mathrm{ctrl}}(\pi^{\star}_{\text{post}},\theta) - J_{\mathrm{ctrl}}(\pi^{\star}_{\text{prior}},\theta)\big],
\]
where $\pi^{\star}_{\text{post}}$ and $\pi^{\star}_{\text{prior}}$ are the controllers synthesized using posterior and prior uncertainty, respectively. By reducing $\Sigma_{\theta}$ via information-optimal probes, we expect improved robustness margins and reduced regret in the closed-loop SAI setting (MacMartin et al., 2014). In practice, we approximate this expectation via Monte Carlo over $\theta$ drawn from Gaussians with covariance $\mathcal{I}(\theta_0;U)^{-1}$ and propagate through H-infinity/MPC synthesis.

Information metrics also furnish early-warning indicators complementary to passive variance/autocorrelation measures. Two examples we evaluate in E4 are:
(i) frequency-specific coherence $\gamma_j^2(\omega)$ between $u$ and $y_j$, whose degradation or redistribution across harmonics signals growing nonlinearity or regime shifts that violate the assumed linear map (Pintelon and Schoukens, 2012); and
(ii) eigenvalue drift of $\mathcal{I}$ as the baseline SAI level increases, where shrinking smallest eigenvalues indicate emerging unidentifiable directions and potential loss of controllability in critical bands. These are paired with the phase-lag drift and harmonic distortion growth tested under gradually intensified forcing.

Methodologically, our design complements existing community protocols. GeoMIP and ARISE-SAI define standardized forcing scenarios and diagnostics (Kravitz et al., 2011; Tilmes et al., 2018; Richter et al., 2022). We retain those baselines but superimpose small, information-optimized probes that are invisible to long-term means yet highly visible in the frequency domain. This aligns with calls to explore closed-loop, risk-aware SAI strategies (MacMartin et al., 2014) while heeding concerns about potential side effects by constraining probe amplitude and aerosol variability (Robock et al., 2008; Keith et al., 2010). The resulting experiments deliver compact, uncertainty-quantified surrogate dynamics for control and early warning with far greater data efficiency than passive observation or ad hoc single impulses, because they explicitly target the spectral pathways by which SAI modulates coupled climate variables (Ljung, 1999; Pintelon and Schoukens, 2012).


% === AREA: Volterra kernel methods for nonlinear system identification in climate models. ===

\subsection{Volterra-kernel spectroscopy of the SAI--climate mapping}

Small-amplitude pulsed SAI provides a controlled, high-information input that enables estimation of not only the linear frequency response from injection rate to climate outputs, but also the dominant nonlinear distortions that manifest as harmonics and intermodulation across time scales. To capture these effects parsimoniously, we adopt a second-order Volterra representation that is compatible with frequency-domain identification using designed multisines and can be validated in Earth system models (ESMs) following established SAI protocols and diagnostics \cite{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}. The approach builds on well-established system identification theory in the time and frequency domains \cite{ljung1999system, pintelon2012system}, and provides compact surrogate dynamics needed for closed-loop control and risk-aware scenario design \cite{macmartin2014dynamicsof}.

Model form. Let u_t denote the SAI injection-rate perturbation (TgS yr^{-1}) superimposed on a steady baseline, and y_t a scalar climate output (e.g., GMST, a regional precipitation index, or circulation metric). For small but non-infinitesimal perturbations, we posit a second-order Volterra series
\begin{equation}
y_t \;=\; \sum_{\tau} h_1(\tau)\, u_{t-\tau} \;+\; \sum_{\tau_1}\sum_{\tau_2} h_2(\tau_1,\tau_2)\, u_{t-\tau_1} u_{t-\tau_2} \;+\; e_t,
\label{eq:volterra_time}
\end{equation}
with h_1 the linear impulse response, h_2 the symmetric second-order kernel, and e_t internal variability and model noise. In the frequency domain, for a periodic experiment with N samples per period and discrete frequencies k=0,\dots,N-1, the discrete Fourier transforms (DFT) satisfy \cite{pintelon2012system}
\begin{equation}
Y(k) \;=\; G_1(k)\, U(k) \;+\; \sum_{p+q \equiv k \,(\text{mod } N)} H_2(p,q)\, U(p)\, U(q) \;+\; E(k),
\label{eq:volterra_freq}
\end{equation}
where G_1(k) is the linear frequency response, H_2(p,q) is the second-order frequency-domain kernel (symmetric in p,q), and the sum runs over all integer pairs (p,q) whose indices sum to k modulo N.

Input design and identifiability. Random-phase multisines and PRBS provide broadband excitation while controlling spectral occupancy and power \cite{pintelon2012system, ljung1999system}. We design multisine inputs with an excited set of discrete frequencies Ω that spans monthly to interannual bands (0.02–2 yr^{-1}), and choose phases to both maximize the Fisher information for G_1 and selected H_2 entries and to mitigate spectral collisions of the form p+q∈Ω that confound separation of linear and nonlinear contributions. Persistency of excitation of order 2 (sufficient nonzero products U(p)U(q) over p+q=k) is required for identifiability of H_2 \cite{ljung1999system}. In practice, we use:
- odd/even grid partitioning to isolate even-order (harmonic) from odd-order distortions, and disjoint sub-bands whose pairwise sums fall outside the fundamental set, following multisine design heuristics that separate nonlinear distortion lines from excited fundamentals \cite{pintelon2012system};
- phase randomization and ensemble averaging across periods to decorrelate internal variability from deterministic distortion, leveraging the ensemble capabilities of ESM projects such as CESM(WACCM) and ARISE-SAI \cite{tilmes2018stratospheric, richter2022assessingresponses}.

Estimation procedure. Given P repeated periods (or ensemble members) with identical U(k) and outputs Y^{(p)}(k), we proceed in two stages:
1) Best Linear Approximation (BLA). For each excited k∈Ω, estimate the linear response via spectral regression with leakage correction \cite{pintelon2012system}:
\begin{equation}
\widehat{G}_\text{BLA}(k) \;=\; \frac{\langle Y(k) U^*(k)\rangle}{\langle |U(k)|^2\rangle},
\end{equation}
where ⟨·⟩ denotes averaging over periods/ensemble members and * is complex conjugation. This yields the Bode gain and phase and their asymptotic covariance (used for information-weighted fits) \cite{pintelon2012system, ljung1999system}.
2) Second-order kernel. Form the residual at all k (both excited fundamentals and non-excited “distortion lines”):
\begin{equation}
R(k) \;=\; Y(k) \;-\; \widehat{G}_\text{BLA}(k)\, U(k).
\end{equation}
Stack the linear system
\begin{equation}
R(k) \;\approx\; \sum_{(p,q)\in \mathcal{P}(k)} H_2(p,q)\, U(p)\,U(q), \quad \mathcal{P}(k)=\{(p,q): p+q\equiv k\},
\end{equation}
over all k in a selected fitting set (including unexcited lines where U(k)=0 but R(k)\neq 0), and solve for H_2 with sparsity-promoting regularization to mitigate multicollinearity and variance:
\begin{equation}
\widehat{H}_2 \;=\; \arg\min_{H_2} \sum_k w_k \left|R(k) - \sum_{(p,q)\in \mathcal{P}(k)} H_2(p,q)\, U(p)U(q)\right|^2 \;+\; \lambda \|H_2\|_1 \;+\; \mu \|H_2\|_F^2,
\label{eq:lasso}
\end{equation}
with weights w_k proportional to the inverse noise spectrum estimated from off-line frequencies, and symmetry enforced by tying H_2(p,q)=H_2(q,p). The L1/L2 penalties control complexity and promote interpretability of cross-frequency couplings.

Diagnostics and validation. We quantify linear fit quality via coherence and nRMSE, and nonlinear characterization via a harmonic distortion index (HDI) and cross-frequency prediction error. Specifically,
- coherence: γ^2(k)=|S_{\widehat{Y}_\text{lin},Y}(k)|^2/(S_{\widehat{Y}_\text{lin}\widehat{Y}_\text{lin}}(k) S_{YY}(k)), where \widehat{Y}_\text{lin}(k)=\widehat{G}_\text{BLA}(k)U(k);
- HDI at fundamental k_m: 
\begin{equation}
\mathrm{HDI}(k_m) \;=\; \frac{\left(\sum_{k\in \mathcal{H}(k_m)} |R(k)|^2\right)^{1/2}}{| \widehat{G}_\text{BLA}(k_m) U(k_m) |},
\end{equation}
with \mathcal{H}(k_m)=\{2k_m,\, k_m\pm k_n: k_n\in\Omega, n\neq m\}, adapted to the discrete grid;
- cross-frequency prediction error: evaluate \widehat{R}(k)=\sum_{(p,q)\in \mathcal{P}(k)} \widehat{H}_2(p,q) U(p)U(q) on held-out single-tone or two-tone tests and report nRMSE over unexcited lines k∉Ω, where pure nonlinear distortion should dominate;
- smoothness and physical plausibility: impose or assess low-pass structure of G_1 and decay/symmetry patterns in H_2 consistent with known slow climate adjustment and aerosol--radiation coupling \cite{kravitz2011thegeoengineering, richter2022assessingresponses}.

Design choices for ESM implementation. Frequency-domain identification requires attention to leakage and aliasing. We use integer-period experiments where feasible and correct residual leakage by local polynomial detrending in the spectral domain \cite{pintelon2012system}. Internal variability acts as colored noise; period- or ensemble-averaging increases effective SNR \cite{ljung1999system}, which is practical in large-ensemble SAI simulations \cite{tilmes2018stratospheric, richter2022assessingresponses}. Probe amplitudes are kept small relative to baselines to stay within the Volterra regime and to respect constraints related to stratospheric aerosol optical depth and chemistry highlighted in scenario protocols and risk assessments \cite{richter2022assessingresponses, robock200820reasons}.

Role in control and early warning. The BLA provides the frequency-dependent gain and phase needed for robust controller synthesis \cite{macmartin2014dynamicsof}, while the estimated H_2 maps quantify amplitude dependence and cross-frequency coupling that inform constraint handling and limit-cycle avoidance in H_\infty/MPC. Monitoring trends in \|\widehat{H}_2\| and HDI as baseline forcing increases offers a principled, in-experiment indicator of growing nonlinear distortion and potential loss of linear controllability, complementing the phase-lag drift observed in \widehat{G}_\text{BLA}.

Relation to prior SAI modeling. Prior intercomparisons and protocols have largely emphasized step or scenario differences and time-mean responses \cite{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}. Volterra-kernel spectroscopy, enabled by designed multisines/PRBS and frequency-domain estimation \cite{pintelon2012system, ljung1999system}, reframes pulsing as a minimally invasive, information-rich experiment that directly reveals both linear pathways and low-order nonlinear distortions in the SAI--climate mapping. This yields compact, transferable surrogate models explicitly suited for control design and provides early-warning indicators grounded in spectral energy re-distribution, both of which are difficult to recover from passive observation or one-off impulses.


% === AREA: Robust control techniques (H-infinity, MPC) for climate stabilization. ===

\subsection{Robust control synthesis from active spectroscopy}

Active spectroscopy yields frequency-resolved surrogate dynamics that are directly actionable for feedback design. We close the loop by synthesizing H-infinity and model predictive controllers that operate on small-signal linearizations of the SAI–climate response identified from designed probes, while explicitly accounting for uncertainty and weak nonlinearity. This section formulates the robust control problem, shows how to translate spectral identification artifacts (coherence, harmonic distortion) into frequency-dependent uncertainty bounds, and specifies controller structures and weights tailored to climate objectives and constraints. We build on prior demonstrations that closed-loop geoengineering can stabilize global temperature in simple models \cite{macmartin2014dynamicsof} and on major community protocols for SAI in Earth system models \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}, integrating frequency-domain system identification \cite{ljung1999system,pintelon2012system} with robust control design, including recent control-oriented studies for climate stabilization \cite{enhanced_4_20250812,comprehensive_4_20250812}.

\paragraph{Uncertain plant from spectroscopy.}
Let the control input be the perturbation in injection rate about a baseline, $u(t)=\delta \dot m_{\rm SO_2}(t)$ [TgS/yr], and let the measured outputs be $y(t)\in\mathbb{R}^p$ (e.g., GMST, regional precipitation indices, zonal-mean stratospheric winds, and SAOD). Designed multi-sine/chirp/PRBS probes produce nonparametric estimates of the frequency response matrix $\hat G(j\omega)$ via spectral regression with leakage correction \cite{pintelon2012system,enhanced_9_20250812,comprehensive_9_20250812}:
\begin{equation}
\hat G(j\omega)=S_{yu}(j\omega)\,S_{uu}^{-1}(j\omega),
\end{equation}
with associated confidence envelopes from the estimated cross-spectral covariance. Weak nonlinearities inferred from second-order Volterra terms and cross-frequency couplings are summarized by a harmonic distortion index $H(\omega)$ (Section E2).

We represent small-signal dynamics as multiplicative output uncertainty around a rational fit $\hat G_r(s)$ of $\hat G$ (obtained by vector fitting), with frequency shaping informed by identification:
\begin{equation}
G(s)=\hat G_r(s)\,\bigl(I+W_\Delta(s)\,\Delta(s)\bigr),\quad \|\Delta\|_\infty\le 1,
\label{eq:mout}
\end{equation}
where $W_\Delta$ bounds the combined effect of finite SNR, leakage, internal variability, and neglected nonlinear distortion. A conservative construction uses the magnitude-squared coherence $\gamma^2(\omega)$ between $u$ and $y$ together with a smoothed harmonic distortion index $H(\omega)$:
\begin{equation}
|W_\Delta(j\omega)|=\alpha\,\sqrt{\frac{1-\gamma^2(\omega)}{\gamma^2(\omega)}}+\beta\,H(\omega),
\label{eq:wdelta}
\end{equation}
with tuning coefficients $\alpha,\beta\ge 0$ that expand uncertainty where the probe is less informative (low coherence) or where nonlinear harmonics are prominent. The mapping in \eqref{eq:wdelta} is motivated by Fisher-information and coherence-based identifiability arguments \cite{ljung1999system,pintelon2012system,enhanced_6_20250812,comprehensive_6_20250812} and by the value-of-information perspective for experimental design \cite{enhanced_2_20250812,comprehensive_2_20250812}.

\paragraph{Performance channels and weights.}
We adopt standard robust control signal shaping on the sensitivity $S=(I+\hat G_r K)^{-1}$, complementary sensitivity $T=\hat G_r K(I+\hat G_r K)^{-1}$, and control channel $U=K S$:
\begin{align}
z_S &= W_S S (r-y_{\rm targ}),\\
z_T &= W_T T d,\\
z_u &= W_u U r,\\
z_P &= W_P\, C_P\, y,
\end{align}
where $r$ is the reference for GMST tracking, $d$ collects exogenous disturbances (e.g., ENSO-like variability, volcanic aerosol forcing), and $C_P$ selects regional hydrological outputs to be constrained. The weights encode climate objectives and operational limits:
(i) $W_S(s)$ specifies the desired closed-loop bandwidth (monthly–interannual) and low steady-state error for GMST tracking; 
(ii) $W_T(s)$ rolls off high-frequency loop gain to avoid amplifying internal variability and unmodeled dynamics; 
(iii) $W_u(s)$ penalizes rapid changes in injection rate (total-variation regularization in frequency domain); 
(iv) $W_P(s)$ penalizes variance in sensitive precipitation bands and can emphasize interannual variability known to be policy-relevant. A separate penalty on SAOD excursions is enforced either by including SAOD in $y$ with a weight $W_{\rm SAOD}(s)$ calibrated from model climatology \cite{tilmes2018stratospheric,richter2022assessingresponses} or by explicit constraints in MPC (below).

\paragraph{H-infinity synthesis and robust guarantees.}
With $w=[r^\top,d^\top]^\top$ and $z=[z_S^\top,z_T^\top,z_u^\top,z_P^\top]^\top$, we synthesize a stabilizing controller $K(s)$ minimizing the worst-case induced norm:
\begin{equation}
\min_{K\ \mathrm{stabilizing}}\ \big\|T_{zw}(s)\big\|_\infty\quad \text{subject to } G(s)\ \text{as in \eqref{eq:mout}}.
\label{eq:hinf}
\end{equation}
For multiplicative output uncertainty \eqref{eq:mout}, robust stability is ensured if
\begin{equation}
\sup_{\omega}\ \bar\sigma\Big(W_\Delta(j\omega)\,T(j\omega)\Big)<1,
\label{eq:rs}
\end{equation}
and robust performance if \eqref{eq:rs} holds jointly with $\|T_{zw}\|_\infty<1$ for the weighted channels \cite[Chap. 9]{pintelon2012system}. We design $W_S,W_T,W_u,W_P$ so that the loop bandwidth lies within the frequency window where $\gamma^2(\omega)$ is high, thereby using only well-identified dynamics for high loop gain \cite{pintelon2012system}. This design pattern is directly enabled by active spectroscopy: the probe both estimates $\hat G$ and quantifies where $W_\Delta$ must be large because information is weak.

In practice, we compute $K(s)$ via standard H-infinity algorithms and verify \eqref{eq:rs} on held-out probe data and single-tone validations. Tuning seeks a margin $\eta\in(0,1)$ such that $\sup_\omega \bar\sigma(W_\Delta T)\le \eta$, creating headroom for model drift across scenarios (e.g., under gradually increasing baseline forcing; cf. Section E4). This approach complements previous closed-loop geoengineering studies \cite{macmartin2014dynamicsof} by explicitly embedding frequency-dependent uncertainty derived from designed experiments.

\paragraph{Constrained MPC for operational limits and scenario anticipation.}
To handle hard constraints (e.g., SAOD bounds, rate limits on $u$, regional precipitation risk thresholds), we employ a receding-horizon MPC built from a discrete surrogate consistent with $\hat G_r(s)$. We fit a stable, low-order state-space predictor at monthly resolution using Koopman-regressed linear predictors or ARX models constrained by the frequency response \cite{ljung1999system,enhanced_10_20250812,enhanced_11_20250812}. Let
\begin{equation}
x_{k+1}=A x_k+B u_k+w_k,\quad y_k=C x_k+v_k,
\end{equation}
with process and measurement covariances estimated from identification residuals. The finite-horizon optimization reads
\begin{align}
\min_{\{u_{k}\}} \ \ &\sum_{i=0}^{N-1} \Big( \|Q_y (y_{k+i}-r_{k+i})\|_2^2 + \|R_{\Delta} \Delta u_{k+i}\|_2^2 \Big)\nonumber\\
&\quad + \lambda_{\rm SAOD} \sum_{i=0}^{N-1} \|W_{\rm SAOD}\,y^{\rm SAOD}_{k+i}\|_2^2 + \lambda_P \sum_{i=0}^{N-1} \|W_P y^{\rm precip}_{k+i}\|_2^2 \label{eq:mpcobj}\\
\text{s.t.}\ \ & x_{k+i+1}=A x_{k+i}+B u_{k+i},\ \ y_{k+i}=C x_{k+i},\nonumber\\
& u_{\min}\le u_{k+i}\le u_{\max},\ \ \|\Delta u_{k+i}\|_\infty\le \delta_{\max},\nonumber\\
& y^{\rm SAOD}_{k+i}\in[\underline{y}_{\rm SAOD},\overline{y}_{\rm SAOD}],\ \ y^{\rm precip}_{k+i}\in\mathcal{Y}_P,\ \ \forall i, \nonumber
\end{align}
where $\Delta u_{k}=u_{k}-u_{k-1}$, and $\mathcal{Y}_P$ encodes regional precipitation constraints. Uncertainty in $(A,B,C)$ is handled via tube MPC or chance constraints calibrated by the posterior parameter covariance (Gaussian approximation) from the spectral regression, consistent with Bayesian uncertainty propagation in climate control settings \cite{enhanced_8_20250812,comprehensive_8_20250812}. Disturbance forecasts can incorporate stochastic ENSO surrogates and exogenous volcanic aerosol scenarios as preview information, allowing explicit stress-testing as in E3.

\paragraph{Integration with early-warning and adaptive control.}
Because the uncertainty weight $W_\Delta$ is tied to the coherence and harmonic distortion estimated online, we can monitor the robust-stability margin $\mu_{\rm rs}=\left(\sup_\omega \bar\sigma(W_\Delta T)\right)^{-1}$ as an early-warning diagnostic: decreasing $\mu_{\rm rs}$ reflects phase-drift and nonlinear growth approaching instability, often earlier than variance/autocorrelation signals \cite{enhanced_5_20250812,comprehensive_5_20250812}. Within MPC, we implement a guardrail that inflates $W_T$ and $W_u$ (reducing loop gain and smoothing control moves) as $\mu_{\rm rs}$ falls below thresholds, yielding an adaptive robust controller that trades performance for safety when the identified dynamics degrade under escalating forcing (E4).

\paragraph{Design guidance and expected benefits.}
Weights $W_S,W_T,W_u,W_P$ are selected by aligning closed-loop bandwidth with the frequency window probed at high SNR (monthly–interannual), penalizing control activity near bands with large $W_\Delta$, and emphasizing hydrologically sensitive bands (e.g., seasonal to interannual) in $W_P$ informed by ARISE-SAI and CESM(WACCM) responses \cite{tilmes2018stratospheric,richter2022assessingresponses}. Fisher-information analysis guides probe design so that the most policy-relevant bands dominate the identified loop gain \cite{enhanced_6_20250812,comprehensive_6_20250812}. Compared to continuous or ad hoc pulsing, this workflow is expected to:
(i) reduce GMST tracking error and constraint violations under internal variability and exogenous shocks via robust loop shaping \cite{macmartin2014dynamicsof,enhanced_4_20250812}; 
(ii) expose and avoid fragile frequency bands where control would amplify variability (large $W_\Delta$) \cite{pintelon2012system}; and 
(iii) deliver actionable uncertainty margins and early-warning diagnostics derived from the same probes used for identification \cite{enhanced_5_20250812}.

\paragraph{Implementation in E3.}
In Experiment E3 we instantiate the above with:
(1) rational fits of $\hat G(j\omega)$ to order-$(4\!-\!8)$ state-space models per output; 
(2) $W_\Delta$ constructed by \eqref{eq:wdelta} using coherence and HDI from E2; 
(3) H-infinity synthesis minimizing $\|T_{zw}\|_\infty$ with target $\eta\le 0.7$ in \eqref{eq:rs}; and 
(4) a constrained MPC operating at monthly cadence with a 24–60 month horizon. Performance is benchmarked against continuous injection and naive square-wave pulsing under ENSO-like variability and a volcanic eruption scenario, reporting tracking RMSE, constraint violations, controller effort (TV norm), worst-case regional anomalies, and regret relative to an oracle with access to the true model, following control evaluation norms \cite{enhanced_4_20250812,comprehensive_4_20250812}. Cross-model transfer of the synthesized controllers (E5) assesses robustness to structural differences across an aquaplanet/EMIC and a CESM-like model \cite{tilmes2018stratospheric,richter2022assessingresponses}, consistent with cross-scale validation best practices \cite{enhanced_7_20250812}.

Overall, active spectroscopy provides precisely the information needed to shape robust controllers where the climate system is both identifiable and controllable, while quantifying where it is not. The resulting H-infinity/MPC designs operationalize pulsed SAI as a feedback instrument with explicit guarantees and alarm mechanisms, extending prior closed-loop geoengineering concepts \cite{macmartin2014dynamicsof} into a frequency-aware, uncertainty-calibrated framework suited to contemporary Earth system models.


% === AREA: Early warning signals for climate tipping points and instability. ===

\subsection{Active early-warning from phase drift and harmonic growth}

A core risk in stratospheric aerosol injection (SAI) is the emergence of undesirable dynamical behavior—oscillation, overshoot, or regime shifts—as the coupled climate–aerosol system is pushed to operate farther from the nominal state \citep{robock200820reasons,macmartin2014dynamicsof}. If SAI were to be managed in closed loop, degraded dynamical margins would directly translate into heightened control risk; even in open loop, longer lags and increasing nonlinear interactions can foreshadow reduced predictability and sharper trade-offs across regions. We therefore develop active early-warning indicators (EWIs) that leverage the same spectroscopy experiments used for system identification. Rather than relying on passive statistics (variance, lag-1 autocorrelation) that integrate over all background variability, we exploit designed, narrowband probes to estimate the frequency-dependent phase lag and harmonic distortion in the response to aerosol perturbations. Both quantities have firm grounding in system identification and frequency-domain analysis \citep{ljung1999system,pintelon2012system} and can be tracked sequentially as the background forcing evolves.

Consider a small-amplitude input sequence \(u_t\) (an information-optimized multi-sine, chirp, or PRBS superimposed on a baseline SAI scenario) and an output \(y_t\) (e.g., global-mean surface temperature, monsoon indices). Over a sliding window indexed by \(t\) and for discrete frequencies \(\omega \in \Omega\), we estimate the best linear approximation (BLA) of the frequency response via spectral regression \citep{pintelon2012system}:
\[
\widehat{G}(\omega,t) \;=\; \frac{\widehat{S}_{yu}(\omega,t)}{\widehat{S}_{uu}(\omega,t)}\,,
\qquad
\widehat{\phi}(\omega,t) \;=\; \arg\!\left[\widehat{G}(\omega,t)\right],
\]
where \(\widehat{S}_{yu}\) and \(\widehat{S}_{uu}\) are (leakage-corrected) cross- and auto-spectral density estimates computed only at the excited lines of the probe. The BLA formalism ensures that, under weak nonlinearity and noise, \(\widehat{G}\) captures the locally linear pathway from SAI to climate variables while nonlinearity manifests as power at unexcited lines and higher harmonics \citep{pintelon2012system}.

We define two complementary EWIs that can be computed online:

1) Phase-drift indicator (PDI). For each \(\omega\in\Omega\) with sufficiently high magnitude-squared coherence \(\gamma^2_{yu}(\omega,t)\), we track the trend in estimated phase,
\[
\Delta\phi(\omega,t) \;=\; \mathrm{WLS\text{-}slope}\!\left(\{\widehat{\phi}(\omega,\tau)\}_{\tau \in \mathcal{W}_t}\right),
\]
where \(\mathcal{W}_t\) is a trailing set of windows and weights are proportional to \(\gamma^2_{yu}(\omega,\tau)\) to reflect estimator confidence \citep{pintelon2012system}. Intuitively, drift of \(\widehat{\phi}\) toward \(-\pi\) at timescales of interest indicates lengthening effective delays relative to the forcing period, which increases susceptibility to overshoot and oscillatory behavior under any regulation that seeks to track targets \citep{macmartin2014dynamicsof}. We summarize across bands by
\[
\mathrm{PDI}(t) \;=\; \sum_{\omega \in \Omega} w_\omega \,\Delta\phi(\omega,t),
\]
with nonnegative weights \(w_\omega\) emphasizing seasonal to interannual bands relevant for SAI decision-making.

2) Harmonic-distortion indicator (HDI). Using periodic multisines with deliberately unexcited detection lines \citep{pintelon2012system}, we quantify nonlinear growth as
\[
\mathrm{HDI}(t) \;=\; \frac{\sum_{\nu \in \mathcal{H}}\widehat{S}_{yy}(\nu,t)}{\sum_{\omega \in \Omega}\widehat{S}_{yy}(\omega,t)}\,,
\]
where \(\mathcal{H}\) collects harmonic and intermodulation lines not directly excited by the probe. Growth in HDI indicates increasing contribution of nonlinear pathways (e.g., amplitude-dependent aerosol–radiation–circulation couplings), complementary to the phase-based signal in the BLA. When second-order Volterra kernels are estimated as in our nonlinear characterization (Sec. E2), their norm or specific cross-frequency couplings provide an additional, structurally interpretable nonlinear EWI consistent with the spectral HDI \citep{ljung1999system}.

Sequential detection. We formulate a composite early-warning index
\[
\mathcal{E}(t) \;=\; \alpha\,\mathrm{PDI}(t) \;+\; \beta\,\Delta\log\!\left[\mathrm{HDI}(t)\right],
\]
with \(\alpha,\beta\ge 0\) chosen to maximize sensitivity under a false-alarm constraint using historical or control-run surrogates. Under standard asymptotics for frequency-response estimators, \(\widehat{\phi}(\omega,t)\) and \(\log\mathrm{HDI}(t)\) are approximately Gaussian with variances governed by the probe spectrum and coherence \citep{ljung1999system,pintelon2012system}, enabling a sequential generalized likelihood ratio or CUSUM test on \(\mathcal{E}(t)\). We define detection lead time as the interval between first alarm and the onset of a predefined adverse event (e.g., violation of a regional precipitation constraint under a ramped-baseline experiment), and we quantify skill via ROC/AUC against passive baselines computed from the same simulations.

Probe and estimator design. Because early-warning sensitivity depends on estimator variance, we co-design the probe spectrum to maximize Fisher information for the phase and harmonic statistics under amplitude and environmental constraints \citep{ljung1999system}. Practically, we (i) allocate more power to frequencies with high coherence and high anticipated drift sensitivity, (ii) randomize phases to reduce crest factor while preserving detection lines for HDI, and (iii) choose window lengths to balance tracking of slow drift against spectral resolution. Embedding these probes within established SAI protocols (e.g., GeoMIP-style scenarios and ARISE-SAI setups) leverages familiar model infrastructure and allows controlled comparisons across models and ensembles \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Given the ethical and governance concerns surrounding SAI \citep{robock200820reasons,keith2010researchon}, active EWIs are deliberately designed to be minimally invasive: amplitudes in the 0.05–0.5 TgS yr\(^{-1}\) RMS range superimposed on a steady baseline are sufficient to achieve high signal-to-noise in typical Earth system models while remaining far below perturbations used in scenario studies.

Evaluation protocol (E4). We implement a gradual increase in baseline SAI forcing and compute \(\mathrm{PDI}(t)\), \(\mathrm{HDI}(t)\), and \(\mathcal{E}(t)\) in sliding windows. Detection performance is benchmarked against passive variance and lag-1 autocorrelation computed on the same outputs and windows. Metrics include (i) detection lead time relative to the first control-relevant constraint violation in our robust-control experiments, (ii) AUC and false-alarm rate, and (iii) cross-model consistency when repeating the analysis in an idealized model and a chemistry-enabled ESM (Sec. E5). We hypothesize that phase drift toward \(-\pi\) in seasonal–interannual bands and rising HDI will provide earlier and more specific warnings than passive metrics because they focus on the identified dynamical pathways from SAI to climate variables rather than integrating over all sources of variability. This is a direct consequence of frequency-domain identifiability and the use of designed inputs that maximize information where it matters for control \citep{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.

Finally, we emphasize that these EWIs are not only diagnostic but also actionable: they can be ingested by the controller synthesis stage to adapt gains, tighten constraints, or slow escalation when dynamical margins degrade (Sec. E3), thereby operationalizing risk-aware SAI management within existing modeling infrastructures \citep{tilmes2018stratospheric,richter2022assessingresponses}.


% === AREA: Fisher information maximization for experimental design in complex systems. ===

\subsection{Information-optimal probe design via Fisher information}

We formalize the design of small-amplitude, pulsed SAI probes as an optimal experimental design (OED) problem that maximizes the information gained about the climate system’s frequency response and low-order nonlinearities subject to safety and feasibility constraints. In our setting, a baseline, steady SAI rate $\bar{u}$ is perturbed by a zero-mean, bounded probe $\delta u(t)$ composed of multi-sines, PRBS, and chirps. We assume that, over the time scales of the experiment and around $\bar{u}$, the input–output map from injection rate to a vector of outputs $y(t)\in\mathbb{R}^m$ (e.g., GMST, regional precipitation indices, circulation metrics) can be approximated as a weakly nonlinear, quasi-stationary system,
\[
y(t) \;=\; G(q^{-1};\theta)\,\delta u(t) \;+\; \big(\mathcal{V}_2[h_2]\delta u\big)(t) \;+\; v(t),
\]
where $G(q^{-1};\theta)$ is a linear time-invariant operator parameterized by $\theta$ (frequency response surrogate), $\mathcal{V}_2[h_2]$ is a second-order Volterra operator with kernel $h_2$ capturing harmonic generation and intermodulation, and $v(t)$ is colored internal variability with cross-spectral density $S_{vv}(\omega)$. This local representation follows standard identification practice in which nonlinearities are handled as linear-in-parameters expansions around a working point and the disturbance is modeled as stationary noise with known or estimable spectrum (Ljung, 1999; Pintelon and Schoukens, 2012).

We treat $\theta$ (and optionally a vectorized representation of $h_2$) as the parameters of interest and seek a probe spectrum that maximizes the Fisher information about these parameters. For a random-phase multisine,
\[
\delta u(t) \;=\; \sum_{k\in\mathcal{K}} a_k \cos(\omega_k t+\varphi_k), \quad \omega_k = \tfrac{2\pi k}{T}, \;\;\varphi_k \sim \mathrm{Unif}(0,2\pi),
\]
with experiment length $T$ and active lines $\mathcal{K}$, the (approximate) Fisher information matrix (FIM) for $\theta$ under Gaussian $v(t)$ and independent line spectra is (Pintelon and Schoukens, 2012)
\begin{equation}
\mathcal{I}_\theta(a) \;\approx\; 2T \sum_{k\in\mathcal{K}} \Gamma(\omega_k)^\top \, W(\omega_k) \, \Gamma(\omega_k)\; |U(\omega_k)|^2,
\label{eq:fim_linear}
\end{equation}
where $U(\omega_k)=\tfrac{1}{2}a_k e^{i\varphi_k}$, $\Gamma(\omega)=\partial G(\omega;\theta)/\partial \theta \in \mathbb{C}^{m\times p}$ is the Jacobian of the MIMO frequency response with respect to $\theta$, and $W(\omega)=S_{vv}(\omega)^{-1}$ is a disturbance-weighting matrix. For linear-in-parameters second-order terms (e.g., sparse expansions of $h_2$ over predefined lag/frequency tiles), an additive contribution to the FIM arises at sum/difference frequencies $\omega_{r}\pm\omega_{s}$, with design degrees of freedom $\{a_r,\varphi_r\}$ shaping the information content at harmonic lines. Random-phase multisines make these contributions approximately block-diagonal across frequency and order, enabling convex surrogates of D-, A-, or E-optimality (Pintelon and Schoukens, 2012; enhanced_12_20250812).

We pose the input design as a constrained optimization:
\begin{align}
\max_{\{a_k,\varphi_k\}} \;\;& J\big(\mathcal{I}_\Theta(a)\big) \,-\, \lambda_\mathrm{CF}\, \mathrm{CF}(\{a_k,\varphi_k\}) \,-\, \lambda_\mathrm{SAOD}\, \mathrm{Var}[\mathrm{SAOD}]  \label{eq:design_obj}\\
\mathrm{s.t.}\;\;& \sum_{k\in\mathcal{K}} \tfrac{1}{2} a_k^2 \leq A_\mathrm{RMS}^2,\;\; 0.02 \le \tfrac{\omega_k}{2\pi}\le 2\;\mathrm{yr}^{-1}, \nonumber\\
& \bar{u} + \delta u(t) \in \mathcal{U}_\mathrm{safe},\;\; \mathrm{max}\,|\delta u(t)| \le A_\mathrm{peak}, \nonumber
\end{align}
where $J$ is an information criterion over the joint parameter vector $\Theta=[\theta^\top, \mathrm{vec}(h_2)^\top]^\top$ (e.g., $J=\log\det$ for D-optimality or $\mathrm{trace}$ for A-optimality), $\mathrm{CF}$ penalizes large crest factors to avoid transient over-injection, $\mathcal{U}_\mathrm{safe}$ encodes operational and environmental constraints (including chemical and radiative bounds reflected via SAOD variance), and $(A_\mathrm{RMS},A_\mathrm{peak})$ enforce probe smallness (0.05–0.5 TgS yr$^{-1}$ RMS in E1). The frequency window matches the monthly-to-interannual band where both policy-relevant control and internal variability are significant. Safety-oriented small amplitudes and bounded peak excursions reflect the broader risk concerns around SAI experimentation (Robock et al., 2008; Keith et al., 2010) while remaining feasible within established modeling protocols (Kravitz et al., 2011; Tilmes et al., 2018; Richter et al., 2022).

Equation \eqref{eq:fim_linear} reveals a water-filling intuition: for a fixed experiment length $T$ and disturbance spectrum $S_{vv}(\omega)$, the marginal information at $\omega_k$ scales with $|U(\omega_k)|^2$ and the sensitivity metric $\Gamma(\omega_k)^\top W(\omega_k)\Gamma(\omega_k)$. Thus, optimal amplitude allocation emphasizes frequencies with (i) high gain sensitivity in outputs most relevant for control, and (ii) favorable signal-to-noise ratio under internal variability. When outputs are prioritized (e.g., tighter weights on regional hydrology), $W(\omega)$ can be chosen to reflect those priorities, aligning information acquisition with downstream controller design (MacMartin et al., 2014). PRBS inputs approximate a spectrally flat $|U(\omega)|^2$ up to a design bandwidth, offering practical near-optimality when $S_{vv}(\omega)$ is poorly known; chirps are useful for fast screening of resonant bands but require leakage-robust regression to avoid bias from transient windowing (Pintelon and Schoukens, 2012; enhanced_9_20250812).

Because $S_{vv}(\omega)$ and $\Gamma(\omega)$ are uncertain a priori, we adopt robust and adaptive OED. First, we estimate $S_{vv}(\omega)$ from control or historical ensembles (Tilmes et al., 2018; Richter et al., 2022) and place priors over plausible surrogate models $G(\omega;\theta)$ (enhanced_2_20250812; enhanced_8_20250812). We then maximize the expected information or its worst-case lower bound,
\[
\max_{\{a_k,\varphi_k\}} \;\; \mathbb{E}_{S_{vv},\theta}\big[J(\mathcal{I}_\Theta(a;S_{vv},\theta))\big] 
\quad\text{or}\quad 
\max_{\{a_k,\varphi_k\}} \;\; \min_{(S_{vv},\theta)\in\mathcal{P}} J(\mathcal{I}_\Theta(a;S_{vv},\theta)),
\]
where $\mathcal{P}$ encodes admissible spectral and model uncertainties (enhanced_6_20250812). Second, we iterate design–learn cycles: run a short probe, update posteriors over $(\theta,h_2)$ by spectral regression with leakage correction, recompute the FIM with updated $\Gamma(\omega)$, and redesign the next probe to target remaining high-uncertainty bands (Ljung, 1999; Pintelon and Schoukens, 2012; enhanced_6_20250812). This active-learning loop is well-suited to high-dimensional, weakly chaotic systems where experimental time and ensemble budgets dominate the cost function.

Practical guidance emerges from the FIM scaling. For a single output and one excited line,
\[
\mathrm{Var}\{\widehat{G}(\omega_k)\} \;\propto\; \frac{S_{vv}(\omega_k)}{T\,|U(\omega_k)|^2\,N_\mathrm{ens}},
\]
so identification error decreases with experiment length, squared amplitude, and ensemble size $N_\mathrm{ens}$ (Pintelon and Schoukens, 2012). This scaling supports E6: for target confidence on Bode gain/phase, one can trade amplitude against duration and ensemble size, constrained by safety bounds on $\delta u$. In our experiments, we use integer-period lines to minimize leakage, random-phase multisines to decorrelate nonlinear contributions, and phase-optimized designs to reduce crest factor while preserving the line spectrum (Pintelon and Schoukens, 2012).

Nonlinear identification is embedded in the same framework. We construct a sparse second-order feature set in frequency–frequency tiles capturing sum/difference interactions; the corresponding FIM adds blocks at $\omega_r\pm\omega_s$, whose entries depend on products $a_r a_s$ and phase combinations $\varphi_r\pm\varphi_s$. By reserving disjoint line sets for fundamental and intermodulation bands (Schoukens-style odd–even scheduling), we isolate nonlinear signatures and avoid spectral collisions, enabling efficient recovery of dominant Volterra terms with sparsity promotion (enhanced_12_20250812; enhanced_3_20250812). The resulting information-optimal designs explicitly balance linear (tracking-relevant) versus nonlinear (early-warning-relevant) objectives by choosing $J$ and frequency partitions.

Finally, the information-theoretic view connects directly to our control and early-warning goals. Maximizing $J(\mathcal{I}_\Theta)$ reduces posterior uncertainty in the surrogate used by H-infinity and MPC controllers, improving robustness margins and reducing regret relative to an oracle with perfect system knowledge (MacMartin et al., 2014; enhanced_4_20250812). Moreover, the FIM can be shaped to emphasize phase-sensitive bands where approaching instabilities manifest as phase drift toward $-\pi$ and growth of harmonic distortion, thereby increasing the lead time of active early-warning indicators relative to passive variance/autocorrelation metrics (enhanced_5_20250812). In sum, Fisher-information–guided probes turn pulsing into deliberate spectroscopy: a principled allocation of scarce experimental degrees of freedom that maximizes the value of information for climate intervention design while respecting safety and feasibility constraints (Ljung, 1999; Pintelon and Schoukens, 2012; enhanced_2_20250812; Tilmes et al., 2018; Richter et al., 2022).

\paragraph{Implementation in E1–E6.}
We instantiate \eqref{eq:design_obj} as follows. E1 estimates $S_{vv}(\omega)$ and initializes $\Gamma(\omega)$ from short pilot probes, then solves a D-optimal multisine design with RMS bounds $(0.05$–$0.5)\,$TgS yr$^{-1}$ over $0.02$–$2\,$yr$^{-1}$. E2 reserves distinct line sets for fundamental and intermodulation bands to identify second-order kernels. E3 propagates the posterior covariance from $\mathcal{I}_\Theta^{-1}$ into controller synthesis via chance constraints and H-infinity weighting. E4 biases the design toward phase-critical bands to enhance sensitivity of phase-drift and harmonic-distortion indicators. E5 repeats the OED across model tiers, and E6 quantifies the amplitude–duration–ensemble trade space using the FIM scaling laws to determine minimal designs achieving target prediction error.


% === AREA: Cross-model validation techniques for climate models and surrogate models. ===

\subsection{Cross-model validation and transferability of identified dynamics and controllers}

A central requirement for actionable active spectroscopy of stratospheric aerosol injection (SAI) is that identified dynamics and synthesized controllers remain valid across model structures, resolutions, and parameterizations. Intercomparison studies have repeatedly demonstrated substantial spread in SAI response pathways across Earth system models (ESMs) and configurations \cite{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}, underscoring the need for cross-model validation routines that evaluate both the fidelity of frequency-domain surrogates and the robustness of control designs. Here we formalize a protocol for tiered cross-model validation and transfer, aligned with our experimental sequence (E1–E5), and grounded in frequency-domain system identification \cite{ljung1999system, pintelon2012system}.

\paragraph{Protocol overview}
We standardize active probes and evaluation metrics across an idealized/aquaplanet or EMIC tier and a chemistry-coupled ESM tier (e.g., CESM/WACCM-like) \cite{tilmes2018stratospheric, richter2022assessingresponses}. To ensure comparability, we prescribe identical multi-sine/PRBS/chirp inputs in time and in spectral allocation, and we normalize actuation by targeting stratospheric aerosol optical depth (SAOD) rather than raw sulfur injection rate, given documented model-to-model differences in the mapping from injection to SAOD and radiative forcing \cite{tilmes2018stratospheric}. For each model $m \in \mathcal{M}$ we estimate:
(i) the linear frequency response $\hat H_m(\omega)$ from SAI actuation $u$ to climate outputs $y$ via spectral regression with leakage correction \cite{pintelon2012system};
(ii) second-order generalized frequency response functions (GFRFs) $\hat G_m(\omega_1,\omega_2)$ to capture harmonic and intermodulation terms; and
(iii) Koopman-regressed linear predictors for control design. We then quantify cross-model dynamic discrepancy, transfer generalization error, and robust control margins.

\paragraph{Linear and nonlinear discrepancy metrics}
Let $\hat S^{(m)}_{yu}(\omega)$ and $\hat S^{(m)}_{uu}(\omega)$ denote cross- and auto-spectra under the designed probes in model $m$. The linear frequency response is
\begin{equation}
\hat H_m(\omega) \;=\; \hat S^{(m)}_{yu}(\omega)\,\big(\hat S^{(m)}_{uu}(\omega)\big)^{-1},
\label{eq:Hdef}
\end{equation}
estimated with multi-tapering and ridge stabilization at low SNR \cite{pintelon2012system}. We define a pairwise, output-weighted discrepancy between models $m$ and $n$:
\begin{equation}
D_{\mathrm{lin}}(m,n) \;=\; \int_{\Omega} w(\omega)\,\big\| W_{\mathrm{out}}(\omega)\big(\hat H_m(\omega)-\hat H_n(\omega)\big)W_{\mathrm{in}}(\omega)\big\|_F^2\,\mathrm{d}\omega,
\label{eq:Dlin}
\end{equation}
where $W_{\mathrm{in}}$ and $W_{\mathrm{out}}$ weight actuation and outputs by policy relevance (e.g., emphasize interannual bands for GMST, seasonal bands for monsoon indices), and $w(\omega)$ emphasizes frequencies excited by the probes and with coherence above a threshold $\gamma^2(\omega)$ \cite{pintelon2012system}. For nonlinear distortions, we analogously measure the GFRF discrepancy
\begin{equation}
D_{\mathrm{nl}}(m,n) \;=\; \iint_{\Omega\times\Omega} w_2(\omega_1,\omega_2)\,\big\|\hat G_m(\omega_1,\omega_2)-\hat G_n(\omega_1,\omega_2)\big\|_F^2\,\mathrm{d}\omega_1\,\mathrm{d}\omega_2,
\label{eq:Dnl}
\end{equation}
with $w_2$ focusing on sum/difference-frequency ridges targeted by the multisines. Together, $D_{\mathrm{lin}}$ and $D_{\mathrm{nl}}$ provide a frequency-resolved map of inter-model spread under a standardized excitation protocol, complementing aggregate intercomparison metrics used in GeoMIP/ARISE-SAI \cite{kravitz2011thegeoengineering, richter2022assessingresponses}.

\paragraph{Cross-model generalization and transfer tests}
We quantify the transferability of identified surrogates by forecasting responses in a target model $n$ using a surrogate trained in source model $m$ under a held-out validation input $u_{\mathrm{val}}(t)$ (e.g., single-tone sweeps):
\begin{equation}
E_{m\rightarrow n} \;=\; \frac{\sum_{t}\big\| y^{(n)}(t) - \hat y^{(m)}(t;u_{\mathrm{val}})\big\|_2^2}{\sum_{t}\big\| y^{(n)}(t) - \bar y^{(n)}\big\|_2^2},
\label{eq:transfer}
\end{equation}
reported by output and by frequency band. Low $E_{m\rightarrow n}$ at low frequencies is anticipated from energy-balance constraints common to many models \cite{macmartin2014dynamicsof}, while divergences at higher frequencies or in specific regions (e.g., monsoon indices) flag structural sensitivity consistent with prior intercomparisons \cite{kravitz2011thegeoengineering, tilmes2018stratospheric}. When combining surrogates or propagating uncertainty to control design, we adopt a hierarchical Bayesian view in which model-specific parameter posteriors are pooled to form an uncertainty envelope \cite{enhanced_8_20250812}, with regularization informed by information-theoretic diagnostics of ensemble information content \cite{enhanced_2_20250812}.

\paragraph{Robust experiment design across models}
To avoid overfitting probes to any single model, we choose inputs that maximize worst-case identifiability across $\mathcal{M}$. Let $F_m(u)$ denote the Fisher information matrix for a parametric surrogate fitted in model $m$ under input $u$ \cite{ljung1999system}. We solve
\begin{equation}
u^\star \in \arg\max_{u\in\mathcal{U}} \;\min_{m\in\mathcal{M}} \;\lambda_{\min}\big(F_m(u)\big)
\quad \text{s.t.} \;\;\text{SAOD},\;\text{variance},\;\text{ozone constraints},
\label{eq:robust-fim}
\end{equation}
using spectral power allocation across the probe band and phase optimization \cite{pintelon2012system, enhanced_6_20250812}. This ensures that key features of $\hat H_m$ and $\hat G_m$ are simultaneously well-excited in all models while respecting environmental constraints documented in ARISE-SAI \cite{richter2022assessingresponses}.

\paragraph{Envelope models and robust control transfer}
Given identified $\{\hat H_m,\hat G_m\}_{m\in\mathcal{M}}$, we build an uncertainty envelope $\mathcal{G}(\omega)$ for the linear dynamics,
\begin{equation}
\mathcal{G}(\omega) \;=\; \text{conv}\big(\{\hat H_m(\omega)\}_{m\in\mathcal{M}}\big)\;\oplus\;\Delta(\omega),
\label{eq:envelope}
\end{equation}
where $\Delta(\omega)$ is a frequency-dependent ball sized by $D_{\mathrm{lin}}$ and finite-sample variance. Controllers $K$ are synthesized to achieve robust stability and performance for all $G\in\mathcal{G}$ using $H_\infty$ or tube MPC formulations \cite{macmartin2014dynamicsof}, minimizing $\|T_{zw}(K,G)\|_\infty$ subject to constraints on regional precipitation variance and SAOD excursions. We report robust stability margins and worst-case regret relative to an oracle with the true model, as in E3. Where appropriate, deep-learning emulators serve as fast surrogates for cross-model Monte Carlo validation provided they are trained and vetted under the same probes \cite{enhanced_11_20250812}.

\paragraph{Early-warning indicators under model spread}
Phase-lag drift toward $-\pi$ and growth in harmonic distortion index (HDI) under increased baseline forcing (E4) are computed per model and pooled via meta-analysis to assess cross-model early-warning skill relative to passive variance/autocorrelation baselines \cite{enhanced_5_20250812}. Frequency-local concordance of these indicators across models strengthens their interpretability; discordance highlights model-dependent failure modes that warrant cautious governance.

\paragraph{Implementation details and links to existing protocols}
To harmonize baselines, we (i) normalize actuation by SAOD targets; (ii) detrend outputs by removing low-order polynomials or control-free baselines; (iii) use multitaper spectral estimators and cross-validation to set regularization \cite{pintelon2012system}; and (iv) align seasons and calendars across models following intercomparison best practices \cite{kravitz2011thegeoengineering, richter2022assessingresponses}. Our cross-model validation thus extends established intercomparison protocols into the frequency domain with active, information-optimized excitation, enabling systematic assessment of transferability and robust control design within a common experimental scaffold.

\paragraph{Evaluation metrics}
We will report:
(i) $D_{\mathrm{lin}}$ and $D_{\mathrm{nl}}$ by band and output;
(ii) cross-model generalization $E_{m\rightarrow n}$ (Eq.~\ref{eq:transfer});
(iii) robust stability/performance margins for $H_\infty$/MPC across $\mathcal{G}$;
(iv) early-warning lead time and AUC pooled across models; and
(v) the gain in Fisher information from robust probe design (Eq.~\ref{eq:robust-fim}). These metrics quantify where frequency-domain surrogates and controllers are transferable, where safeguards are needed, and how much information active probes add beyond passive baselines \cite{ljung1999system, pintelon2012system, macmartin2014dynamicsof}.


% === AREA: Uncertainty quantification methods in climate modeling and control. ===

\subsection{Uncertainty quantification for active spectroscopy and robust SAI control}

Credible inferences from active spectroscopy require uncertainty quantification (UQ) that propagates through identification, emulation, and control. We formalize three coupled layers of uncertainty: (i) stochastic internal variability and observational noise that limit spectral estimators; (ii) parametric and nonlinear modeling error in the identified surrogate (frequency response and Volterra kernels); and (iii) structural discrepancies across Earth system models (ESMs) and scenarios. Our UQ design follows established system identification practice in the frequency domain \citep{ljung1999system,pintelon2012system}, leverages existing SAI ensemble protocols for structural uncertainty \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, and supports closed-loop SAI control under uncertainty \citep{macmartin2014dynamicsof}.

We model the response from SAI injection rate $u_k$ to climate outputs $y_k$ at monthly resolution via a frequency-domain surrogate comprising a linear time-invariant (LTI) component $G$ and a second-order Volterra correction:
\begin{equation}
y_k \;=\; G(q^{-1};\theta)\,u_k \;+\; y^{(2)}_k(\theta_2) \;+\; e_k,
\quad
y(\omega) \;=\; G(\omega;\theta)\,U(\omega) \;+\; \!\!\sum_{\omega_1+\omega_2=\omega}\!\! H_2(\omega_1,\omega_2;\theta_2)\,U(\omega_1)U(\omega_2) \;+\; E(\omega),
\label{eq:model}
\end{equation}
where $e_k$ captures colored internal variability and model noise. The linear frequency response $G(\omega)$ yields Bode gain/phase; $H_2$ captures harmonic and intermodulation distortion induced by nonlinearities. Identification proceeds by spectral regression on designed multi-sine/PRBS/chirp inputs with leakage corrections \citep{pintelon2012system}. At each excited frequency, signal-to-noise is summarized by the coherence
\begin{equation}
\gamma^2(\omega) \;=\; \frac{|S_{yu}(\omega)|^2}{S_{yy}(\omega)\,S_{uu}(\omega)} \in [0,1],
\end{equation}
which bounds estimator variance and thus the Fisher information (FI) density \citep{pintelon2012system}. With $S_{ee}(\omega)$ the spectrum of internal variability, the FI for a parametric $G(\omega;\theta)$ under input spectrum $\Phi_u(\omega)$ admits the standard asymptotic form
\begin{equation}
\mathcal{I}(\theta;\Phi_u) \;\approx\; \frac{T}{2\pi}\int_{\Omega}
\left(\frac{\partial G(\omega;\theta)}{\partial \theta}\right)^{\!\!H}
S_{ee}^{-1}(\omega)\,
\left(\frac{\partial G(\omega;\theta)}{\partial \theta}\right)\,
\Phi_u(\omega)\, d\omega,
\label{eq:fim}
\end{equation}
with analogous expressions for a sparse second-order Volterra parameterization of $H_2$ \citep{ljung1999system}. This representation makes explicit how experiment length $T$, input power allocation $\Phi_u$, and background variability $S_{ee}$ determine estimability.

Information-optimal probe design. Given operational and environmental constraints (e.g., amplitude bounds, stratospheric aerosol optical depth limits), we choose the multi-sine/PRBS/chirp spectrum to maximize information while respecting safety envelopes:
\begin{align}
\max_{\Phi_u(\omega)\ge0,\,\phi}\quad & \log\det \mathcal{I}(\theta;\Phi_u) \\
\text{s.t.}\quad 
& \int_{\Omega} \Phi_u(\omega)\,d\omega \le P_{\max},\qquad |u_k|\le u_{\max}, \qquad \text{ozone/SAOD constraints}, \nonumber
\end{align}
where phases $\phi$ are optimized to minimize crest factor and nonlinear bias \citep{pintelon2012system}. This optimal input design problem, classical in system identification \citep{ljung1999system}, directly underpins our E1/E6 analyses of amplitude-duration trade-offs and identifiability. The same framework extends to multi-output designs by weighting outputs according to policy relevance (e.g., stronger weights on hydrological indices), and by excluding frequency bands dominated by internal variability (low $\gamma^2$).

Posterior inference for identified surrogates. We estimate $(\theta,\theta_2)$ via weighted frequency-domain least squares with regularization for sparse Volterra terms; under standard conditions the estimator is asymptotically normal with covariance $\Sigma_\theta \approx \mathcal{I}^{-1}(\theta;\Phi_u)$ \citep{pintelon2012system,ljung1999system}. To account for colored noise and finite-sample leakage, we use segment averaging and block bootstrap over time to quantify uncertainty bands on $G(\omega)$ and $H_2$ and to validate single-tone predictions in E2. Confidence envelopes on Bode gain/phase and harmonic distortion indices propagate to performance metrics (tracking RMSE, constraint violation rates) via Monte Carlo.

Structural uncertainty across models and scenarios. Multi-model ensembles (GeoMIP, ARISE-SAI) and large single-model ensembles provide essential constraints on structural spread and internal variability under SAI \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. We adopt a hierarchical scheme in which each model $m$ yields a posterior $p(\theta_m\mid D_m)$ from its active spectroscopy runs, while hyperparameters $(\mu,\Sigma)$ pool across models:
\begin{equation}
\theta_m \sim \mathcal{N}(\mu,\Sigma),\qquad p(\mu,\Sigma\mid \{D_m\}) \propto p(\mu,\Sigma)\prod_m \int p(D_m\mid \theta_m)\,p(\theta_m\mid \mu,\Sigma)\, d\theta_m.
\end{equation}
This furnishes a posterior over a cross-model uncertainty set
\begin{equation}
\Theta_\beta \;=\; \left\{\theta:\; (\theta-\hat{\mu})^\top \hat{\Sigma}^{-1}(\theta-\hat{\mu}) \le \chi^2_{p,\beta}\right\},
\end{equation}
which we use in robust control synthesis and cross-model transfer tests (E5).

From identification to robust control. Closed-loop SAI inevitably faces model error and disturbances (e.g., ENSO, volcanic eruptions) \citep{macmartin2014dynamicsof}. We embed the identified dynamics in two complementary robust designs:
(i) H-infinity control with frequency-shaped performance weights to reflect regional precipitation priorities. With disturbance $d$ and performance output $z$, we solve
\begin{equation}
\min_{K}\;\gamma \quad \text{s.t.}\quad \|T_{zd}(K,\theta)\|_\infty \le \gamma \quad \forall\, \theta\in \Theta_\beta,
\end{equation}
ensuring worst-case bounds across the posterior set; and
(ii) scenario-based MPC with chance-constrained hydrological limits,
\begin{equation}
\min_{u_{0:H-1}}\; \mathbb{E}_{\theta,w}\!\left[\sum_{t=0}^{H-1} \ell(y_t(\theta),u_t)\right]
\quad \text{s.t.}\quad \mathbb{P}_{\theta,w}\big(c^\top y_t \le b\big) \ge 1-\alpha,\; \forall t,
\end{equation}
using tube tightening based on $(\hat{\theta},\Sigma_\theta)$ and ensemble draws from $\{\theta_m\}$ to capture structural spread. These designs connect the identification covariance to controller robustness margins (E3), addressing governance-motivated concerns about overconfidence in model-based SAI \citep{robock200820reasons} while preserving the advantages of feedback emphasized by \citet{macmartin2014dynamicsof}.

Uncertainty-aware early warning. Our hypothesis tests for phase-drift and harmonic-growth indicators (E4) are cast as sequential inference on $G(\omega)$ and $H_2$ under gradually changing baselines. For each band $\omega\in\Omega^\star$, we estimate time-local posteriors for phase $\phi(\omega;t)$ and harmonic distortion index $\mathrm{HDI}(\omega;t)$ using sliding-window spectral regression; change detection employs a generalized likelihood ratio with uncertainty-adaptive thresholds derived from $\Sigma_\theta$. This provides probabilistic lead-time estimates that can be compared against passive variance/autocorrelation benchmarks with controlled false-alarm rates.

Practicality bounds and experiment design. The FI scaling in \eqref{eq:fim} implies $\mathcal{I}\propto A^2 T$ for excitation amplitude $A$ at fixed noise spectrum, with diminishing returns in bands of low coherence. We therefore characterize the minimal $(A,T,\text{ensemble size})$ achieving target accuracy on $G(\omega)$ and controller performance metrics (E6), balancing identifiability against environmental constraints documented in SAI protocols \citep{tilmes2018stratospheric,richter2022assessingresponses} and broader risk considerations \citep{robock200820reasons,keith2010researchon}. In practice, amplitude and phase scheduling across monthly–interannual bands is chosen to maximize $\log\det \mathcal{I}$ subject to SAOD and ozone constraints, then iteratively adapted as posteriors sharpen (active learning).

In sum, integrating frequency-domain identification UQ \citep{ljung1999system,pintelon2012system} with ensemble-based structural uncertainty \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} enables principled, information-efficient spectroscopy and robust SAI control. The resulting posterior sets and uncertainty-aware controllers translate directly into quantitative governance metrics—confidence bands on Bode gains/phases, probability of constraint violations, and robust stability margins—that we evaluate throughout E1–E6.


% === AREA: Spectral regression techniques for climate data analysis and system identification. ===

\subsection{Spectral regression for active identification of SAI-to-climate dynamics}

We estimate frequency-dependent gains and lags from stratospheric aerosol injection (SAI) rate perturbations to climate responses using spectral regression, a frequency-domain system identification methodology well suited for designed multisine/PRBS/chirp inputs and colored geophysical variability. Frequency-domain estimators deliver direct estimates of the complex frequency response (FRF) with controllable bias/variance via input-design and leakage control, and are standard in engineering system identification \cite{pintelon2012system,ljung1999system}. In climate applications, spectral regression has been shown to extract sensitivity and lag structure efficiently from relatively short simulations \cite{enhanced_9_20250812}, which is critical given computational costs in CESM/WACCM and ARISE-SAI-style experiments \cite{tilmes2018stratospheric,richter2022assessingresponses}.

We consider small-amplitude SAI anomalies, $u_t$, superimposed on a baseline injection scenario and outputs $y_t \in \mathbb{R}^p$ (e.g., GMST, regional precipitation indices, circulation metrics). Around a quasi-stationary operating point, we adopt the standard linear stochastic setting
\begin{equation}
y_t = G(q) u_t + v_t,\quad v_t = H(q)\,e_t,
\label{eq:lti}
\end{equation}
where $G(q)$ is the (possibly MIMO) transfer operator from SAI to the outputs, $H(q)$ shapes colored internal variability $e_t$. Identification proceeds on finite windows where $G$ and $H$ can be treated time-invariant (E1–E2), with explicit tests for nonlinearity and slow drift.

\paragraph{Coherent multisine/PRBS design and Fisher information}
Let $u_t$ be a coherent random-phase multisine supported on a user-chosen set of DFT lines $\Omega=\{\omega_k\}$ within monthly-to-interannual bands, with optional PRBS segments to decorrelate from seasonal harmonics. Writing $U(\omega_k)$ for the DFT, the Fisher information for a parametric frequency response $G(\omega;\theta)$ under Gaussian variability satisfies, for independent segments $r=1,\dots,R$,
\begin{equation}
\mathcal{I}(\theta) \approx \sum_{\omega_k \in \Omega} \left(\sum_{r=1}^R \frac{|U_r(\omega_k)|^2}{S_{vv}(\omega_k)}\right) \, \Psi(\omega_k;\theta)^\ast \Psi(\omega_k;\theta),
\label{eq:fim}
\end{equation}
where $\Psi=\partial G(\omega;\theta)/\partial \theta$ and $S_{vv}$ is the output noise PSD shaped by $H$ \cite{ljung1999system,pintelon2012system}. We choose amplitudes/phases $\{U(\omega_k)\}$ by maximizing a D-optimal criterion (e.g., $\log\det \mathcal{I}$) subject to environmental and operational constraints (total SAOD excursion, ozone proxies, crest factor), allocating power to frequencies with high sensitivity and low $S_{vv}$ \cite{enhanced_6_20250812,enhanced_2_20250812}. Coherent sampling on the DFT grid (integer number of periods) suppresses leakage; random phases reduce crest factor and decorrelate spectral lines \cite{pintelon2012system}.

\paragraph{Spectral regression estimators and leakage control}
Divide the record into $R$ independent segments (or ensemble members), compute DFTs $(U_r,Y_{j,r})$ for each output $j$, and form cross-/auto-spectral estimates
\begin{equation}
\hat{S}_{y_j u}(\omega_k) = \frac{1}{R}\sum_{r=1}^R Y_{j,r}(\omega_k)\,U_r(\omega_k)^\ast,\quad
\hat{S}_{uu}(\omega_k) = \frac{1}{R}\sum_{r=1}^R |U_r(\omega_k)|^2.
\end{equation}
For exogenous inputs without input measurement noise, the complex FRF at each line is the H1 estimator \cite{pintelon2012system}
\begin{equation}
\hat{G}_j(\omega_k) = \frac{\hat{S}_{y_j u}(\omega_k)}{\hat{S}_{uu}(\omega_k)}.
\label{eq:h1}
\end{equation}
In MIMO form, with $u\in\mathbb{R}^m$, use the matrix generalization $\hat{G}(\omega_k)=\hat{S}_{yu}(\omega_k)\,\hat{S}_{uu}(\omega_k)^{-1}$. Confidence intervals and a diagnostic of excitation sufficiency follow from the magnitude-squared coherence,
\begin{equation}
\hat{\gamma}_j^2(\omega_k) = \frac{|\hat{S}_{y_j u}(\omega_k)|^2}{\hat{S}_{y_j y_j}(\omega_k)\,\hat{S}_{uu}(\omega_k)},\quad
\mathrm{Var}\{\hat{G}_j(\omega_k)\} \approx \frac{1-\hat{\gamma}_j^2(\omega_k)}{R\,\hat{\gamma}_j^2(\omega_k)} \frac{\hat{S}_{y_j y_j}(\omega_k)}{\hat{S}_{uu}(\omega_k)},
\label{eq:coh}
\end{equation}
with the usual caveats for finite-sample bias \cite{pintelon2012system}. To further suppress leakage where coherent sampling is imperfect, we employ local polynomial FRF estimation: fit a low-order polynomial model for $G_j(\omega)$ in a narrow band around each excited line by complex weighted least squares on $\{(\omega,\ U(\omega),\ Y_j(\omega))\}$, which reduces bias at the cost of variance \cite{pintelon2012system}. Alternatively, we regress directly across all excited lines onto a smooth parametric representation $G(\omega;\theta)$ (e.g., stable low-order rational forms) via
\begin{equation}
\hat{\theta} = \arg\min_{\theta} \sum_{\omega_k \in \Omega} w(\omega_k)\, \left\|Y(\omega_k) - G(\omega_k;\theta)\,U(\omega_k)\right\|_2^2 + \lambda\,\mathcal{R}[G(\cdot;\theta)],
\label{eq:global_spec_reg}
\end{equation}
with weights $w(\omega_k)\propto \hat{S}_{uu}(\omega_k)/\hat{S}_{vv}(\omega_k)$ and smoothness regularization $\mathcal{R}$ (e.g., Tikhonov on FRF derivatives) to trade bias and variance \cite{ljung1999system,pintelon2012system,enhanced_9_20250812}.

\paragraph{Nonlinearity diagnostics and spectral Volterra features}
Designed multisines enable harmonic and intermodulation checks: for an LTI system, all energy is confined to excited lines; nonlinearities populate unexcited harmonics and sums/differences. We quantify distortion via a harmonic distortion index (HDI),
\begin{equation}
\mathrm{HDI}_j = \frac{\sum_{\omega \in \mathcal{N}} |Y_j(\omega)|^2}{\sum_{\omega \in \Omega} |Y_j(\omega)|^2},
\end{equation}
where $\mathcal{N}$ collects non-excited lines within the analysis band \cite{pintelon2012system}. For characterization beyond detection, we estimate sparse second-order Volterra kernels in the frequency domain using lasso/elastic-net on polynomial-convolution features constructed from $U(\omega)$ at pairs $(\omega_k,\omega_\ell)$ that generate observed intermodulation products, yielding compact descriptors of cross-frequency coupling for E2 \cite{enhanced_12_20250812,enhanced_3_20250812}.

\paragraph{Sliding-window tracking and early-warning statistics}
To support E4, we repeat spectral regression in sliding windows as baseline forcing escalates, generating time series of $\hat{G}(\omega_k;t)$ and $\mathrm{HDI}_j(t)$. We test for approach to instability using two indicators: (i) phase drift, $\Delta \phi_j(\omega_k;t)$, trending toward $-\pi$ at control-relevant bands, and (ii) growth in $\mathrm{HDI}_j(t)$ signaling increasing nonlinearity. These are compared against passive variance/autocorrelation indicators for lead time and AUC, leveraging theory and empirical precedents on early warning in complex systems \cite{enhanced_5_20250812,macmartin2014dynamicsof}.

\paragraph{Practical considerations in ESMs}
The ARISE-SAI and CESM1(WACCM) protocols provide feasible contexts for such in-silico excitation with small-amplitude perturbations, ensembles, and cross-model comparisons \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}. We explicitly bound spectral power to respect stratospheric aerosol optical depth and ozone constraints during probing, and we exploit ensembles or segmentation to raise $R$ in \eqref{eq:coh}. The value-of-information perspective motivates allocating limited computational budget to frequency lines and ensembles that most reduce parameter uncertainty in \eqref{eq:fim} \cite{enhanced_2_20250812}. Identified FRFs and low-order parametric surrogates then feed robust controller synthesis (H-infinity/MPC) in E3 \cite{macmartin2014dynamicsof,enhanced_4_20250812}, with uncertainty carried from spectral regression to control via covariance propagation or Bayesian posteriors \cite{enhanced_8_20250812}.

\paragraph{Algorithmic summary (E1–E2)}
- Design: choose $\Omega$, amplitudes/phases by constrained D-optimal design on \eqref{eq:fim}, enforce coherent sampling and crest-factor limits.
- Excite: run the SAI-perturbed simulations (ensembles or long runs), collect $u_t$ and $y_t$.
- Estimate: compute $\hat{G}(\omega_k)$ and $\hat{\gamma}^2(\omega_k)$ via \eqref{eq:h1}–\eqref{eq:coh}; fit parametric $G(\omega;\theta)$ via \eqref{eq:global_spec_reg}.
- Diagnose: compute HDI and intermodulation maps; if HDI exceeds thresholds, augment with sparse Volterra features.
- Validate: predict held-out single-tone tests; report RMSE, coherence, HDI, and smoothness diagnostics (e.g., L-curve) as in E2.

By aligning designed inputs with frequency-domain estimators and uncertainty-aware input design, spectral regression turns pulsed SAI into an active spectroscopy of the climate system that is both data-efficient and directly actionable for control and early-warning, while remaining compatible with existing ESM infrastructures and geoengineering protocols \cite{tilmes2018stratospheric,richter2022assessingresponses,ljung1999system,pintelon2012system,enhanced_9_20250812}.


% === AREA: Pseudo-random binary sequences (PRBS) in climate model excitation. ===

\subsection{Pseudo-random binary sequence (PRBS) excitation for active spectroscopy in SAI-enabled Earth system models}
We incorporate pseudo-random binary sequences (PRBS) as a core excitation modality for information-efficient active spectroscopy of the climate response to stratospheric aerosol injection (SAI). PRBS inputs are a standard tool in system identification because they deliver broadband, near-white excitation with low crest factor under tight actuator constraints, leading to high Fisher information in the frequency band of interest while preserving small-signal conditions around a chosen operating point \cite{ljung1999system,pintelon2012system}. Within our framework, PRBS perturbations are superimposed on a steady SAI baseline to probe monthly–interannual dynamics and to estimate linear frequency responses and low-order nonlinear distortions with minimal confounding from internal variability.

We define the SAI injection-rate command as
\begin{equation}
u(t) = u_{0} + a\, s(t), \quad s(t)\in\{-1,+1\},
\label{eq:prbs-command}
\end{equation}
where $u_{0}$ is the steady baseline (e.g., $5$ TgS yr$^{-1}$), $a$ is a small modulation amplitude (e.g., $0.05$–$0.5$ TgS yr$^{-1}$ RMS), and $s(t)$ is a PRBS driven by an $m$-stage linear feedback shift register (LFSR) with period $N=2^{m}-1$. A zero-order hold with dwell time $\Delta$ (e.g., monthly) band-limits the excitation; the effective input spectrum is
\begin{equation}
S_{uu}(\omega) = a^{2}\, |H_{\mathrm{zoh}}(\omega;\Delta)|^{2}\, S_{ss}(\omega;N,\Delta),
\end{equation}
with $H_{\mathrm{zoh}}(\omega;\Delta)=\mathrm{sinc}\!\left(\tfrac{\omega \Delta}{2}\right) e^{-i\omega \Delta/2}$ and $S_{ss}$ the discrete-time PRBS spectrum, which is approximately flat up to its Nyquist frequency, aside from small ripples set by $N$ \cite{pintelon2012system}. For maximal-length sequences, the normalized autocorrelation satisfies $R_{ss}(\tau)=\delta_{\tau 0}-\tfrac{1}{N}$, ensuring persistent excitation in the targeted band \cite{ljung1999system}.

Deployment in an Earth system model (ESM) requires additional constraints:
(i) nonnegativity of $u(t)$,
(ii) seasonal and chemical constraints (e.g., avoiding large SAOD swings or ozone-sensitive patterns \cite{tilmes2018stratospheric,richter2022assessingresponses}),
and (iii) spectral separation from strong internal modes (annual cycle; quasi-biennial oscillation, QBO).
We satisfy (i) by $a\ll u_{0}$ and by allowing a ternary variant with a small number of zero steps to accommodate operational limits.
We address (ii)–(iii) via band-limited PRBS: choose $\Delta$ and $N$ so that the spectral lines cover $0.02$–$2$ cycles yr$^{-1}$ while avoiding exact commensurability with the seasonal harmonic (select $N$ co-prime with $12$) and, when needed, superimpose a mild shaping filter that enforces a spectral mask without violating amplitude constraints; shaping can be implemented by convolving $s(t)$ with a short, linear-phase FIR followed by amplitude rescaling, which preserves near-binary behavior and maintainable crest factor.

\paragraph{Frequency-domain identification under PRBS.}
Given outputs $y(t)$ (GMST, regional precipitation indices, circulation metrics) and input $u(t)$, we estimate linear frequency responses via leakage-corrected spectral regression \cite{pintelon2012system}:
\begin{equation}
\widehat{G}(\omega) = \frac{S_{yu}(\omega)}{S_{uu}(\omega)} \,, \qquad
\gamma^{2}(\omega)=\frac{|S_{yu}(\omega)|^{2}}{S_{uu}(\omega)\,S_{yy}(\omega)}\,,
\label{eq:frf-coherence}
\end{equation}
where $S_{\cdot\cdot}$ denote multi-taper or local-polynomial (ELPM) spectral estimates to mitigate leakage under colored disturbances. The coherence $\gamma^{2}(\omega)$ provides a diagnostic of signal-to-noise and of departures from linearity in the probed band \cite{pintelon2012system}. Because PRBS distributes power broadly and evenly, it efficiently populates $S_{uu}(\omega)$ across the monthly–interannual band in a single experiment, improving estimator variance relative to one-tone or one-off impulse tests for the same total simulation time \cite{ljung1999system}.

\paragraph{Nonlinear distortion under PRBS.}
To capture low-order nonlinearities, we estimate second-order Volterra effects using polynomial–convolution regressors or their frequency-domain analogues. In time domain,
\begin{equation}
y(t) \approx \sum_{\tau} g_{1}(\tau) u(t-\tau) + \sum_{\tau_{1},\tau_{2}} g_{2}(\tau_{1},\tau_{2}) u(t-\tau_{1})u(t-\tau_{2}) + e(t),
\label{eq:volterra2}
\end{equation}
with sparse regularization (lasso/elastic net) to control variance in high dimension and to isolate dominant quadratic pathways \cite{ljung1999system}. PRBS is well-suited for this task because its binary, zero-mean statistics yield rich even-order products while maintaining small amplitudes that keep the system in a near-linear regime. We quantify distortion via a harmonic distortion index (HDI) computed as the fraction of output variance explained by the quadratic term on held-out data and by out-of-band power under the linear prediction $\widehat{y}_{\mathrm{lin}}=g_{1}\!*u$.

\paragraph{Information-optimal PRBS design.}
We select $(a,\Delta,N)$ by maximizing a Fisher-information surrogate in the band of interest subject to environmental constraints \cite{ljung1999system,pintelon2012system}:
\begin{align}
\max_{a,\Delta,N} \quad & \mathrm{tr}\!\left(W\, \mathcal{I}(a,\Delta,N)\right) \\
\text{s.t.}\quad & 0< a \le a_{\max}, \quad \mathrm{SAOD}(u_{0}\!\pm a)\le \mathrm{SAOD}_{\max}, \nonumber\\
& S_{uu}(\omega)\in \mathcal{S}_{\text{mask}} \;\; \forall \omega\in[0.02,2] \,\mathrm{yr}^{-1},\nonumber
\end{align}
where $W$ encodes parameter or frequency priorities and $\mathcal{I}$ is evaluated using a prior $G_{0}(\omega)$ (from pilot runs or literature) and the standard asymptotic relation $\mathrm{Var}\{\widehat{G}(\omega)\}\propto \tfrac{S_{ee}(\omega)}{T\, S_{uu}(\omega)}$ with experiment length $T$ \cite{pintelon2012system}. This formalizes the trade-off among amplitude, duration, and identifiability emphasized in our practicality study (E6), and links directly to governance constraints on allowable variability \cite{tilmes2018stratospheric,richter2022assessingresponses,robock200820reasons}.

\paragraph{Integration with the experimental program (E1–E6).}
(i) E1—Identifiability: We compare PRBS to multi-sine and chirp designs under identical amplitude and duration budgets. Metrics include coherence, estimator covariance, and L-curve diagnostics for regularized Volterra fits. PRBS is expected to yield superior band coverage and lower variance in $\widehat{G}(\omega)$ for a single realization, while multisines excel when very fine spectral resolution at selected lines is needed \cite{pintelon2012system}.\\
(ii) E2—Frequency response and nonlinear distortion: We estimate $\widehat{G}$ via \eqref{eq:frf-coherence} and $g_{2}$ via \eqref{eq:volterra2}, then validate on held-out single-tone tests to quantify cross-frequency prediction error and HDI.\\
(iii) E3—Robust control synthesis: The PRBS-based surrogate (linear FRF + quadratic corrections) is used to design $H_{\infty}$ and MPC controllers that track GMST while constraining regional hydrology, following closed-loop control formulations established for solar geoengineering \cite{macmartin2014dynamicsof}. Broadband identification in the control-relevant band directly improves robustness margins.\\
(iv) E4—Early warning: We track phase-lag drift $\Delta\phi(\omega)$ of $\widehat{G}$ and growth in HDI as baseline forcing escalates. Under approaching instabilities, phase shifts toward $-\pi$ and rising nonlinear leakage are expected to precede variance/autocorrelation changes, offering earlier detection than passive metrics \cite{macmartin2014dynamicsof,robock200820reasons}.\\
(v) E5—Cross-model robustness: Replaying the same PRBS across model tiers (idealized aquaplanet/EMIC to CESM-like configurations) standardizes spectral coverage and enables apples-to-apples comparison of identified dynamics across the GeoMIP/ARISE-SAI-style protocols \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}.\\
(vi) E6—Practicality bounds: Using PRBS, estimator variance scales approximately as $1/(T a^{2})$ for fixed noise spectra \cite{ljung1999system,pintelon2012system}. We map the minimal $(a,T)$ achieving target errors under internal variability, quantifying computational cost and ensemble needs.

\paragraph{Design heuristics for SAI-ESM PRBS.}
- Choose $N$ co-prime with $12$ and $\Delta\in[1,3]$ months to avoid seasonal commensurabilities while covering QBO-scale variability.\\
- Target RMS $a$ such that the smallest gain in the band achieves coherence $\gamma^{2}(\omega)\gtrsim 0.6$; use pilot runs to calibrate $a$ under SAOD and ozone constraints \cite{tilmes2018stratospheric,richter2022assessingresponses}.\\
- Use an ensemble of $K$ phase-shifted PRBS realizations to reduce variance under colored internal variability; average cross-spectra across realizations to improve SNR without increasing peak excursions \cite{pintelon2012system}.\\
- For nonlinear separation, complement PRBS with odd random-phase multisines at a subset of lines to discriminate even/odd nonlinearities when needed, while keeping total perturbation energy fixed \cite{pintelon2012system}.

By embedding PRBS into the active spectroscopy workflow, we obtain high-information, low-amplitude perturbations that are simple to implement in existing models, statistically efficient for frequency-domain identification, and directly usable for robust controller synthesis and early-warning diagnostics. This contributes a practical, theoretically grounded pathway to quantify how temporal modulation of SAI shapes climate outcomes, beyond what passive observation or single-pulse experiments can recover \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof,kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses,keith2010researchon,robock200820reasons}.


% === AREA: Climate model emulation and surrogate modeling techniques. ===

\subsection{Control-oriented emulation and surrogate modeling}

Effective closed-loop design and early-warning diagnostics require fast, uncertainty-aware surrogates that preserve the control-relevant dynamics linking SAI injection rates to climate observables. Running Earth system models (ESMs) in the loop is infeasible except for short campaigns, and even large ensembles designed for SAI assessment \cite{tilmes2018stratospheric,richter2022assessingresponses} or multi-model intercomparisons \cite{kravitz2011thegeoengineering} cannot supply the frequency-resolved, repeatable experiments needed for controller synthesis and performance certification. We therefore embed a control-oriented emulation layer into our active spectroscopy framework. This layer learns compact input–output models from information-optimized, small-amplitude probes and exposes them to robust control design while quantifying epistemic and stochastic uncertainty \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.

We denote the pulsed SAI input as \(u_t \in \mathbb{R}^{m}\) (e.g., global or hemispheric injection rates in TgS yr\(^{-1}\)) and the vector of outputs as \(y_t \in \mathbb{R}^{p}\) (e.g., GMST, regional precipitation indices, SAOD). Probes are superimposed on a steady baseline injection; models are identified for small-signal dynamics around that operating point. Our emulation layer comprises three complementary surrogate classes.

(i) Frequency-response emulators (FRF). We estimate the multi-input multi-output frequency response \(G(\mathrm{e}^{\mathrm{i}\omega \Delta t}) \in \mathbb{C}^{p\times m}\) from designed multi-sine/PRBS excitations using spectral regression with leakage control and coherence weighting \cite{pintelon2012system}. For each frequency \(\omega\) in the targeted band \(\Omega = [0.02,2]\) yr\(^{-1}\),
\[
\widehat{G}(\omega) \;=\; \widehat{S}_{yu}(\omega)\,\widehat{S}_{uu}(\omega)^{-1},
\qquad
w(\omega) \;\propto\; \gamma^2(\omega) \;=\; \frac{\lVert \widehat{S}_{yu}(\omega)\rVert_F^2}{\lVert \widehat{S}_{uu}(\omega)\rVert_F\,\lVert \widehat{S}_{yy}(\omega)\rVert_F},
\]
with multitaper/segment averaging to reduce variance. We then fit a stable parametric model \(G_\theta\) (e.g., FIR/ARX/OE families) by weighted least squares with smoothness regularization \cite{ljung1999system}:
\[
\min_{\theta}\;\sum_{\omega\in\Omega} w(\omega)\,\big\|\widehat{G}(\omega)-G_{\theta}(\mathrm{e}^{\mathrm{i}\omega \Delta t})\big\|_F^2 \;+\; \lambda\,\lVert L\theta\rVert_2^2,
\]
where \(L\) encodes Tikhonov penalties on high-order coefficients to enforce physically plausible, low-pass behavior. Asymptotic covariance of \(\widehat{G}(\omega)\) from spectral regression \cite{pintelon2012system} and bootstrap resampling across ensemble members yield frequency-dependent confidence sets that feed robust controller synthesis.

(ii) Sparse Volterra emulators for weak nonlinearity. To capture harmonic generation and intermodulation detected in E2, we adopt a second-order Volterra representation,
\[
y_t \;=\; \sum_{k\ge 0} h_1[k]\;u_{t-k} \;+\; \sum_{k_1,k_2\ge 0} h_2[k_1,k_2]\;u_{t-k_1}\odot u_{t-k_2} \;+\; \varepsilon_t,
\]
with \(h_2[k_1,k_2]=h_2[k_2,k_1]\) and band-limited memory consistent with \(\Omega\). We estimate \(h_1,h_2\) using structured sparsity to control combinatorial growth while preserving key nonlinear couplings:
\[
\min_{h_1,h_2}\;\sum_t \big\|y_t - (h_1*u)_t - (u\star u)\star h_2\big\|_2^2
\;+\; \lambda_1\lVert D h_1\rVert_2^2 \;+\; \lambda_2 \big\|W\circ h_2\big\|_1,
\]
where \(D\) enforces smooth decay with lag and \(W\) masks implausible lag pairs. This class reconciles control-oriented parsimony with the need to diagnose nonlinear distortions from designed multi-tone inputs \cite{ljung1999system,pintelon2012system}. Validation against held-out single-tone tests quantifies normalized RMSE and harmonic distortion indices used in E2 and E4.

(iii) Koopman-lifted linear predictors for MPC. For receding-horizon control under stochastic variability, we learn a lifted linear model on features \(\phi(y_t,u_t,\text{exog}_t)\):
\[
z_{t+1} \;=\; A z_t + B u_t + K d_t,\qquad y_t \;=\; C z_t,\qquad z_t=\phi(\cdot),
\]
where \(d_t\) captures colored internal variability. Parameters \((A,B,C,K)\) are found by regularized prediction-error minimization with stability constraints (e.g., spectral radius projection for \(A\)). The feature map includes lags and seasonal bases so that the predictor reproduces the identified FRF in \(\Omega\) and the low-order nonlinear distortions needed for constraint handling in MPC. This “Koopman-regressed” predictor forms the plant model for H-infinity/MPC synthesis in E3, with uncertainty inflated by the FRF- and Volterra-derived confidence sets.

Design goals and validation. Across all surrogates we enforce:
- fidelity in the control-relevant band \(\Omega\): bounds on Bode magnitude/phase error and coherence thresholds;
- multi-output consistency: MIMO fits that respect cross-variable coherences (e.g., GMST–precipitation–SAOD);
- quantified uncertainty: frequency-dependent covariances and bootstrap intervals propagated to robust control;
- computational efficiency: training on probe experiments (E1) with wall-time compatible with iterative controller tuning.
Model selection uses L-curve trade-offs between fit and smoothness \cite{ljung1999system}, and cross-validation on held-out probe segments and single-tone tests (E2). Cross-tier tests (E5) validate transfer from idealized to chemistry-enabled ESMs \cite{richter2022assessingresponses,tilmes2018stratospheric}, while multi-model context from GeoMIP anchors structural robustness expectations \cite{kravitz2011thegeoengineering}.

Interface to robust control and early warning. The FRF surrogate supplies frequency-weighted uncertainty sets
\[
\mathcal{G}\;=\;\Big\{G:\; \big\|W^{-1}(\omega)\big(G(\omega)-\widehat{G}(\omega)\big)\big\|_{\infty}\le \rho,\;\forall \omega\in\Omega\Big\},
\]
for H-infinity synthesis, while the lifted predictor enables constraint-aware MPC that penalizes SAOD excursions and regional hydrological variability \cite{macmartin2014dynamicsof}. Volterra terms generate predicted harmonic content for early-warning metrics (E4) based on phase-lag drift toward \(-\pi\) and growth in harmonic distortion under slowly increasing baselines. Throughout, we emphasize that these emulators are identification surrogates built from small-signal, in-silico experiments; their development is aligned with responsible research principles \cite{keith2010researchon} and cognizant of the broader risks of geoengineering \cite{robock200820reasons}.

By coupling information-optimized probes with control-ready emulators grounded in frequency-domain system identification \cite{pintelon2012system,ljung1999system}, the framework provides a tractable, defensible path from expensive ESM dynamics to robust SAI control and early warning, improving on passive observational strategies in both data efficiency and diagnostic power.


% === AREA: Optimization algorithms for multi-objective climate control. ===

\subsection{Multi-objective optimization and robust control synthesis}

Active spectroscopy (E1–E2) yields compact surrogate dynamics from SAI injection rate to climate outputs in the frequency domain, providing the ingredients required for principled control design. We cast SAI scheduling as a multi-objective control problem that trades off global-mean surface temperature (GMST) tracking against regional hydrology stability and operational/safety constraints on the stratospheric aerosol optical depth (SAOD) and injection effort. Our optimization layer is built on two complementary controllers that share the identified surrogate models: (i) frequency-shaped mixed-sensitivity H-infinity control for guaranteed worst-case attenuation across bands, and (ii) frequency-weighted model predictive control (MPC) for constrained, setpoint-tracking operation under stochastic variability. The use of information-rich, small-amplitude excitation to identify frequency response and nonlinear distortions is standard in system identification and enables reliable controller synthesis at modest experiment length and signal-to-noise ratio \cite{ljung1999system,pintelon2012system}. Control formulations build on prior work on closed-loop geoengineering \cite{macmartin2014dynamicsof} and exploit existing SAI protocols/ensembles to set scenario bounds and stressors \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. We explicitly embed safety and governance concerns by constraining excursions and rate limits, consistent with calls for cautious, well-instrumented research \cite{robock200820reasons,keith2010researchon}.

We denote by u the zonally integrated injection-rate control (TgS/yr), by y the vector of outputs (GMST anomaly T, regional precipitation indices P, and SAOD A), and by d exogenous disturbances (internal variability, ENSO-like modes, and occasional volcanic forcing). Around a steady baseline, the linear frequency response G(e^{\jmath\omega}) and second-order distortions from the identified Volterra kernels define a surrogate
y = G(q^{-1})\,u + \Phi_2(u) + H(q^{-1})\,d + \varepsilon,
where q^{-1} is the monthly shift operator, H captures disturbance pathways, and \varepsilon collects residuals. The second-order term \Phi_2 allows us to monitor and penalize nonlinear harmonic/intermodulation content uncovered in E2.

Multi-objective control is posed as minimizing a vector of criteria J = [J_T, J_P, J_A, J_u, J_{\mathrm{HD}}], where
- J_T penalizes GMST tracking error e_T,
- J_P penalizes selected regional precipitation anomalies/variance,
- J_A penalizes SAOD mean and variability,
- J_u penalizes control effort and total variation Δu,
- J_{\mathrm{HD}} penalizes harmonic distortion energy estimated from \Phi_2.
To expose trade-offs, we use scalarizations that admit both Pareto exploration and robust guarantees.

H-infinity design (offline). We define frequency weights W_e(\mathrm{e}^{\jmath\omega}), W_u(\mathrm{e}^{\jmath\omega}), and W_y(\mathrm{e}^{\jmath\omega}) from the identified Bode magnitudes and coherence: W_e emphasizes interannual bands for GMST tracking while downweighting very-low-frequency integral wind-up; W_y emphasizes bands where regional hydrology is most sensitive; W_u encodes actuator rate limits and SAOD smoothness. With the mixed-sensitivity interconnection P and a stabilizing controller K, we solve
\[
\min_{K}\ \gamma\quad\text{s.t.}\quad \left\|F_{\ell}\!\left(P,\,K\right)\right\|_{\infty} < \gamma,
\]
thus bounding the worst-case gain from disturbances and measurement noise to weighted errors and control across all frequencies. The identified G is discretized and augmented with the weighting filters; uncertainty from E1–E2 is represented as frequency-dependent multiplicative bounds derived from confidence envelopes on G(e^{\jmath\omega}) \cite{pintelon2012system}. This controller provides a robust baseline with guaranteed attenuation at bands where spectroscopy shows strong, lagged coupling.

Frequency-weighted MPC (online). For constrained, setpoint-tracking operation we solve a receding-horizon program each month:
\[
\begin{aligned}
\min_{\{u_{t+k}\}}\ & \sum_{k=1}^{N}\left(\|W_T \star e_{T,t+k|t}\|_2^2 + \|W_P \star y_{P,t+k|t}\|_2^2 + \lambda_A \|y_{A,t+k|t}\|_2^2 + \lambda_u \|\Delta u_{t+k}\|_2^2 + \lambda_{\mathrm{HD}} \|\widehat{\Phi}_2(u)_{t+k|t}\|_2^2 \right)\\
\text{s.t.}\ & x_{t+k+1|t}=A x_{t+k|t}+B u_{t+k}+w_{t+k},\ \ y_{t+k|t}=C x_{t+k|t},\\
& A_{\min}\le y_{A,t+k|t}\le A_{\max},\ \ |\Delta u_{t+k}|\le r_{\max},\ \ u_{\min}\le u_{t+k}\le u_{\max},\\
& y_{P,t+k|t}\in \mathcal{P}\ \text{(regional bounds)},\quad w_{t+k}\in \mathcal{W},
\end{aligned}
\]
where the identified linear predictor (from E2 or Koopman-regressed dynamics) supplies (A,B,C). Frequency weights W_T and W_P are implemented via stable shaping filters (operator “⋆”), allowing us to emphasize monthly-to-interannual bands uncovered by active spectroscopy. Tube MPC or chance constraints provide robustness to model error and variability by tightening \mathcal{P} and \mathcal{W}. This formulation directly enforces SAOD bounds and slew limits motivated by ensemble protocols \cite{tilmes2018stratospheric,richter2022assessingresponses} and GeoMIP-style scenario envelopes \cite{kravitz2011thegeoengineering}. Penalizing the predicted second-order energy \widehat{\Phi}_2(u) steers operation away from regimes where nonlinear distortion grows, aligning the controller with early-warning objectives developed in E4.

Pareto exploration and selection. We explore the Pareto frontier by varying scalarization weights or via a goal-attainment/Tchebyshev formulation:
\[
\min_{\mathbf{u}} \ \rho\quad \text{s.t.}\quad w_i\left(J_i(\mathbf{u})-g_i\right)\le \rho,\ \ i\in\{T,P,A,u,\mathrm{HD}\},
\]
with aspiration levels g_i set from policy targets (e.g., GMST tracking bands, regional precipitation variance budgets, SAOD ceilings). Candidate points are stress-tested with exogenous ENSO-like variability and a volcanic eruption shock within the ESM, following evaluation recipes in \cite{tilmes2018stratospheric,richter2022assessingresponses}. Cross-model robustness (E5) is achieved by minimizing the worst-case or expected regret across a small set of surrogate models fit to different configurations, reflecting structural spread in ensemble projects \cite{kravitz2011thegeoengineering}. 

Safety and governance constraints. Consistent with concerns about unintended consequences \cite{robock200820reasons}, we require hard caps on SAOD excursions and on injection-rate total variation, retain slack only on soft regional objectives with explicit accounting in J, and log all constraint margins. Active spectroscopy reduces model ambiguity at the frequencies most relevant for control \cite{pintelon2012system}, thereby shrinking uncertainty sets before closing the loop. The proposed workflow operationalizes the call for careful, information-efficient research on solar climate interventions \cite{keith2010researchon}.

Evaluation. In E3 we report Pareto fronts and select two operating points: a “safety-first” H-infinity design and a “performance-leaning” MPC design. We quantify tracking RMSE, constraint-violation rate, control effort (TV norm), worst-case regional anomaly, and regret relative to an oracle with access to the truth run. Because the weights and filters are derived from measured Bode gain/phase and coherence, the resulting controllers are explicitly tied to identifiable pathways in the Earth system, rather than to ad hoc temporal modulation rules, aligning with best practice in frequency-domain identification and control \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.


% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{Active Spectroscopy via Information-Optimal Pulsed SAI for Frequency-Domain Identification and Robust Control}

We propose to treat stratospheric aerosol injection (SAI) as an active spectroscopy experiment: small-amplitude, information-optimized pulsations are superimposed on a steady baseline injection to directly measure the Earth system’s frequency response and low-order nonlinear distortions. This design addresses a central gap in existing SAI protocols, which predominantly rely on steps or ramps (e.g., GeoMIP and ARISE-SAI) and large ensembles to infer mean sensitivities and impacts \citep{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}. In contrast, frequency-domain system identification with designed excitation is the most direct and data-efficient route to recover gains, lags, and cross-frequency couplings needed for control synthesis \citep{ljung1999system, pintelon2012system}. It further enables early-warning diagnostics based on phase drift and harmonic growth that standard passive metrics (variance, autocorrelation) cannot resolve in the same time window \citep{enhanced_5_20250812}.

We cast the climate-plus-SAI system as a partially observed, weakly nonlinear MIMO system with input $u(t)$ (injection rate, TgS/yr) and outputs $y(t)$ (e.g., GMST, regional precipitation indices, stratospheric winds, SAOD). Around a steady baseline $\bar u$ (e.g., $5$ TgS/yr), we inject a persistently exciting probe
\begin{equation}
u(t) \;=\; \bar u \;+\; \sum_{k=1}^{K} a_k \sin\!\big(2\pi f_k t+\phi_k\big) \;+\; a_{\mathrm{PRBS}}\,r(t) \;+\; a_{\mathrm{chirp}}\sin\!\Big(2\pi\big(f_0 t+\tfrac{\alpha}{2}t^2\big)+\phi_0\Big),
\label{eq:probe}
\end{equation}
where the multi-sine covers monthly to interannual bands $f_k\in[0.02,2]$ cycles/year, PRBS $r(t)$ broadens spectral coverage, and an optional linear chirp refines interpolation between lines. Amplitudes are small ($0.05$–$0.5$ TgS/yr RMS) to preserve local linearity and minimize environmental risk, consistent with the need for careful, incremental learning emphasized in the SAI literature \citep{keith2010researchon, robock200820reasons}. The multi-sine phases $\{\phi_k\}$ are chosen to minimize crest factor and to suppress intermodulation leakage \citep{pintelon2012system}.

Information-optimal probe design. For a parametric frequency response $G(i\omega;\theta)$ from injection to a given output, the Fisher information matrix (FIM) under stationary noise with spectrum $S_{\varepsilon\varepsilon}(\omega)$ and multi-sine input concentrates at the excited lines $\Omega=\{2\pi f_k\}$:
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \sum_{\omega\in\Omega} \frac{2T}{S_{\varepsilon\varepsilon}(\omega)}
\bigg(\frac{\partial G(i\omega;\theta)}{\partial \theta}\bigg)^{\!*}
\,|U(\omega)|^2\,
\bigg(\frac{\partial G(i\omega;\theta)}{\partial \theta}\bigg),
\label{eq:fim}
\end{equation}
with $|U(\omega)|^2 \propto a_k^2$ for $\omega=2\pi f_k$ and experiment length $T$ \citep{ljung1999system, pintelon2012system}. We allocate amplitudes across bands by maximizing a D-optimal or A-optimal criterion $\Phi(\mathcal{I})$ subject to (i) probe power and rate-of-change limits, (ii) bounds on induced stratospheric aerosol optical depth (SAOD) excursions via a linear proxy $H_a(i\omega)$, and (iii) application-specific constraints (e.g., variance of key regional hydrological indices), leveraging established optimal input design methods for nonlinear and high-dimensional systems \citep{enhanced_6_20250812, comprehensive_6_20250812}. This converts the qualitative “pulsed vs. continuous” debate into a quantitative value-of-information trade-off \citep{enhanced_2_20250812, comprehensive_2_20250812}.

Frequency-domain identification. For each output, we estimate the empirical transfer function using leakage-corrected spectral regression,
\begin{equation}
\widehat{G}(\omega_k) \;=\; \frac{\widetilde{S}_{yu}(\omega_k)}{\widetilde{S}_{uu}(\omega_k)} \,,
\qquad
\gamma^2(\omega_k) \;=\; \frac{|\widetilde{S}_{yu}(\omega_k)|^2}{\widetilde{S}_{uu}(\omega_k)\,\widetilde{S}_{yy}(\omega_k)},
\label{eq:spectral-regression}
\end{equation}
with Welch averaging, multi-tapering, and local rational de-biasing to mitigate spectral leakage due to finite record length and colored disturbances \citep{pintelon2012system, enhanced_9_20250812, comprehensive_9_20250812}. The magnitude-phase pair $(|\widehat{G}|,\angle\widehat{G})$ defines the Bode response; confidence envelopes follow standard asymptotics with degrees-of-freedom from segment averaging \citep{pintelon2012system}. Regularization parameters for smoothness are selected via an L-curve balancing fit and curvature, and identifiability is quantified by the condition number and confidence volume implied by \eqref{eq:fim}. Persistent excitation requirements are enforced at order $2n$ for an $n$th-order linear model \citep{ljung1999system}.

Nonlinear distortion and Volterra kernels. Small-amplitude nonlinearity is captured by a second-order Volterra model,
\begin{equation}
y(t) \;=\; h_0 \;+\; (h_1 * u)(t) \;+\; \iint h_2(\tau_1,\tau_2)\,u(t-\tau_1)\,u(t-\tau_2)\,d\tau_1 d\tau_2 \;+\; \varepsilon(t),
\label{eq:volterra}
\end{equation}
which predicts harmonic generation at $2f_k$ and intermodulation at $f_i\pm f_j$ under multi-sine excitation \citep{pintelon2012system}. We estimate $h_2$ with sparsity-promoting regression on polynomial-convolution features and orthogonal forward selection \citep{enhanced_12_20250812, enhanced_3_20250812, comprehensive_3_20250812}. A harmonic distortion index (HDI) summarizes nonlinear energy leakage:
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega\in \mathcal{H}\setminus\Omega} P_y(\omega)}{\sum_{\omega\in \Omega} P_y(\omega)},
\qquad
\mathcal{H} \;=\; \{2\pi(2f_k),\, 2\pi(f_i\pm f_j)\}.
\label{eq:hdi}
\end{equation}
Validation uses held-out single-tone tests and cross-spectral prediction error on bands not used in fitting, reporting normalized RMSE and coherence.

Surrogate dynamics for control. The identified responses are converted to compact surrogate models for controller synthesis: (i) rational transfer functions fit to $\widehat{G}(i\omega)$, (ii) reduced Volterra models to bound nonlinear residuals, and (iii) Koopman-regressed linear predictors to enable receding-horizon optimization \citep{enhanced_10_20250812, comprehensive_11_20250812}. Building on closed-loop geoengineering concepts \citep{macmartin2014dynamicsof}, we design multi-objective H-infinity and MPC controllers that track GMST while constraining regional hydrological variability and limiting SAOD excursions. A standard weighted $H_\infty$ synthesis minimizes the worst-case gain from disturbances (e.g., ENSO-like variability and volcanic aerosols) to regulated outputs,
\begin{equation}
\min_{K} \;\; \| F_\ell(P, K) \|_\infty \quad \text{s.t.} \quad
W_e\,S \in \mathcal{H}_\infty,\;\;
W_u\,K S \in \mathcal{H}_\infty,\;\;
W_t\,T \in \mathcal{H}_\infty,
\label{eq:hinf}
\end{equation}
with sensitivity $S=(I+GK)^{-1}$, complementary sensitivity $T=I-S$, and weights $W_e, W_u, W_t$ encoding tracking, actuation effort (TV-norm proxy), and SAOD/precipitation constraints \citep{enhanced_4_20250812, comprehensive_4_20250812}. Parametric and unmodeled dynamics uncertainties are incorporated via frequency-weighted multiplicative bounds derived from coherence gaps and residuals. We benchmark closed-loop performance against continuous and naive square-wave pulsing under ARISE-SAI-like protocols \citep{richter2022assessingresponses} and GeoMIP scenarios \citep{kravitz2011thegeoengineering}.

Early-warning indicators from active probes. As baseline forcing is gradually increased (e.g., escalating SAI to counter rising GHG forcing), we re-estimate $\widehat{G}(i\omega)$ on rolling windows and monitor:
\begin{equation}
\Delta\phi(\omega_k;t) \;=\; \angle\widehat{G}(\omega_k;t) \;-\; \angle\widehat{G}(\omega_k;t_0),
\qquad
\mathrm{HDI}(t),
\label{eq:ewi}
\end{equation}
hypothesizing that approaching instabilities exhibit phase drift toward $-\pi$ at low frequencies and rising HDI, reflecting increasing memory and nonlinearity \citep{enhanced_5_20250812}. Detection skill (lead time, AUC) is compared to passive early-warning metrics (variance, lag-1 autocorrelation), leveraging ensemble spread from large-ensemble SAI simulations \citep{tilmes2018stratospheric}.

Practicality and model tiers. All steps (E1–E6) are feasible in intermediate-complexity and coarser-resolution ESMs with interactive stratospheric aerosols and chemistry (e.g., CESM1(WACCM), ARISE-SAI) \citep{tilmes2018stratospheric, richter2022assessingresponses}. Information-optimal probe design reduces the experiment length and ensemble size required to achieve target uncertainty on $\widehat{G}$, as quantified by the growth of $\Phi(\mathcal{I})$ with amplitude and duration \citep{ljung1999system, enhanced_6_20250812}. Cross-model transfer of identified controllers and surrogate models is assessed with established cross-scale validation diagnostics \citep{enhanced_7_20250812}, and uncertainty is propagated using Bayesian ensemble frameworks \citep{enhanced_8_20250812, comprehensive_8_20250812}. Throughout, we adhere to conservative amplitude bounds and environmental constraints in recognition of the risks and uncertainties surrounding SAI \citep{robock200820reasons}, while answering the research call for controlled, informative investigations \citep{keith2010researchon}.

Taken together, active SAI spectroscopy provides (i) compact, generalizable surrogate dynamics for robust control, (ii) an information-theoretic basis for experimental design under internal variability, and (iii) actionable early-warning signals derived from phase and harmonic diagnostics. This reframes temporal modulation not as an end in itself, but as a minimally invasive, high-information experiment that clarifies the pathways by which SAI affects coupled climate variables, complementing and extending current intercomparison and protocol efforts \citep{kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}.


% === AREA: Information theory applications in climate science and modeling. ===

\subsection{Information-theoretic probe design and value-of-information for active SAI spectroscopy}

We cast pulsed SAI as an experiment design problem: choose a band-limited, small-amplitude excitation that maximizes the information gained about the climate system’s frequency response most relevant to control and risk, subject to environmental and practicality constraints. This reframes “pulsing” as active spectroscopy rather than as an alternative deployment regime. The approach leverages frequency-domain system identification and optimal input design from control theory (e.g., Fisher information maximization, D-/A-optimal criteria) to make the most of limited simulation time and amplitude budgets, while aligning information gain with downstream controller synthesis and early-warning detection \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof}. It is compatible with standard SAI protocols and ensembles used to quantify variability and impacts \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, and it connects directly to information-theoretic analyses increasingly used in climate science \cite{enhanced_2_20250812,enhanced_9_20250812}.

We consider a baseline SAI scenario with a small additive probe
u(t) = u_{0} + \delta u(t),
where \delta u is a multi-sine/PRBS/chirp with RMS amplitude in the 0.02–0.5 TgS yr^{-1} range. For a set of p outputs y_i(t) (e.g., GMST, regional precipitation indices, circulation metrics), a discrete-time, wide-sense stationary approximation over the experiment duration T yields the frequency-domain relation at excited lines \omega_k:
\begin{equation}
Y_i(\omega_k) \;=\; G_i(\omega_k;\,\theta)\,U(\omega_k) \;+\; V_i(\omega_k), \qquad k=1,\dots,K,\; i=1,\dots,p,
\label{eq:freq-domain-model}
\end{equation}
where G_i(\omega;\theta) denotes the (possibly slowly time-varying) injection-to-output frequency response parameterized by \theta, and V_i is internal variability with spectral density S_{v_i}(\omega). Eq. \eqref{eq:freq-domain-model} is the standard starting point for frequency-domain identification and spectral regression \cite{pintelon2012system,enhanced_9_20250812}.

Information metrics and experiment design. For Gaussian V with block-diagonal spectral density S_v(\omega)=\mathrm{diag}(S_{v_1}(\omega),\dots,S_{v_p}(\omega)), the Fisher information matrix (FIM) for \theta from K excited frequencies is
\begin{equation}
\mathcal{J}(\theta;U) \;=\; 2T \sum_{k=1}^K 
\left[ \frac{\partial \mu(\omega_k)}{\partial \theta} \right]^{\!\top}
\! S_v^{-1}(\omega_k) \,
\left[ \frac{\partial \mu(\omega_k)}{\partial \theta} \right],
\quad
\mu(\omega_k)\equiv \big(G(\omega_k;\theta)\,U(\omega_k)\big),
\label{eq:fim}
\end{equation}
where the factor 2T reflects the number of independent Fourier ordinates over duration T in the narrowband setting \cite{ljung1999system,pintelon2012system}. In linear-in-parameters models, \partial \mu/\partial\theta separates into sensitivity of G times U(\omega_k), so information scales linearly with T and with |U(\omega_k)|^2, but is attenuated at frequencies dominated by internal variability via S_v^{-1}(\omega_k) (cf. SNR shaping).

We choose U to maximize a task-weighted information objective. Under a Gaussian prior \theta\sim\mathcal{N}(\bar\theta,\Sigma_\theta), the expected mutual information between \theta and data y given U is
\begin{equation}
\mathcal{I}(\theta;\,y\,|\,U) \;=\; \tfrac{1}{2}\log\det\!\big(I+\Sigma_\theta\,\mathcal{J}(\bar\theta;U)\big),
\label{eq:mi}
\end{equation}
which upper-bounds posterior entropy and connects to D-optimal design \cite{ljung1999system,enhanced_6_20250812,enhanced_2_20250812}. To align with control, we weight parameters by their effect on closed-loop cost J_{\mathrm{ctl}} (e.g., H_\infty/MPC tracking and constraint penalties), replacing \Sigma_\theta with W^{1/2}\Sigma_\theta W^{1/2} or adopting an A-optimal surrogate \mathrm{tr}\big(W\,\mathcal{J}^{-1}\big), with W proportional to the local curvature of J_{\mathrm{ctl}} w.r.t. \theta \cite{macmartin2014dynamicsof,enhanced_4_20250812}.

Amplitude, spectrum, and constraint set. With multi-sine U(\omega_k)=a_k e^{j\phi_k}, phases \phi_k are drawn to minimize crest factor and spectral leakage, while amplitudes a_k solve
\begin{align}
\max_{\{a_k,\phi_k\}} \quad & \mathcal{I}(\theta;\,y\,|\,U) \;-\; \lambda_{\mathrm{smooth}}\mathcal{R}(G) \\
\text{s.t.}\quad & \sum_{k} a_k^2 \leq E_{\max}, \;\; 0\le a_k \le a_{\max}, \;\; \mathrm{SAOD\ variance}\le \sigma_{\max}^2, \;\; \mathrm{ozone/UV\ constraints}, \nonumber
\label{eq:design}
\end{align}
where \mathcal{R}(G) enforces Bode smoothness or Volterra-kernel sparsity and \lambda_{\mathrm{smooth}} is tuned via an L-curve \cite{pintelon2012system,enhanced_12_20250812}. Environmental constraints reflect ARISE-SAI and community guidance on acceptable perturbations \cite{richter2022assessingresponses,robock200820reasons,keith2010researchon}. When operational or model constraints favor binary actuation, PRBSs offer quasi-white spectra over the target band, providing near-D-optimal excitation under energy limits \cite{ljung1999system,enhanced_10_20250812}. In all cases, the optimal design preferentially allocates power where (i) sensitivity \partial G/\partial\theta is large, (ii) internal variability S_v is small, and (iii) controller performance is most sensitive to uncertainty.

Parameterization and leakage-aware estimation. Two complementary parameterizations are used: (i) a low-order rational model for G(\omega;\theta) per output (yielding smooth Bode gains/phases), and (ii) a grid of complex FRF ordinates with a roughness prior across \omega to capture weakly nonparametric behavior. Estimation employs spectral regression with leakage correction and multitapering to mitigate annual and ENSO aliasing \cite{pintelon2012system,enhanced_9_20250812}. Internal variability spectra S_v(\omega) are estimated from control or SAI ensembles (e.g., CESM1(WACCM) and ARISE-SAI configurations) to inform both the FIM and robust weighting \cite{tilmes2018stratospheric,richter2022assessingresponses}.

From information to control value and regret. The control value of information is quantified by the expected reduction in closed-loop regret relative to an oracle with true dynamics. For small posterior covariance \Sigma_{\theta|y,U}, a second-order approximation gives
\begin{equation}
\mathbb{E}\big[J_{\mathrm{ctl}}(\hat\theta)\big] \;\approx\; J_{\mathrm{ctl}}(\bar\theta) \;+\; \tfrac{1}{2}\,\mathrm{tr}\!\big(\nabla^2_{\!\theta} J_{\mathrm{ctl}}(\bar\theta)\,\Sigma_{\theta|y,U}\big),
\label{eq:regret}
\end{equation}
so designs that minimize \mathrm{tr}\big(W\,\Sigma_{\theta|y,U}\big) with W=\nabla^2_{\!\theta} J_{\mathrm{ctl}} reduce expected regret and tighten robust margins for H_\infty/MPC synthesis \cite{macmartin2014dynamicsof,enhanced_4_20250812}. This linkage turns experiment design into a decision-aware information allocation problem \cite{enhanced_2_20250812}.

Early warning as information drift. Active spectroscopy also supports change detection: at regular intervals, we re-estimate FRFs and compute bandwise phase drift \Delta\phi(\omega,t) and a harmonic distortion index,
\begin{equation}
\mathrm{HDI}(\Omega,t) \;=\; \frac{\sum_{m\ge 2}\sum_{\omega\in m\Omega} \|Y(\omega,t)\|^2}{\sum_{\omega\in \Omega} \|Y(\omega,t)\|^2},
\end{equation}
under fixed, low-amplitude probes. Approaching instabilities are hypothesized to manifest as phase lag trending toward -\pi at controller crossover and growing HDI due to emerging nonlinearities. We formalize detection via a sequential log-likelihood ratio or KL divergence between current and baseline posteriors over FRF parameters,
\begin{equation}
D_{\mathrm{KL}}(t) \;=\; \tfrac{1}{2}\left[\log\frac{\det \Sigma_0}{\det \Sigma_t} - p + \mathrm{tr}(\Sigma_0^{-1}\Sigma_t) + (\mu_t-\mu_0)^\top \Sigma_0^{-1}(\mu_t-\mu_0)\right],
\end{equation}
and compare detection lead time and AUC against passive metrics (variance, lag-1 autocorrelation) \cite{enhanced_5_20250812}. Frequency-targeted probes increase the power of instability detection in specific dynamical pathways relative to passive observation.

Practicality bounds and cross-model discriminability. The FIM scaling \mathcal{J}\propto T and \propto |U|^2 provides transparent amplitude–duration trade-offs for E1/E6: when probe amplitudes are tightly constrained, extending experiment length or using ensembles increases information nearly linearly until leakage and colored-noise effects dominate \cite{ljung1999system,pintelon2012system}. To assess transferability, we also choose U to maximize expected separability among candidate surrogate or ESM responses via a multi-model KL objective, thereby designing excitations that are discriminative across structural uncertainties and informative for Bayesian model combination \cite{enhanced_7_20250812,enhanced_8_20250812}. Because the proposed designs are band-limited and low-amplitude, they remain compatible with existing SAI simulation protocols and governance-oriented caution on perturbation magnitude \cite{richter2022assessingresponses,robock200820reasons,keith2010researchon}.

In summary, an information-theoretic design closes the loop between probing, identification, control, and monitoring: the same carefully crafted small-amplitude signals simultaneously (i) maximize spectral information about SAI-relevant dynamics, (ii) target uncertainty that matters most for robust control, and (iii) amplify sensitivity to early-warning signatures—yielding higher scientific and decision value per simulated year than passive observation or one-off impulses \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof,enhanced_2_20250812,enhanced_9_20250812}.


% === AREA: Volterra kernel methods for nonlinear system identification in climate models. ===

\subsection{Nonlinear spectroscopy with Volterra kernels: identifying harmonics and cross-frequency coupling}

Active multi-tone probing enables direct estimation of nonlinear distortions in the climate response to stratospheric aerosol injection (SAI), complementing the linear frequency response in our framework. We model small-signal departures around a steady injection baseline using a low-order Volterra series, which provides a canonical input–output representation of weakly nonlinear, time-invariant dynamics and admits efficient frequency-domain identification under designed multisines and related periodic excitations (Ljung, 1999; Pintelon and Schoukens, 2012).

Let the SAI rate be decomposed as \(u[k] = \bar{u} + \delta u[k]\) and an output of interest (e.g., GMST, Sahel precipitation index, or zonal-mean stratospheric wind) as \(y_i[k] = \bar{y}_i + \delta y_i[k]\), with \(k\) denoting monthly timesteps. For sufficiently small probes \(\delta u\) around the operating point \((\bar{u},\bar{y})\), the second-order Volterra approximation for each output channel \(i\) is
\begin{equation}
\delta y_i[k]
= \sum_{\tau=0}^{L_1} h_{i,1}[\tau]\, \delta u[k-\tau]
+ \sum_{\tau_1=0}^{L_2}\sum_{\tau_2=0}^{L_2} h_{i,2}[\tau_1,\tau_2]\,
\delta u[k-\tau_1]\, \delta u[k-\tau_2]
+ e_i[k],
\label{eq:volterra_time}
\end{equation}
where \(h_{i,1}\) is the linear kernel, \(h_{i,2}\) captures quadratic nonlinearities (harmonic generation and intermodulation), \(L_1,L_2\) are memory lengths matched to the climate response timescales under study, and \(e_i\) represents colored internal variability and numerical noise. Equation \eqref{eq:volterra_time} can be viewed as a local second-order Taylor approximation of the input–output mapping around \(\bar{u}\) (Ljung, 1999, Ch. 5), justified when probe amplitudes are small relative to climatological variability and baseline SAI (Tilmes et al., 2018; Richter et al., 2022).

Frequency-domain identification. For periodic excitations and sufficiently long runs, the Discrete Fourier Transforms \(U(\omega)\) and \(Y_i(\omega)\) satisfy the generalized frequency response relation (Pintelon and Schoukens, 2012, Chs. 5–7)
\begin{equation}
Y_i(\omega)
= H_{i,1}(\omega)\, U(\omega)
+ \sum_{\omega_1+\omega_2=\omega} H_{i,2}(\omega_1,\omega_2)\, U(\omega_1)\, U(\omega_2)
+ N_i(\omega),
\label{eq:gfrf}
\end{equation}
where \(H_{i,1}\) is the linear frequency response function (FRF) and \(H_{i,2}\) is the second-order generalized FRF (GFRF). With multi-sine inputs
\begin{equation}
\delta u[k] = \sum_{m\in\mathcal{M}} A_m \cos(\omega_m k + \phi_m),
\qquad \omega_m \in [\omega_{\min}, \omega_{\max}],
\label{eq:multisine}
\end{equation}
the nonlinear terms populate sum- and difference-frequency lines \(\omega_m \pm \omega_n\) and second harmonics \(2\omega_m\), enabling targeted estimation of \(H_{i,2}\) from measured spectra. To separate linear contributions from nonlinear distortions and noise, we adopt best practices from frequency-domain system identification: (i) use random-phase multisines to reduce crest factor and bias; (ii) assign disjoint line sets to excite odd/even nonlinearities and to create dedicated “detection lines’’ where any measured energy cannot originate from the linear model, yielding an on-line nonlinearity diagnostic; and (iii) apply local-polynomial leakage correction and multi-record averaging to improve spectral estimates under colored variability (Pintelon and Schoukens, 2012).

Input design and identifiability. The excited frequency set \(\{\omega_m\}\), amplitudes \(\{A_m\}\), and phases \(\{\phi_m\}\) are chosen to maximize Fisher information subject to environmental and modeling constraints (variance budgets, stratospheric chemistry limits, and allowable SAOD excursions), following standard optimal input design principles (Ljung, 1999; see also the ensemble and protocol perspective in Kravitz et al., 2011; Tilmes et al., 2018; Richter et al., 2022). For a parameterized representation of the kernels (see below), the approximate information matrix is
\begin{equation}
\mathcal{I}(\theta) \approx \sum_{\omega\in\mathcal{K}}
\frac{\partial \mu_i(\omega;\theta)}{\partial \theta}^\top
\Sigma_i^{-1}(\omega)
\frac{\partial \mu_i(\omega;\theta)}{\partial \theta},
\qquad
\mu_i(\omega;\theta) := H_{i,1}(\omega;\theta)\,U(\omega)
+ \sum_{\omega_1+\omega_2=\omega} H_{i,2}(\omega_1,\omega_2;\theta)\, U(\omega_1)U(\omega_2),
\label{eq:fim}
\end{equation}
with \(\Sigma_i(\omega)\) the spectral covariance of \(N_i(\omega)\) estimated from replicate runs/ensembles. We distribute \(A_m\) to equalize signal-to-noise across bands while reserving unexcited detection lines for distortion and noise assessment (Pintelon and Schoukens, 2012).

Estimation algorithms. We adopt two complementary estimators:

- Frequency-domain spectral regression. At excited linear lines \(\omega_m\), estimate \(H_{i,1}(\omega_m)\) via
\begin{equation}
\widehat{H}_{i,1}(\omega_m) = \frac{\widehat{S}_{y_iu}(\omega_m)}{\widehat{S}_{uu}(\omega_m)},
\end{equation}
with leakage-corrected cross- and auto-spectra. At intermodulation and harmonic lines \(\omega_p = \omega_m \pm \omega_n\) and \(2\omega_m\), regress \(Y_i(\omega_p)\) on the corresponding quadratic monomials \(U(\omega_m)U(\omega_n)\) to estimate selected slices of \(H_{i,2}\). This yields a sparse set of GFRF coefficients aligned with the designed frequency grid, directly interpretable as cross-frequency gains (Pintelon and Schoukens, 2012).

- Time-domain sparse Volterra regression. Construct polynomial–convolution features up to order two and memory \(L\), then fit
\begin{equation}
\min_{h_{i,1},h_{i,2}}
\sum_k \Big(\delta y_i[k] - \sum_{\tau} h_{i,1}[\tau]\, \delta u[k-\tau]
- \sum_{\tau_1\le \tau_2} h_{i,2}[\tau_1,\tau_2]\,
\delta u[k-\tau_1]\delta u[k-\tau_2] \Big)^2
+ \lambda_1 \|D_1 h_{i,1}\|_2^2
+ \lambda_2 \|D_2 h_{i,2}\|_2^2
+ \alpha\,\|h_{i,2}\|_1,
\label{eq:sparse_volterra}
\end{equation}
where \(D_1,D_2\) encode smoothness priors over lags and \(\alpha\) promotes sparsity in the quadratic kernel to curb variance and enhance interpretability (Ljung, 1999). The resulting kernels map to frequency-domain GFRFs by 1D/2D discrete Fourier transforms, enabling direct comparison with spectral estimates.

Diagnostics and early-warning metrics. The frequency-resolved nonlinear distortion can be summarized by a harmonic distortion index for each output,
\begin{equation}
\mathrm{HDI}_i = \frac{\sum_{\omega\in\mathcal{K}_{\mathrm{NL}}} |Y_i(\omega)|^2 - \sum_{\omega\in\mathcal{K}_{\mathrm{NL}}} |\widehat{H}_{i,1}(\omega)U(\omega)|^2}{\sum_{\omega\in\mathcal{K}_{\mathrm{L}}} |\widehat{H}_{i,1}(\omega)U(\omega)|^2},
\label{eq:hdi}
\end{equation}
where \(\mathcal{K}_{\mathrm{L}}\) are the excited linear lines and \(\mathcal{K}_{\mathrm{NL}}\) the designed harmonic/intermodulation and detection lines (Pintelon and Schoukens, 2012). Growth in \(\mathrm{HDI}_i\) and systematic phase drift of \(\widehat{H}_{i,1}\) toward \(-\pi\) as baseline forcing increases provide natural, model-based early-warning indicators of emerging instabilities and regime shifts within the actively probed operating region; these complement passive variance/autocorrelation metrics and are actionable for closed-loop SAI governance (MacMartin et al., 2014; Robock et al., 2008).

Integration with the active-sensing protocol. In E2, we (i) estimate \(\widehat{H}_{i,1}\) and selected \(\widehat{H}_{i,2}\) from multi-sine probes superimposed on an SAI baseline representative of ARISE-SAI and CESM1(WACCM) configurations (Tilmes et al., 2018; Richter et al., 2022), (ii) validate predicted harmonics and intermodulation on held-out single-tone tests, and (iii) quantify fit via normalized RMSE, magnitude–phase coherence, \(\mathrm{HDI}_i\), and cross-frequency prediction error. The identified kernels furnish compact surrogate dynamics for robust controller synthesis (Section E3), while the distortion metrics and phase diagnostics underpin early-warning experiments (Section E4). By exploiting periodic, information-optimized excitation and the structure of Volterra/GFRFs, the approach recovers spectral and nonlinear features that passive observations or one-off impulses cannot resolve with comparable data efficiency (Pintelon and Schoukens, 2012; Ljung, 1999), and it does so within established SAI modeling protocols and ensembles (Kravitz et al., 2011; Tilmes et al., 2018; Richter et al., 2022).


% === AREA: Robust control techniques (H-infinity, MPC) for climate stabilization. ===

\subsection{Robust control synthesis informed by active spectroscopy}

Closed-loop management of SAI must deliver predictable global-mean temperature (GMST) outcomes while hedging uncertainty in regional hydrology, stratospheric chemistry, and internal variability. Previous studies have demonstrated the feasibility and necessity of feedback for solar climate intervention in idealized settings, while emphasizing the coupled human–climate dynamics that render naive open-loop strategies brittle \cite{macmartin2014dynamicsof}. Large ensemble experiments and community intercomparisons have also documented substantial variability and model spread in SAI responses \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}, reinforcing that robust control—explicitly accounting for model uncertainty and exogenous disturbances—is a principled requirement for any systematic SAI strategy. At the same time, governance concerns underscore the need to bound unintended side effects and avoid overconfident control actions \cite{robock200820reasons,keith2010researchon}.

Our active spectroscopy experiments (E1–E2) provide frequency-domain surrogates with quantified uncertainty: a nominal linear transfer function from SAI injection-rate perturbations to outputs of interest, local second-order Volterra characterizations of weak nonlinearities, and Koopman-regressed predictors suitable for receding-horizon optimization. Building on this foundation, we design robust controllers that (i) track GMST to a temperature target, (ii) constrain regional precipitation variability, and (iii) limit stratospheric aerosol optical depth (SAOD) excursions. We benchmark against continuous and naive pulsing baselines in E3.

\paragraph{Uncertain plant from active spectroscopy.}
Let the discrete-time, monthly-sampled, linear surrogate identified from E1–E2 be
\begin{equation}
\label{eq:ss}
\begin{aligned}
x_{k+1} &= A x_k + B u_k + E w_k, \\
y_k &= C x_k + D u_k + F w_k,
\end{aligned}
\end{equation}
where $u_k$ is the SAI injection-rate deviation about a baseline, $y_k$ stacks outputs (e.g., GMST, regional precipitation indices, SAOD), and $w_k$ represents exogenous variability (internal variability such as ENSO and unanticipated volcanic forcing, consistent with \cite{tilmes2018stratospheric,richter2022assessingresponses}). In the frequency domain, the identified nominal plant $G_0(z)$ is equipped with a multiplicative-uncertainty envelope derived from spectral-coherence bounds and Fisher-information-based confidence intervals obtained in E1:
\begin{equation}
\label{eq:uncertainty}
G(z) \in \mathcal{G} := \left\{ G_0(z)\big(I + W_{\Delta}(z)\,\Delta(z)\big) \;:\; \|\Delta\|_{\infty} \le 1 \right\}.
\end{equation}
Here $W_{\Delta}(z)$ is shaped from the identified Bode magnitude/phase uncertainties across monthly–interannual bands \cite{ljung1999system,pintelon2012system}.

\paragraph{Performance channels and weights.}
We adopt a mixed-sensitivity design that encodes control objectives via frequency-shaped weights inferred from spectroscopy:
\begin{equation}
\label{eq:perf}
\begin{aligned}
e_k &= r_k - y^{\mathrm{T}}_k, \\
z_k &= \begin{bmatrix}
W_S(z)\, e_k \\
W_P(z)\, y^{\mathrm{P}}_k \\
W_A(z)\, y^{\mathrm{SAOD}}_k \\
W_U(z)\, u_k
\end{bmatrix},
\end{aligned}
\end{equation}
where $y^{\mathrm{T}}$ is GMST, $y^{\mathrm{P}}$ collects regional precipitation indices, and $y^{\mathrm{SAOD}}$ is a SAOD metric. Weights $W_S$ emphasize low-frequency GMST tracking while tolerating fast transients; $W_P$ penalizes hydrological variability in bands where the identified gain is high or phase is near $-\pi$ (indicative of risk for oscillatory amplification); $W_A$ limits SAOD excursions; and $W_U$ regulates control effort and smoothness. Initial weight shapes are selected using the identified Bode and coherence from E2 and refined via an L-curve trade-off between performance and robustness \cite{pintelon2012system}.

\paragraph{H-infinity synthesis.}
We compute a stabilizing controller $K(z)$ that minimizes the worst-case induced $\mathcal{L}_2$ gain from disturbances to performance outputs over the uncertainty set \eqref{eq:uncertainty}:
\begin{equation}
\label{eq:hinf}
\begin{aligned}
\min_{K} \; \gamma
\quad \text{s.t.} \quad
\left\| T_{z w}(K,G) \right\|_{\infty} \le \gamma, \;\; \forall\, G \in \mathcal{G}.
\end{aligned}
\end{equation}
We use the standard mixed-sensitivity interconnection with weighted sensitivity $S=(I+GK)^{-1}$, complementary sensitivity $T=I-S$, and control sensitivity $KS$, incorporating $W_S$, $W_P$, $W_A$, and $W_U$. The multiplicative-uncertainty weight $W_{\Delta}$ is included as a robustness channel. This formulation directly links the spectral information content of the probes to control weights and uncertainty, closing the loop between identification and synthesis. By targeting worst-case performance, H-infinity counters the spread and variability reported in SAI ensembles and protocols \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}, and addresses governance-mandated caution about adverse side effects \cite{robock200820reasons}.

\paragraph{MPC with spectroscopy-informed predictors.}
To handle hard constraints and multivariate trade-offs, we complement H-infinity with a receding-horizon MPC using the predictor \eqref{eq:ss} (or a Koopman-regressed linear predictor trained on spectroscopy-augmented data):
\begin{equation}
\label{eq:mpc}
\begin{aligned}
\min_{\{u_{k+i|k}\}} \;
& \sum_{i=1}^{N_p} \Big( \| Q_e e_{k+i|k} \|_2^2 + \| Q_p y^{\mathrm{P}}_{k+i|k} \|_2^2 + \| Q_a y^{\mathrm{SAOD}}_{k+i|k} \|_2^2 \Big) \\
& + \sum_{i=0}^{N_c-1} \Big( \| R_u u_{k+i|k} \|_2^2 + \rho\, \| \Delta u_{k+i|k} \|_1 \Big) \\
\text{s.t.}\;\;
& x_{k+i+1|k} = A x_{k+i|k} + B u_{k+i|k} + E \hat{w}_{k+i|k}, \\
& y_{k+i|k} = C x_{k+i|k} + D u_{k+i|k} + F \hat{w}_{k+i|k}, \\
& y^{\mathrm{SAOD}}_{k+i|k} \le \overline{a} + \sigma_a s_{i}, \quad s_i \ge 0, \\
& y^{\mathrm{P}}_{k+i|k} \in \mathcal{Y}_P, \quad u_{\min} \le u_{k+i|k} \le u_{\max},
\end{aligned}
\end{equation}
with horizon lengths $N_p, N_c$, soft SAOD bounds $\overline{a}$ with slack $s_i$, regional precipitation admissible set $\mathcal{Y}_P$, and total-variation regularization on $\Delta u$ to enforce smooth actuation. Disturbance forecasts $\hat{w}$ combine seasonal climatology with stochastic draws calibrated to ensemble variability \cite{tilmes2018stratospheric,richter2022assessingresponses}. Tube-based or chance-constrained variants are used to guarantee robustness against the uncertainty in \eqref{eq:uncertainty}. This formulation operationalizes closed-loop control of SAI advocated in \cite{macmartin2014dynamicsof} while explicitly embedding stratospheric and hydrological constraints observed in protocol studies \cite{richter2022assessingresponses}.

\paragraph{Design workflow and integration with E3.}
E3 instantiates a three-step workflow:
\begin{enumerate}
\item Identification-to-uncertainty: Fit $G_0(z)$ and $W_{\Delta}(z)$ from E1–E2 frequency-domain estimates with leakage correction and coherence-based confidence \cite{pintelon2012system,ljung1999system}.
\item Controller synthesis: Solve \eqref{eq:hinf} to obtain a baseline robust controller $K(z)$; optionally, use $K(z)$ as a terminal controller and constraint-tightening certificate in \eqref{eq:mpc}.
\item Stress testing: Evaluate under ENSO-like stochasticity and an imposed volcanic aerosol disturbance, consistent with SAI ensemble practice \cite{tilmes2018stratospheric,richter2022assessingresponses}. Baselines include continuous injection and naive square-wave pulsing.
\end{enumerate}

\paragraph{Evaluation metrics.}
We quantify performance and robustness using experiment-level summary statistics:
\begin{equation}
\mathrm{RMSE}_{\mathrm{GMST}} = \sqrt{\frac{1}{N}\sum_{k=1}^{N} e_k^2}, 
\quad
\mathrm{TV}(u) = \sum_{k=1}^{N-1} |u_{k+1}-u_k|,
\end{equation}
\begin{equation}
\mathrm{CVR} = \frac{1}{N}\sum_{k=1}^{N} \mathbf{1}\{ y^{\mathrm{P}}_k \notin \mathcal{Y}_P \; \text{or} \; y^{\mathrm{SAOD}}_k > \overline{a} \},
\quad
\mathrm{WorstRegAnom} = \max_{k,R} |y^{\mathrm{P}}_{k}(R)|,
\end{equation}
and regret relative to an oracle with access to the true (simulator) dynamics:
\begin{equation}
\mathrm{Regret} = J(K) - J(K_{\mathrm{oracle}}), \quad
J(\cdot) \; \text{is the cumulative cost in} \; \eqref{eq:mpc}.
\end{equation}
Lower RMSE, CVR, and regret, together with bounded TV, indicate improved control with acceptable actuation smoothness.

\paragraph{Discussion and governance relevance.}
By leveraging information-optimized probes to tailor uncertainty sets and performance weights, the proposed H-infinity/MPC synthesis directly connects experimental identifiability to robust decision making \cite{ljung1999system,pintelon2012system}. This closes the loop envisioned by prior closed-loop studies \cite{macmartin2014dynamicsof} while embedding constraints and stressors documented in SAI ensemble protocols \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}. The framework is expressly designed for model-based evaluation and learning, addressing calls for careful research on solar climate intervention \cite{keith2010researchon} and for bounding unintended consequences \cite{robock200820reasons}.


% === AREA: Early warning signals for climate tipping points and instability. ===

\subsection{Active early-warning indicators from frequency-domain spectroscopy}

Early detection of adverse dynamical transitions is a prerequisite for risk-aware SAI governance and controller design. Passive early-warning signals (EWS) based on variance, autocorrelation, and spectral reddening provide generic indicators of critical slowing down but often suffer from low specificity and long lead times in high-variance geophysical data \citep{enhanced_5_20250812}. We posit that actively probing the Earth system with small-amplitude, information-optimized pulsed injections provides earlier and more decision-relevant EWS by directly tracking changes in the input–output dynamics from SAI rate to climate responses. Concretely, we exploit frequency-domain system identification \citep{pintelon2012system, ljung1999system, enhanced_9_20250812} to monitor (i) phase-lag drift and group-delay growth in the estimated frequency response and (ii) the rise of nonlinear harmonic and intermodulation content attributable to SAI. These indicators are computed in sliding windows under gradually increasing baseline forcing (E4), leveraging designed excitations whose information content is maximized subject to environmental constraints \citep{enhanced_6_20250812, enhanced_2_20250812}. This approach builds on the same active spectroscopy protocol used for identification (E1–E2) and integrates with robust control synthesis (E3) by expressing warnings in units directly tied to phase and gain margins \citep{macmartin2014dynamicsof}.

Let $u(t)$ denote the deviation of the SAI injection rate from a steady baseline and $y_k(t)$ one of several outputs (e.g., GMST, Sahel JJA precipitation, monsoon indices, stratospheric winds). Using multi-sine or PRBS inputs with lines $\mathcal{L}=\{\omega_\ell\}$ spanning monthly to interannual bands, we compute local (windowed) nonparametric frequency-response estimates from $u$ to $y_k$ via spectral regression with leakage correction \citep{pintelon2012system, enhanced_9_20250812}:
\begin{equation}
\widehat{G}_k(\omega; t) \;=\; \widehat{S}_{y_k u}(\omega; t)\,\big[\widehat{S}_{uu}(\omega; t)\big]^{-1}, \qquad \omega \in \mathcal{L},
\label{eq:frf}
\end{equation}
where $\widehat{S}_{y_k u}$ and $\widehat{S}_{uu}$ are cross- and auto-spectral density estimates computed in a sliding window centered at $t$. Because the estimates are formed by coherent averaging with respect to the designed input, they are robust to unrelated internal variability and exogenous disturbances such as ENSO or moderate volcanic events, provided the excitation is maintained and the window length exceeds the dominant internal decorrelation times \citep{pintelon2012system, ljung1999system}.

Phase-drift EWS. From \eqref{eq:frf}, we extract the unwrapped phase $\phi_k(\omega; t) = \operatorname{unwrap}(\arg \widehat{G}_k(\omega; t))$ and define phase drift relative to an early-window baseline $\phi_{k,0}(\omega)$:
\begin{equation}
\Delta \phi_k(\omega; t) \;=\; \phi_k(\omega; t) - \phi_{k,0}(\omega), \qquad 
\tau_{g,k}(\omega; t) \;=\; -\,\frac{\partial \phi_k(\omega; t)}{\partial \omega},
\label{eq:phase_groupdelay}
\end{equation}
where $\tau_{g,k}$ is the group delay. Approaching dynamical instabilities or strong internal mode coupling is expected to increase memory and effective delays, observable as systematic trends toward more negative phase and larger group delay at low frequencies (steeper low-frequency phase slope), even if output variance has not yet increased markedly \citep{enhanced_5_20250812}. We aggregate phase changes over a band $\mathcal{B}$ using a Fisher-information-weighted norm,
\begin{equation}
T^{\mathrm{phase}}_k(t) \;=\; \Bigg[\sum_{\omega \in \mathcal{B}} w_\phi(\omega)\, \big(\Delta \phi_k(\omega; t)\big)^2 \Bigg]^{1/2},
\qquad
w_\phi(\omega) \propto \big(\operatorname{Var}[\phi_k(\omega; t)]\big)^{-1},
\label{eq:phase_stat}
\end{equation}
with weights $w_\phi$ derived from spectral estimator variance or the local Fisher information matrix (FIM) of the identification problem \citep{enhanced_6_20250812, ljung1999system}. A consistent rise in $T^{\mathrm{phase}}_k(t)$ and/or $\tau_{g,k}$ across adjacent windows constitutes an active EWS of deteriorating phase margin in the injection–response channel.

Nonlinear-distortion EWS. To isolate SAI-attributable nonlinear growth, we use both second-order Volterra modeling and coherent higher-order spectra. A sparse second-order Volterra kernel $\widehat{H}_{2,k}(\omega_a,\omega_b; t)$ is estimated on polynomial–convolution features using elastic-net or orthogonal forward selection \citep{enhanced_12_20250812, enhanced_3_20250812}, yielding predicted output at harmonic and intermodulation lines $\mathcal{H}=\{2\omega_\ell,\, \omega_i\!\pm\!\omega_j\}$. In parallel, we compute the cross-bispectrum between output and input,
\begin{equation}
\widehat{B}_{y_k u u}(\omega_a,\omega_b; t) \;=\; \mathbb{E}\!\left[\, Y_k(\omega_a\!+\!\omega_b; t)\, U^\ast(\omega_a; t)\, U^\ast(\omega_b; t) \,\right],
\label{eq:bispec}
\end{equation}
whose magnitude is nonzero only if energy at $\omega_a\!+\!\omega_b$ in $y_k$ is coherently generated from the product of input lines at $\omega_a$ and $\omega_b$ \citep{pintelon2012system}. We define an active harmonic distortion index (HDI),
\begin{equation}
\mathrm{HDI}_k(t) \;=\; 
\frac{\displaystyle \sum_{(\omega_a,\omega_b)\in \mathcal{P}} \big|\widehat{B}_{y_k u u}(\omega_a,\omega_b; t)\big|^2}
     {\displaystyle \sum_{\omega \in \mathcal{L}} \big|\widehat{S}_{y_k u}(\omega; t)\big|^2},
\qquad \mathcal{P} = \{(\omega_a,\omega_b): \omega_a,\omega_b \in \mathcal{L}, \ \omega_a\!\le\!\omega_b\},
\label{eq:hdi}
\end{equation}
which increases as quadratic distortions grow relative to the linear response. Because both numerator and denominator are coherently referenced to the known input, $\mathrm{HDI}_k$ is insensitive to unrelated variability that does not phase-lock to the excitation.

Sequential change detection. We combine $\Delta \phi_k(\omega; t)$, $\tau_{g,k}$, and $\mathrm{HDI}_k(t)$ into a low-dimensional feature vector $\theta_k(t)$ and compute an information-weighted distance from the baseline,
\begin{equation}
D_k(t) \;=\; \big(\theta_k(t)-\theta_{k,0}\big)^\top \widehat{F}_k \, \big(\theta_k(t)-\theta_{k,0}\big),
\label{eq:fid}
\end{equation}
where $\widehat{F}_k$ is a block-diagonal approximation of the FIM obtained from the identification step (or from bootstrapped ensembles) \citep{enhanced_6_20250812, ljung1999system}. Under the null (no change), $D_k(t)$ is approximately $\chi^2$-distributed with degrees of freedom equal to $\dim(\theta_k)$, enabling thresholding with controlled false-alarm rates. We evaluate detection lead time (relative to known regime shifts or constraint violations in controlled experiments), area under the ROC curve (AUC), and false discovery rate against passive EWS computed from $y_k$ alone (variance, lag-1 autocorrelation) \citep{enhanced_5_20250812}.

Experimental design and practicality. The indicators above are computed within the E4 protocol: we gradually increase the baseline SAI rate (e.g., to offset increasing warming) while maintaining a small, information-optimized multi-sine or PRBS perturbation with RMS amplitude 0.05–0.5 TgS yr$^{-1}$ over lines between 0.02 and 2 cycles yr$^{-1}$ \citep{richter2022assessingresponses}. Phases and amplitudes are designed to maximize Fisher information subject to variance and ozone constraints \citep{enhanced_6_20250812}, leveraging prior knowledge from ARISE-SAI and related protocols \citep{richter2022assessingresponses, tilmes2018stratospheric, kravitz2011thegeoengineering}. Sliding windows of 5–10 years with 50–75% overlap balance estimator variance and nonstationarity. Because detection operates on coherent input–output structure, the minimal amplitude/duration required for a target lead time can be quantified via information growth curves (E6), providing practical bounds on experiment length and ensemble size under internal variability \citep{enhanced_2_20250812}.

Interpretation and integration with control. In control-relevant coordinates, a sustained increase of $T^{\mathrm{phase}}_k$ and $\tau_{g,k}$ indicates shrinking phase margin in the SAI actuation pathway for variable $y_k$, while rising $\mathrm{HDI}_k$ signals the onset of nonlinearities that invalidate linear MPC assumptions, both warranting controller retuning or gain reduction \citep{macmartin2014dynamicsof}. Because these indicators are tied to the identified input–output map rather than to autonomous variability, they provide actionable alarms for the closed-loop human–climate system that are more specific to SAI operations than passive EWS. They also furnish quantitative uncertainty via spectral estimator theory and FIM, facilitating governance thresholds and risk communication \citep{keith2010researchon, robock200820reasons}.

Validation and cross-model robustness. We will quantify lead-time gains and robustness of active EWS against passive baselines across the model tiers in E5, including an idealized aquaplanet/EMIC and a coarser-resolution ESM with stratospheric chemistry \citep{tilmes2018stratospheric, richter2022assessingresponses}. Cross-model transfer will test whether early changes in phase and HDI are conserved properties of the injection–response channel, supporting generalization beyond any single model configuration \citep{kravitz2011thegeoengineering}. By design, all computations reuse the identification machinery and data streams already required for controller synthesis (E2–E3), adding minimal overhead while furnishing earlier and more interpretable warnings of instability.

In summary, active spectroscopy enables early-warning indicators grounded in phase and harmonic structure of the SAI actuation pathway. These indicators are theoretically motivated, information-optimal, and operationally meaningful, and they can outperform passive metrics in both lead time and specificity within controlled Earth system experiments \citep{pintelon2012system, ljung1999system, enhanced_5_20250812, enhanced_9_20250812}.


% === AREA: Fisher information maximization for experimental design in complex systems. ===

\subsection{Information-optimal active probes via Fisher information}
\label{sec:fisher_design}

We cast the design of small-amplitude pulsed SAI experiments as an optimal input design problem: choose a spectrally sparse perturbation that maximizes the information content about the climate system’s frequency response and low-order nonlinearities, subject to safety and feasibility constraints. This leverages a mature body of system identification theory on Fisher information and frequency-domain experiment design \citep{ljung1999system,pintelon2012system}, applied here to stratospheric-aerosol-forced Earth system models (ESMs) within established SAI protocols \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} and the broader context of control-oriented SAI studies \citep{macmartin2014dynamicsof}.

We consider a baseline injection rate $\bar{u}$ (e.g., 5 TgS yr$^{-1}$) with a zero-mean probe $u_p(t)$ superimposed,
\begin{equation}
u(t) = \bar{u} + u_p(t), 
\qquad 
u_p(t) = \sum_{\ell=1}^{L} A_\ell \cos(\omega_\ell t + \phi_\ell),
\label{eq:probe_def}
\end{equation}
where $\{\omega_\ell\}$ span monthly to interannual bands (0.02–2 cycles yr$^{-1}$), and amplitudes are kept small (0.05–0.5 TgS yr$^{-1}$ RMS) to remain in a locally linear regime and within environmental limits. Denote by $y(t)\in\mathbb{R}^{p}$ the outputs of interest (e.g., GMST, regional precipitation indices, stratospheric winds, SAOD). Under small $u_p$ and over windows where the response is approximately time-invariant, a linear-plus-weakly-nonlinear representation suffices for identification and control design,
\begin{equation}
y(t) \approx (g_1 * u_p)(t) \;+\; \sum_{i\le j} (g_{2,ij} * [u_p(\cdot - \tau_i) u_p(\cdot - \tau_j)])(t) \;+\; \varepsilon(t),
\label{eq:volterra2}
\end{equation}
with $g_1$ the first-order kernel (frequency response) and $g_2$ the second-order Volterra kernels capturing harmonic and intermodulation effects; $\varepsilon$ represents colored internal variability and model noise \citep{pintelon2012system}. Our identification goals in Experiments E1–E2 are the parameters $\theta$ of a compact frequency-response surrogate $G(\mathrm{e}^{\mathrm{i}\omega};\theta)$ and the dominant coefficients of $g_2$ needed for nonlinear diagnostics and prediction.

For frequency-domain identification with multi-sine inputs, the cross-spectrum at excited lines $\omega_\ell$ satisfies
\begin{equation}
\Phi_{y u}(\omega_\ell) \approx G(\mathrm{e}^{\mathrm{i}\omega_\ell};\theta)\,\Phi_{uu}(\omega_\ell),
\qquad 
\Phi_{uu}(\omega_\ell) = \tfrac{1}{2} A_\ell^2,
\end{equation}
and the (local) Fisher information matrix (FIM) for $\theta$ is, up to a proportionality with the record length $T$,
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \sum_{\ell=1}^{L} \; \sum_{k=1}^{p}
\frac{A_\ell^2}{2\,\Phi_{\varepsilon_k\varepsilon_k}(\omega_\ell)} \;
s_{k\ell}(\theta)\,s_{k\ell}(\theta)^\top,
\qquad
s_{k\ell}(\theta) \equiv \frac{\partial G_k(\mathrm{e}^{\mathrm{i}\omega_\ell};\theta)}{\partial \theta},
\label{eq:fim}
\end{equation}
where $G_k$ and $\Phi_{\varepsilon_k\varepsilon_k}$ denote, respectively, the $k$-th output channel’s response and noise spectrum \citep{ljung1999system,pintelon2012system}. Equation \eqref{eq:fim} makes explicit the classical trade-offs: excite frequencies where (i) parametric sensitivity is high, (ii) the climate background variability is comparatively low, and (iii) the control-relevant dynamics reside. The noise spectra can be estimated from control or baseline-forcing ensembles, and leakage-corrected spectral regression can be used to obtain unbiased line estimates under colored variability and finite windows \citep{pintelon2012system}.

We pose input design as an allocation of spectral power $w_\ell \equiv \tfrac{1}{2}A_\ell^2$ across candidate lines $\{\omega_\ell\}$, with decision vector $w\in\mathbb{R}^L_{\ge 0}$. A D-optimal criterion maximizes the differential entropy (volume) of the asymptotic parameter posterior by maximizing $\log\det \mathcal{I}$ \citep{ljung1999system}:
\begin{align}
\min_{w\ge 0,\;\phi} \;\; & -\log\det\Big(\sum_{\ell=1}^{L} w_\ell \sum_{k=1}^{p} \frac{s_{k\ell} s_{k\ell}^\top}{\Phi_{\varepsilon_k\varepsilon_k}(\omega_\ell)} \Big) 
\label{eq:dopt}
\\
\text{s.t.} \;\; & \mathbf{1}^\top w \le P_{\max}, 
\quad 0 \le w_\ell \le \bar{w}_\ell, 
\quad \mathrm{CF}(\phi,w) \le \mathrm{CF}_{\max}, 
\quad \mathcal{C}_{\mathrm{env}}(\bar{u},w,\phi)\le 0.
\nonumber
\end{align}
Here $P_{\max}$ encodes the RMS bound on $u_p$, $\bar{w}_\ell$ can exclude bands with unacceptable environmental risk or poor observability (e.g., strong seasonal aliases), $\mathrm{CF}$ is a crest-factor constraint managed by appropriate phase selection (e.g., Schroeder phases) to keep peak injection within operational limits \citep{pintelon2012system}, and $\mathcal{C}_{\mathrm{env}}$ collects model-specific safety constraints (e.g., bounds on SAOD excursions and ozone exposure). Alternative criteria (A- or E-optimal) can be substituted where trace- or worst-direction uncertainty is more relevant to control synthesis \citep{ljung1999system}. When multiple surrogate structures are plausible, a Bayesian design averages the FIM over a prior on $\theta$ (and model class), prioritizing robustness to structural uncertainty.

The same design logic extends to weakly nonlinear characterization. For second-order Volterra terms, intermodulation products appear at $\omega_i\pm\omega_j$ and $2\omega_i$, suggesting two-tone subdesigns that isolate quadratic kernels with minimal interference \citep{pintelon2012system}. A block-diagonal FIM augmented with a sparse parameterization of $g_2$ supports joint selection of primary lines for $g_1$ and diagnostic pairs for $g_2$, with regularization in estimation (lasso/elastic net) to enforce parsimony during E2. Persistent excitation requirements are satisfied by ensuring sufficient line density per band and by avoiding systematic gaps at dynamically important time scales (e.g., ENSO and monsoon bands), while keeping amplitudes small enough to respect the “minimally invasive” objective and ethical constraints \citep{robock200820reasons,keith2010researchon}.

Practically, we instantiate \eqref{eq:dopt} as follows.
(i) Choose a dense candidate grid $\{\omega_\ell\}$ over 0.02–2 yr$^{-1}$ with exclusions around the annual cycle harmonics to reduce leakage, and include selected sum/difference pairs for nonlinear diagnostics.
(ii) Estimate $\Phi_{\varepsilon\varepsilon}$ from control/baseline ensembles (or long pre-experiments) and compute local sensitivities $s_{k\ell}$ from a rational surrogate $G(\cdot;\theta)$ fitted on pilot probes or priors informed by past ESM studies \citep{tilmes2018stratospheric,richter2022assessingresponses}.
(iii) Solve \eqref{eq:dopt} to allocate $w_\ell$; select phases $\phi_\ell$ to minimize crest factor and reduce transient leakage \citep{pintelon2012system}.
(iv) Run the experiment; estimate line FRFs with leakage-corrected spectral regression and multi-taper averaging; update $\theta$ and its covariance.
(v) Iterate (sequential design): append lines or reweight $w_\ell$ where a posteriori uncertainty remains large or control-relevant bands are under-resolved. Because Fisher information grows approximately linearly with experiment length $T$ under stationarity, this schedule allows transparent trade-offs among amplitude, duration, and ensemble replication in E6.

Information-optimal probes directly support downstream tasks. First, they yield tight confidence sets on Bode gain/phase needed by H-infinity and MPC synthesis, improving closed-loop robustness margins and reducing regret relative to controllers tuned on ad hoc or passively inferred models \citep{macmartin2014dynamicsof}. Second, by reserving power at sentinel bands, the same probes amplify the signal for early-warning diagnostics based on phase drift toward $-\pi$ and growth of harmonic distortion (E4), while maintaining low environmental footprint compared to large-amplitude schedule experiments \citep{robock200820reasons}. Finally, the framework is portable across model tiers (E5): line sets and power allocations designed on an intermediate-complexity model can be re-used in a coarser-resolution ESM with interactive chemistry \citep{tilmes2018stratospheric,richter2022assessingresponses}, with Bayesian design hedging against cross-model discrepancies.

In summary, Fisher-information-driven design provides the quantitative backbone for “active spectroscopy” of the climate system: it determines where, how strongly, and for how long to pulse SAI in order to most efficiently learn the frequency-dependent pathways by which aerosols modulate temperature, hydrology, and circulation—thereby enabling compact, control-ready surrogates and sensitive early-warning indicators \citep{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.


% === AREA: Cross-model validation techniques for climate models and surrogate models. ===

\subsection{Cross-model validation and transferability of identified dynamics and controllers}
A central requirement for actionable active spectroscopy is that identified frequency-domain dynamics and the controllers they enable generalize across Earth system models (ESMs) with differing physics, resolutions, and internal variability. Multi-model intercomparison has repeatedly shown that SAI responses are model-dependent (e.g., different stratospheric transport and chemistry, background variability, and hydrological sensitivities) \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Consequently, validation limited to a single model risks optimistic bias in both the surrogate dynamics and the achieved closed-loop performance \citep{macmartin2014dynamicsof}. We formalize a cross-model validation protocol that embeds our active probes and spectral estimators within a two-tier workflow (idealized aquaplanet or EMIC; coarser-resolution ESM with interactive stratospheric aerosols), aligned with standard practice in system identification and robust control \citep{ljung1999system,pintelon2012system}.

\paragraph{Objects of transfer.}
Let $G_m(f)$ denote the complex, scalar frequency response from injected sulfur mass flux $u$ to a target output $y$ (e.g., GMST, a regional precipitation index) identified in model $m$ through multi-sine, chirp, or PRBS excitation with spectral regression and leakage correction \citep{pintelon2012system}. Let $H^{(2)}_m(f_1,f_2)$ denote the associated second-order Volterra kernel in the generalized frequency domain capturing harmonic and intermodulation structure, estimated via sparsity-promoting regression. Let $K_m$ denote a controller (H-infinity or MPC) synthesized on the identified surrogate for $m$ with constraints on SAOD and regional hydrology \citep{macmartin2014dynamicsof}. We evaluate transferability of each object to a distinct model $m'$.

\paragraph{Frequency-domain transfer metrics.}
We quantify the cross-model discrepancy over a control-relevant band $\mathcal{B}$ (monthly to interannual) with band weights $w(f)\ge 0$ (default $w\equiv 1$ or Fisher-information weights from the probe design):
\begin{equation}
E_{m\rightarrow m'}^{\mathrm{FRF}}
\;=\;
\frac{\left(\int_{\mathcal{B}} w(f)\,\big|G_m(f)-G_{m'}(f)\big|^2\,df\right)^{1/2}}
{\left(\int_{\mathcal{B}} w(f)\,\big|G_{m'}(f)\big|^2\,df\right)^{1/2}}.
\label{eq:frf_gap}
\end{equation}
We additionally report a phase-robust discrepancy
\begin{equation}
\Delta\phi_{m\rightarrow m'} \;=\; \operatorname*{ess\,sup}_{f\in\mathcal{B}}\;
\big|\operatorname{wrap}\big(\angle G_m(f)-\angle G_{m'}(f)\big)\big|,
\end{equation}
and the magnitude-only normalized error, along with the multiple-coherence $\gamma^2(f)$ between $u$ and $y$ in $m'$ when driven by the probe designed for $m$ \citep{pintelon2012system}. For nonlinear distortions, we define a kernel mismatch
\begin{equation}
E_{m\rightarrow m'}^{(2)}
\;=\;
\frac{\left(\iint_{\mathcal{B}\times\mathcal{B}} w(f_1)w(f_2)\,\big|H^{(2)}_m(f_1,f_2)-H^{(2)}_{m'}(f_1,f_2)\big|^2\,df_1\,df_2\right)^{1/2}}
{\left(\iint_{\mathcal{B}\times\mathcal{B}} w(f_1)w(f_2)\,\big|H^{(2)}_{m'}(f_1,f_2)\big|^2\,df_1\,df_2\right)^{1/2}}.
\label{eq:volterra_gap}
\end{equation}
All spectral quantities are computed with multitaper or Welch estimators, with leakage correction and finite-sample confidence intervals estimated via block bootstrap over years and ensemble members \citep{pintelon2012system}.

\paragraph{Controller transfer and robust margins.}
We measure the cross-model generalization gap of a controller designed on $m$ when deployed in $m'$:
\begin{equation}
\mathcal{G}(K_m;\,m\!\rightarrow\! m') \;=\; J(K_m;\,m') - J(K_m;\,m),
\end{equation}
where $J$ aggregates the closed-loop tracking RMSE for GMST, regional constraint violation rate, and actuation total-variation norm over prescribed scenarios (internal variability, ENSO-like forcing, and an exogenous volcanic eruption) \citep{macmartin2014dynamicsof}. We also report classical robustness margins: worst-case closed-loop $H_\infty$ norm to disturbance and model-uncertainty channels, and gain/phase margins computed on the identified FRFs with their confidence sets \citep{ljung1999system,pintelon2012system}. This addresses concerns about unintended regional impacts and fragility under uncertainty, which are central in SAI governance \citep{robock200820reasons,keith2010researchon}.

\paragraph{Domain adaptation with information-optimal probes.}
When $E_{m\rightarrow m'}^{\mathrm{FRF}}$ or $E_{m\rightarrow m'}^{(2)}$ exceeds tolerable thresholds, we perform a lightweight adaptation in $m'$ using a short, small-amplitude probe designed to maximize Fisher information over the most discrepant bands (subject to SAOD and ozone constraints) \citep{ljung1999system}. We fit a smooth, stable discrepancy filter $W(f;\theta)$ to map $G_m$ onto $G_{m'}$:
\begin{equation}
\theta^\star \;=\; \arg\min_{\theta}\; \sum_{f\in\mathcal{B}} \alpha(f)\,\big|G_{m'}(f)-W(f;\theta)\,G_m(f)\big|^2 \;+\; \lambda\,\|L\theta\|_2^2,
\label{eq:adapt}
\end{equation}
where $\alpha(f)$ are Fisher-derived weights, $L$ enforces spectral smoothness (e.g., second-difference), and $\lambda$ is tuned via an L-curve criterion \citep{pintelon2012system}. The adapted controller $\tilde K_{m\rightarrow m'}$ is then synthesized on the corrected surrogate $W(\cdot;\theta^\star)G_m$ and re-evaluated in $m'$.

\paragraph{Protocol and reporting.}
We implement a leave-one-model-out protocol across the two tiers:
(i) identify $\{G_m,H^{(2)}_m\}$ and synthesize $K_m$ in model $m$ using E1–E3;
(ii) compute spectral and nonlinear transfer metrics in $m'$ under the same probe schedules (E2);
(iii) deploy $K_m$ and assess $\mathcal{G}(K_m;\,m\!\rightarrow\! m')$ under the E3 scenarios; and
(iv) optionally adapt via \eqref{eq:adapt} with a budgeted additional experiment in $m'$ and reassess. We repeat the cycle with $m$ and $m'$ swapped, and summarize with:
- cross-model generalization errors $E_{m\rightarrow m'}^{\mathrm{FRF}}$, $\Delta\phi_{m\rightarrow m'}$, $E_{m\rightarrow m'}^{(2)}$;
- controller gaps $\mathcal{G}(K_m;\,m\!\rightarrow\! m')$ and robustness margins;
- early-warning transferability: correlation and lead-time differences of phase-drift and harmonic-distortion indicators between models during controlled ramps (E4).

\paragraph{Why this matters for SAI.}
Intercomparison efforts such as GeoMIP \citep{kravitz2011thegeoengineering} and large-ensemble studies with interactive stratospheric chemistry \citep{tilmes2018stratospheric,richter2022assessingresponses} demonstrate that model spread is substantial in both global means and regional hydrology under SAI. Validating spectral surrogates and closed-loop strategies across models is thus essential to avoid brittle conclusions and to provide uncertainty-aware guidance for governance \citep{keith2010researchon,robock200820reasons}. Our frequency-domain metrics directly interrogate where models agree or disagree in the bands most relevant for control, and the information-optimal adaptation step ensures that minimal additional experimentation suffices to recalibrate surrogates when transferring across tiers. By structuring validation in the spectral and Volterra domains \citep{ljung1999system,pintelon2012system}, the framework yields transparent, quantitative robustness guarantees while retaining the data-efficiency advantages of active spectroscopy.


% === AREA: Uncertainty quantification methods in climate modeling and control. ===

\subsection{Uncertainty quantification and robust design}

Active spectroscopy must be paired with explicit uncertainty quantification (UQ) across identification, forecasting, and control to be decision-relevant in the presence of internal variability, structural model spread, and operational constraints on stratospheric aerosol injection (SAI) \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering,macmartin2014dynamicsof}. We formalize the UQ layer of our framework so that (i) experiment design maximizes information under environmental limits, (ii) identified frequency responses and nonlinear kernels carry calibrated confidence sets, and (iii) controllers enforce robust stability and performance to model error. The approach leverages classical system identification and frequency-domain statistics \cite{ljung1999system,pintelon2012system} while reflecting SAI-specific uncertainties highlighted by prior Earth system ensembles and protocols \cite{tilmes2018stratospheric,richter2022assessingresponses}.

\paragraph{Uncertainty sources and working model.}
We decompose uncertainty into: (a) internal variability and unresolved processes entering as colored disturbances, (b) sensing noise in diagnostics derived from model output, (c) actuation uncertainty in mapping commanded injection to stratospheric aerosol optical depth (SAOD), and (d) structural error from low-order surrogate representations. For small-amplitude probes, we model the dominant pathways in the frequency domain as
\begin{equation}
Y(\omega) \;=\; G(\omega;\,\theta)\,U(\omega) \;+\; E(\omega),\quad \mathbb{E}[E(\omega)]=0,\;\; S_{EE}(\omega)\;\text{stationary},
\label{eq:lti-freq}
\end{equation}
with extensions to weakly nonlinear responses via second-order Volterra terms in Section~E2. The SISO form in \eqref{eq:lti-freq} can be stacked to multi-input multi-output by frequency-wise block-diagonalization \cite{pintelon2012system}.

\paragraph{Information-optimal probe design.}
Given a parametric representation of $G(\omega;\theta)$ and a set $\Omega$ of excited Fourier lines (multisine/PRBS/chirp), the (approximate) Fisher information matrix for $P$ averaged periods is \cite{pintelon2012system,ljung1999system}
\begin{equation}
\mathcal{I}(\theta) \;\approx\; 2P \sum_{\omega\in\Omega} \frac{|U(\omega)|^2}{S_{EE}(\omega)}\,
\Big(\partial_\theta G(\omega;\theta)\Big)^{\!H}\Big(\partial_\theta G(\omega;\theta)\Big).
\label{eq:fim}
\end{equation}
We choose amplitudes/phases to maximize a design criterion, e.g., D-optimality $\max \det \mathcal{I}(\theta)$ or A-optimality $\min \operatorname{tr}\big(W\,\mathcal{I}(\theta)^{-1}\big)$, subject to environmental and operational constraints (variance in key outputs, SAOD bounds, ozone-related limits) motivated by SAI protocols \cite{richter2022assessingresponses}:
\begin{equation}
\begin{aligned}
&\max_{\{U(\omega)\}} \;\; \Phi\big(\mathcal{I}(\theta)\big)\\
&\text{s.t.}\;\; \sum_{\omega\in\Omega} |U(\omega)|^2 \leq P_u,\;\; \| \mathcal{F}^{-1}\{U\}\|_\infty \leq U_{\max},\;\; \operatorname{Var}[Z] \leq \sigma_Z^2,
\end{aligned}
\label{eq:input-design}
\end{equation}
where $Z$ collects safeguarded diagnostics (e.g., regional precipitation variance) and $P_u,U_{\max}$ encode actuation limits. Equation~\eqref{eq:fim} makes explicit the central trade-off explored in E6: information grows linearly in repetitions $P$ and with the per-line SNR $|U(\omega)|^2/S_{EE}(\omega)$, guiding minimal probe amplitude, duration, and ensemble size.

\paragraph{Spectral estimators and confidence sets.}
Nonparametric frequency response estimates $\widehat{G}(\omega)$ are obtained by spectral regression with leakage correction \cite{pintelon2012system}. For periodic multisines with $P$ averages, the variance at an excited line obeys the classical relation \cite{pintelon2012system}
\begin{equation}
\operatorname{Var}\big[\widehat{G}(\omega)\big] \;\approx\; \frac{S_{EE}(\omega)}{P\,|U(\omega)|^2},\qquad
\gamma^2(\omega) \;=\; \frac{|S_{YU}(\omega)|^2}{S_{YY}(\omega)\,S_{UU}(\omega)} \;=\; \frac{\mathrm{SNR}(\omega)}{1+\mathrm{SNR}(\omega)},
\label{eq:frf-variance}
\end{equation}
where $\gamma^2$ is the magnitude-squared coherence, providing a diagnostic of identifiability for each band. Parametric fits $\widehat{\theta}$ minimize a weighted least-squares criterion,
\begin{equation}
\widehat{\theta} \;=\; \arg\min_{\theta}\;\sum_{\omega\in\Omega} w(\omega)\,\big|\widehat{G}(\omega)-G(\omega;\theta)\big|^2,\quad
w(\omega)\propto \frac{|U(\omega)|^2}{S_{EE}(\omega)},
\label{eq:wls}
\end{equation}
with asymptotic covariance $\operatorname{Cov}[\widehat{\theta}]\approx \mathcal{I}(\widehat{\theta})^{-1}$ from \eqref{eq:fim} \cite{ljung1999system}. Confidence ellipsoids follow as
\begin{equation}
\mathcal{C}_{1-\alpha} \;=\; \Big\{\theta:\; (\theta-\widehat{\theta})^\top \mathcal{I}(\widehat{\theta})\,(\theta-\widehat{\theta}) \le \chi^2_{p,1-\alpha}\Big\}.
\label{eq:conf-ellipsoid}
\end{equation}
For weak nonlinearities captured by second-order Volterra kernels (E2), we adopt sparsity-promoting regression on polynomial-convolution features with heteroscedastic weighting $w(\omega)$; uncertainty is quantified via a Gauss–Newton (sandwich) approximation using residual periodograms \cite{ljung1999system,pintelon2012system}. Throughout, we report per-band coherence, bias/leakage diagnostics, and parametric confidence sets, consistent with best practice in frequency-domain identification \cite{pintelon2012system}.

\paragraph{Propagation to control and robustness margins.}
Closed-loop regulation of GMST and constraints on regional hydrology must remain reliable under identification error and structural spread across Earth system models (ESMs) \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,macmartin2014dynamicsof}. We represent multiplicative plant uncertainty around the identified response as
\begin{equation}
G(\omega) \;=\; \widehat{G}(\omega)\,\big(1 + W_m(\omega)\,\Delta(\omega)\big),\qquad \|\Delta\|_\infty \le 1,
\label{eq:multiplicative-uncertainty}
\end{equation}
where $W_m(\omega)$ envelopes the estimation error implied by \eqref{eq:frf-variance}–\eqref{eq:conf-ellipsoid} and cross-model spread from ARISE-SAI/GeoMIP-style ensembles \cite{richter2022assessingresponses,kravitz2011thegeoengineering}. SISO robust stability of a controller $K$ is certified if
\begin{equation}
\sup_{\omega}\;\big|W_m(\omega)\,T(\omega)\big| \;<\; 1,\qquad T(\omega)=\frac{\widehat{G}(\omega)K(\omega)}{1+\widehat{G}(\omega)K(\omega)},
\label{eq:rs}
\end{equation}
and robust performance is enforced by shaping $S(\omega)=(1+\widehat{G}K)^{-1}$ and $T(\omega)$ with weights $(W_S,W_T,W_U)$ in an $\mathcal{H}_\infty$ synthesis to bound tracking error, actuator effort, and SAOD excursions (E3). In predictive (MPC) formulations, we embed identification uncertainty via ellipsoidal sets $\mathcal{C}_{1-\alpha}$ from \eqref{eq:conf-ellipsoid} and enforce chance constraints on safeguarded outputs $z_k$,
\begin{equation}
\Pr\{\,C z_k \le d\,\} \;\ge\; 1-\alpha,\quad \forall k,
\label{eq:chance}
\end{equation}
using conservative tube or affine disturbance-feedback approximations informed by the estimated disturbance spectra $S_{EE}$ \cite{ljung1999system,macmartin2014dynamicsof}. Benchmarking includes regret versus an oracle controller that knows the true $G$, constraint-violation rates, and robust stability margins, aligning with concerns about unmodeled risks in geoengineering governance \cite{robock200820reasons,keith2010researchon}.

\paragraph{Cross-model robustness and practicality bounds.}
To address structural uncertainty, we compute $W_m(\omega)$ as the tightest frequency-wise envelope covering: (i) statistical FRF confidence bands from a given ESM under our probes and (ii) inter-model spread across an ensemble (e.g., CESM1(WACCM) large ensembles, ARISE-SAI realizations) \cite{tilmes2018stratospheric,richter2022assessingresponses}. Controllers are then synthesized against this aggregated uncertainty set and tested for cross-model transfer (E5). Finally, E6 quantifies practicality: with $K$ excited lines and $P$ averages, the information budget scales as
\begin{equation}
\operatorname{tr}\,\mathcal{I}(\theta) \;\propto\; P\,\sum_{\omega\in\Omega}\frac{|U(\omega)|^2}{S_{EE}(\omega)},
\label{eq:info-scaling}
\end{equation}
so that minimal amplitude-duration-ensemble combinations achieving target estimation error can be computed directly from \eqref{eq:fim} under the SAI-specific constraints in \eqref{eq:input-design}. This quantifies, a priori, the cost of identifiability in the presence of internal variability and provides transparent uncertainty bounds for control design and early-warning evaluation \cite{tilmes2018stratospheric,richter2022assessingresponses,macmartin2014dynamicsof}.


% === AREA: Spectral regression techniques for climate data analysis and system identification. ===

\subsection{Spectral regression for information-optimized active spectroscopy}

We estimate the climate system’s frequency-dependent response to small, designed SAI perturbations using frequency-domain system identification, a mature methodology that delivers direct Bode gain/phase with tight confidence bounds under colored disturbances \cite{pintelon2012system,ljung1999system}. In contrast to time-domain regressions on aggregated pulses, spectral regression exploits probe signals whose energy is concentrated on a prescribed line set, enabling leakage-controlled, high-SNR estimates and explicit separation of linear response from nonlinear distortions. Embedding these probes in Earth system models (ESMs) aligns with existing SAI experimental protocols and infrastructure \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} while supporting the closed-loop control perspective on geoengineering \cite{macmartin2014dynamicsof} and risk-aware experimentation \cite{keith2010researchon,robock200820reasons}.

We model the response of a scalar climate diagnostic (e.g., GMST anomaly) to an SAI injection-rate perturbation as
\begin{equation}
y(t) \;=\; (G \star u)(t) \;+\; v(t) \;+\; \eta(t),
\label{eq:lti}
\end{equation}
where $G$ is the (unknown) linear time-invariant impulse response around the operating point, $v$ is colored internal variability, and $\eta$ collects weak nonlinear distortions induced by the probe. We excite the system with a small-amplitude, information-optimized multisine or PRBS superimposed on a steady SAI baseline (E1). Let $\Omega$ denote the set of excited angular frequencies, chosen to span monthly-to-interannual bands. After detrending and deseasonalization, we segment the simulation into $M$ periods synchronized to the probe to suppress leakage \cite{pintelon2012system}. Denote discrete Fourier transforms by $U_m(\omega)$ and $Y_m(\omega)$ for segment $m=1,\dots,M$.

A weighted spectral regression estimates the frequency response function (FRF) $G(\omega)$ by solving
\begin{equation}
\min_{G(\omega)} \; \sum_{\omega \in \Omega} \big\| W(\omega)\,\big(\overline{Y}(\omega) - G(\omega)\,\overline{U}(\omega)\big)\big\|_2^2 \;+\; \lambda\,\|D G\|_2^2,
\label{eq:wsr}
\end{equation}
where $\overline{U}(\omega)=\frac{1}{M}\sum_m U_m(\omega)$ and $\overline{Y}(\omega)=\frac{1}{M}\sum_m Y_m(\omega)$, $W(\omega)$ weights by the inverse noise spectrum (estimated from unexcited lines or control segments), $D$ is a discrete derivative promoting smoothness across adjacent frequencies, and $\lambda$ is selected by an L-curve bias–variance trade-off (E1). For a single-input single-output (SISO) channel without input measurement noise, the closed-form (H$_1$) estimator \cite{pintelon2012system} reads
\begin{equation}
\widehat{G}(\omega) \;=\; \frac{S_{yu}(\omega)}{S_{uu}(\omega)}, \quad
S_{yu}(\omega) = \frac{1}{M}\sum_{m=1}^M Y_m(\omega)\,U_m^*(\omega), \;\;
S_{uu}(\omega)=\frac{1}{M}\sum_{m=1}^M |U_m(\omega)|^2,
\label{eq:frf}
\end{equation}
with approximate uncertainty governed by the magnitude-squared coherence
\begin{equation}
\gamma^2(\omega) \;=\; \frac{|S_{yu}(\omega)|^2}{S_{yy}(\omega)\,S_{uu}(\omega)}, \qquad
\frac{\mathrm{var}\big(|\widehat{G}|\big)}{|\widehat{G}|^2} \approx \frac{1-\gamma^2}{M\,\gamma^2}, \quad
\mathrm{var}\big(\angle \widehat{G}\big) \approx \frac{1-\gamma^2}{2M\,\gamma^2}.
\label{eq:coherence}
\end{equation}
For multi-output diagnostics (e.g., GMST, Sahel JJA precipitation, QBO indices), we estimate a matrix FRF via $ \widehat{G}(\omega)=S_{yu}(\omega)\,S_{uu}^{-1}(\omega)$, with $S_{yu}(\omega)$ the cross-spectral matrix and regularization as in \eqref{eq:wsr} to stabilize near-collinear inputs \cite{pintelon2012system}. Colored internal variability motivates weighting by $W(\omega)$ derived from Box–Jenkins noise models fitted on control runs \cite{ljung1999system}.

Nonlinear distortion is quantified in the frequency domain by strategically leaving “detection lines” unexcited in the multisine; energy observed at these lines estimates the combined noise-plus-nonlinearity floor, while odd/even line patterns separate odd- and even-order nonlinearities \cite{pintelon2012system}. We report a harmonic distortion index (HDI) as
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega \in \mathcal{D}} S_{yy}(\omega)}{\sum_{\omega \in \Omega} S_{yy}(\omega)},
\label{eq:hdi}
\end{equation}
and, when needed, fit weak quadratic Volterra terms to capture cross-frequency coupling (E2). In the frequency domain, a second-order Volterra correction satisfies
\begin{equation}
Y(\omega) \;\approx\; G(\omega)\,U(\omega) \;+\; \sum_{\omega_1+\omega_2=\omega} H_2(\omega_1,\omega_2)\,U(\omega_1)\,U(\omega_2),
\label{eq:volterra}
\end{equation}
estimated sparsely over admissible pairs $(\omega_1,\omega_2)$ selected by the probe, with $\ell_1/\ell_2$ regularization to prevent overfitting under limited averages \cite{ljung1999system}.

Probe design follows optimal input principles \cite{ljung1999system,pintelon2012system}: place tones on DFT lines to eliminate leakage; randomize phases to control crest factor; and allocate amplitudes $a(\omega)$ by maximizing a Fisher-information criterion subject to environmental and operational constraints (E1,E6),
\begin{align}
\max_{\{a(\omega),\phi(\omega)\}} \quad & \Phi\!\big(I(\theta)\big) \\
\text{s.t.} \quad & \sum_{\omega\in\Omega} a^2(\omega) \leq A_{\mathrm{RMS}}^2, \quad \mathrm{CF} \leq \mathrm{CF}_{\max}, \quad \mathrm{SAOD},\;\mathrm{ozone}\;\text{bounds}, \nonumber
\label{eq:oid}
\end{align}
where $\theta$ parameterizes a smooth FRF (or low-order rational surrogate), $I(\theta)=\sum_{\omega\in\Omega} \left(\partial_\theta G(\omega)\right)^\top S_{uu}(\omega)\,S_{vv}^{-1}(\omega)\,\partial_\theta G(\omega)$ approximates the Fisher Information Matrix under output-error noise $v$, and $\Phi$ is, e.g., $\log\det$ or trace. This design equalizes information across bands where internal variability is largest, improving identifiability at interannual periods for fixed RMS amplitude.

The resulting Bode gain/phase with confidence envelopes form the primary surrogate for robust control design (E3): H-infinity and MPC controllers synthesize temperature tracking with explicit phase-margin considerations across climate-relevant bands \cite{macmartin2014dynamicsof}. Because phase is directly estimated, phase-drift diagnostics under slowly increasing baseline forcing provide an early-warning channel (E4): decreases in phase margin toward $-\pi$ at key frequencies and concurrent growth of HDI \eqref{eq:hdi} indicate degradation of linearity and proximity to oscillatory or bifurcation-like behavior, complementing variance/autocorrelation signals. The framework integrates cleanly with current SAI modeling efforts \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} while adhering to risk constraints emphasized in governance debates \cite{robock200820reasons,keith2010researchon}.

Implementation summary (E1–E2):
\begin{itemize}
\item Preprocess outputs to anomalies (remove trend and seasonal cycle); select $\Omega$ on integer DFT lines between 0.02–2 cycles/year; choose $M$ synchronized periods.
\item Design multisine/PRBS amplitudes and phases via \eqref{eq:oid} under amplitude, SAOD, and ozone constraints; limit crest factor.
\item Run ensembles; compute $S_{uu},S_{yu},S_{yy}$ and $\widehat{G}(\omega)$ via \eqref{eq:frf} or weighted regression \eqref{eq:wsr}; report coherence and 95% CIs using \eqref{eq:coherence}.
\item Diagnose nonlinearities using detection lines; compute HDI and, if needed, fit sparse $H_2$ via \eqref{eq:volterra}; validate on held-out single-tone tests (E2).
\end{itemize}

This spectral regression layer turns purposefully pulsed SAI into a spectroscopy experiment: it extracts frequency-resolved gains, lags, and weak nonlinear couplings with quantified uncertainty, yielding compact, transferable surrogates for robust controller synthesis and early-warning analysis that are difficult to recover from passive or single-pulse experiments \cite{pintelon2012system,ljung1999system,macmartin2014dynamicsof}.


% === AREA: Pseudo-random binary sequences (PRBS) in climate model excitation. ===

\subsection{PRBS-based active probing: persistently exciting, information-efficient SAI spectroscopy}

Pseudo-random binary sequences (PRBS) provide a compact, high–signal-to-noise excitation for identifying dynamical responses under tight actuation and environmental constraints. In system identification, PRBS and related maximum-length sequences are persistently exciting, nearly white over a controllable band, and admit closed-form information metrics and leakage corrections, enabling efficient recovery of Bode gain/phase and low-order nonlinear distortions from short, noisy experiments \cite{ljung1999system,pintelon2012system}. In the SAI context, PRBS offers a natural way to superimpose minimally invasive, bounded, piecewise-constant micro-perturbations on a steady injection baseline within existing protocols such as GeoMIP and ARISE-SAI \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, while preserving interpretability for closed-loop design \cite{macmartin2014dynamicsof}.

We consider a discrete-time PRBS actuator added to a baseline injection rate $\bar u$:
\begin{equation}
u_k \;=\; \bar u \;+\; a\,s_k,\qquad s_k\in\{-1,+1\},\qquad k=0,1,\ldots,
\label{eq:prbs_input}
\end{equation}
with bit interval $T_b$ (e.g., monthly) and amplitude $a$ chosen to satisfy environmental and operational constraints. For a length-$N_b$ maximum-length sequence (MLS) generated by a linear-feedback shift register, the (normalized) autocorrelation is
\begin{equation}
R_{ss}[\ell] \;=\; \frac{1}{N_b}\sum_{k=0}^{N_b-1} s_k\,s_{k+\ell}
\;=\;
\begin{cases}
1, & \ell=0,\\[2pt]
-\frac{1}{N_b}, & \ell\neq 0,
\end{cases}
\label{eq:prbs_autocorr}
\end{equation}
which implies a nearly flat input spectrum across discrete lines up to the knee frequency set by $T_b$; with zero-order hold over $T_b$, the continuous-time shaping is given by the familiar sinc envelope \cite{pintelon2012system}. PRBS is persistently exciting of order $n$ if $N_b\ge 2n$ (modulo windowing), providing identifiability guarantees for $n$-parameter linear models and supporting Volterra/Koopman regressions for weak nonlinearities \cite{ljung1999system}.

Designing PRBS for climate-active spectroscopy. We target the monthly-to-interannual band (0.02–2 cycles/year) by selecting $T_b\in[0.5,2]$ months and $N_b$ such that the period $N_bT_b$ fits within the experiment length (5–30 years; cf. E6), e.g., $N_b\in\{127,255\}$ for $T_b=1$ month. To reduce unrealistically sharp ramps while preserving spectral flatness, we optionally smooth the binary steps with a first-order hold (slew limiter)
\begin{equation}
\tilde u_k \;=\; \tilde u_{k-1} + \gamma\,(u_k-\tilde u_{k-1}),\qquad \gamma\in(0,1],
\end{equation}
which multiplies the spectrum by $|H_\gamma(e^{\mathrm{j}\omega})|^2$ known a priori and thus correctable in the frequency-domain estimator \cite{pintelon2012system}. Amplitude choice $a\in[0.05,0.5]$ TgS/yr RMS follows E1 and is set via information-optimal design:
\begin{align}
\max_{a,\,T_b,\,\gamma}\quad & \Phi\big(\mathcal{I}(a,T_b,\gamma)\big)\quad\text{s.t.}\quad
|u_k-\bar u|\le a_{\max},\;\;|u_k-u_{k-1}|\le \Delta_{\max},\;\;\mathrm{SAOD\,risk}\le \rho,
\label{eq:prbs_oid}
\end{align}
where $\Phi$ is, e.g., $\log\det$ or trace of the Fisher information matrix (FIM), and the risk constraint uses an offline linear surrogate from injection to SAOD to bound transient optical depth excursions. For linear-in-parameters spectral models $G(\omega;\theta)$ and colored output noise $\Phi_{vv}(\omega)$, the frequency-domain FIM for $\theta$ is approximately
\begin{equation}
\mathcal{I}(\theta)\;\approx\; 2N \sum_{\omega\in\Omega}
\Big(\partial_\theta G(\omega)\Big)^{\!*}\,
\frac{\Phi_{uu}(\omega)}{\Phi_{vv}(\omega)}\,
\Big(\partial_\theta G(\omega)\Big),
\label{eq:fim}
\end{equation}
so maximizing $\Phi_{uu}(\omega)$ in the band where $|\partial_\theta G|$ is large, subject to constraints, increases parameter precision \cite{ljung1999system,enhanced_6_20250812}. Compared to multisine or chirp, PRBS provides low crest factor, simple implementation under discrete operational scheduling, and near-uniform spectral coverage without solving large phase-coupling programs \cite{pintelon2012system}. PRBS-like excitations have also been leveraged in climate model calibration contexts with spectral nudging and ensemble experiments, supporting their practicality in high-dimensional geophysical models \cite{enhanced_10_20250812}.

Multi-input PRBS and MIMO identification. SAI actuation is naturally multi-input (e.g., hemispheric bands, latitude–season channels). We assign mutually low-correlated binary codes (time-shifted MLS, Gold codes) to each channel, enabling MIMO frequency response estimation via the cross-spectral matrix
\begin{equation}
\hat G(\omega) \;=\; \hat S_{yu}(\omega)\,\hat S_{uu}(\omega)^{-1},
\qquad
\hat S_{yu}(\omega) = \frac{1}{N}\sum_t \mathbf{y}_t\,\mathbf{u}_t^H e^{-\mathrm{j}\omega t},
\end{equation}
with leakage-corrected local polynomial averaging and known input shaping deconvolution \cite{pintelon2012system}. This permits simultaneous recovery of gains/lags from injection channels to multiple outputs (GMST, regional precipitation indices, strat winds), increasing efficiency under fixed computational budgets.

Nonlinear diagnostics with PRBS. Although $s_k$ is binary, its flat spectrum and rich lag structure excite quadratic interactions that reveal second-order Volterra structure. We construct polynomial–convolution features from $s_k$ to estimate sparse second-order kernels via regularized regression,
\begin{equation}
y_t \;\approx\; \sum_{\ell} h_1[\ell]\,u_{t-\ell} + \sum_{\ell_1,\ell_2} h_2[\ell_1,\ell_2]\,u_{t-\ell_1}u_{t-\ell_2},
\end{equation}
with lasso/elastic-net penalties to control variance and select active cross-frequency couplings \cite{enhanced_12_20250812,enhanced_3_20250812}. Harmonic distortion indices (HDI) computed from output spectra at intermodulation lines provide a compact early-warning observable for growing nonlinearities under escalating baseline forcing (E4), complementing passive variance/autocorrelation metrics \cite{enhanced_5_20250812}.

Protocol integration and practicalities. We superimpose PRBS on baseline SAI scenarios within established ESM workflows: CESM1(WACCM) large ensembles and ARISE-SAI protocols provide a credible testbed for controlled excitation subject to chemistry and dynamics constraints \cite{tilmes2018stratospheric,richter2022assessingresponses}. Monthly scheduling fits operational granularity and minimizes disruption relative to continuous injection, aligning with governance cautions on experimental intrusiveness \cite{robock200820reasons,keith2010researchon}. To combat internal variability, we (i) reuse the same PRBS across ensemble members to average incoherent background noise in cross-spectra; and (ii) rotate PRBS phases (cyclic shifts) across realizations to reduce bias in leakage corrections. Spectral regression of GMST and regional indices onto PRBS inputs yields Bode gain/phase with uncertainty bands, as validated in climate data contexts \cite{enhanced_9_20250812}. Identified linear/MIMO models feed H-infinity/MPC synthesis (E3), exploiting PRBS-enabled gain/phase maps to trade off temperature tracking and hydrological stability \cite{pintelon2012system,enhanced_4_20250812,macmartin2014dynamicsof}.

Design recommendations. For E1/E2, we recommend: (a) $T_b=1$ month, $N_b\in\{127,255\}$, $a=0.1$–$0.3$ TgS/yr RMS; (b) two-input PRBS on hemispheric channels using orthogonal codes; (c) optional $\gamma=0.5$ slew limiting with analytical deconvolution; (d) Welch averaging over 10–20 nonoverlapping windows for cross-spectral estimates; and (e) sparse Volterra fitting up to 24-month memory. For E6, we map $\Phi(\mathcal{I})$ versus $(a,\,T_b,\,N_b)$ under fixed run length to chart practicality bounds and select minimally invasive designs achieving target prediction error. Together, PRBS-based excitation delivers persistently exciting, information-optimal perturbations that make the climate system’s frequency-dependent pathways observable with modest computational cost, directly advancing identification, control, and early warning objectives \cite{ljung1999system,pintelon2012system,enhanced_6_20250812,enhanced_9_20250812}.


% === AREA: Climate model emulation and surrogate modeling techniques. ===

\subsection{Surrogate modeling and emulation for active spectroscopy and control}
\label{subsec:emulation}

Earth system models (ESMs) with interactive aerosols and chemistry are indispensable for assessing the impacts and risks of stratospheric aerosol injection (SAI), but their computational expense limits the breadth of excitation and control-design experiments that can be performed directly in high resolution \cite{tilmes2018stratospheric,kravitz2011thegeoengineering,richter2022assessingresponses}. We therefore develop a hierarchy of compact, interpretable surrogate models that emulate the input--output dynamics from SAI injection rate perturbations to key climate responses under the actively designed probes in Sec.~E1. The surrogates are explicitly tailored to the information content of multi-sine/PRBS/chirp experiments and to the needs of robust control synthesis, prioritizing frequency-domain fidelity, quantified uncertainty, and cross-model transferability.

We denote the small-amplitude SAI perturbation about a baseline by $u_t$ (e.g., TgS\,yr$^{-1}$), and the vector of climate responses by $y_t \in \mathbb{R}^p$ (e.g., GMST, Sahel JJA precipitation, SAOD, circulation indices). Let $U(\omega)$ and $Y(\omega)$ be their discrete-time Fourier transforms over the experiment window. Our surrogate architecture comprises three complementary layers.

First, a linear spectral emulator identifies the multi-input, multi-output frequency response
\[
Y(\omega_k) = G(\mathrm{j}\omega_k;\theta)\,U(\omega_k) + E(\omega_k), \quad k=1,\dots,K,
\]
where $G(\mathrm{j}\omega;\theta)$ is a parsimonious, stable, and causal transfer function parameterized by $\theta$, and $E$ captures residual variability. We estimate the nonparametric frequency response via spectral regression/coherence methods that correct for leakage and colored noise, leveraging the probe’s designed spectrum to maximize signal-to-noise \cite{pintelon2012system,ljung1999system}. We then fit a low-order, stable state-space realization $(A,B,C,D)$ by solving
\[
\min_{A,B,C,D}\;\sum_{k=1}^{K} w_k\,\big\|C(\mathrm{j}\omega_k I - A)^{-1}B + D - \widehat{G}(\mathrm{j}\omega_k)\big\|_F^2,
\]
with frequency weights $w_k$ reflecting both estimation confidence and control relevance (e.g., monthly--interannual bands). This produces an interpretable linear surrogate that is directly usable for H-infinity loop-shaping and constraint-aware MPC in Sec.~E3 \cite{macmartin2014dynamicsof}. The preference for frequency-domain identification is motivated by its data efficiency and direct access to gain/phase structure, which are central for controller robustness and early-warning diagnostics \cite{pintelon2012system,ljung1999system}.

Second, to capture weak nonlinearities induced by state dependence and aerosol--dynamics coupling, we augment the linear surrogate with a sparse second-order Volterra term,
\[
y_t \approx (h_1 * u)_t + \sum_{\tau_1,\tau_2} h_2(\tau_1,\tau_2)\,u_{t-\tau_1}u_{t-\tau_2} + \varepsilon_t,
\]
where convolution $*$ acts elementwise across inputs/outputs. In the frequency domain this introduces harmonic generation and intermodulation between excited lines, which we quantify via a harmonic distortion index (HDI) in Sec.~E2. We estimate $h_2$ using regularized regression on polynomial-convolution features (lasso/elastic-net), exploiting the probe’s sparse line spectrum to control variance and maintain interpretability \cite{ljung1999system,pintelon2012system}. This nonlinear layer is evaluated on held-out single-tone tests to verify harmonic predictions and cross-frequency coupling.

Third, for predictive control we construct a Koopman-regressed linear predictor that lifts observed variables into a low-dimensional latent space supporting linear evolution with exogenous input,
\[
z_{t+1} = A_z z_t + B_z u_t + w_t, \qquad y_t = C_z z_t + v_t,
\]
where the lifting $z_t=\phi(y_t, u_{t-1:t-L})$ is chosen from physically informed features (e.g., bandpassed indices, lag stacks) identified by the spectroscopy stage. Fitting proceeds via least squares with ridge regularization, yielding a compact predictive model that preserves the frequency response learned above while improving multi-step forecasting for MPC \cite{macmartin2014dynamicsof}. Together, the spectral, Volterra, and Koopman layers realize the surrogate requirements articulated in Secs.~E2--E3: accurate Bode gain/phase, calibrated nonlinear distortions, and control-ready state-space structure.

Probe design and training are co-optimized using information-theoretic criteria. For a parametric spectral model $G(\mathrm{j}\omega;\theta)$ and approximately Gaussian residuals with spectral density $S_\varepsilon(\omega)$, the Fisher information aggregates across excited lines as
\[
\mathcal{I}(\theta) \;=\; \sum_{k=1}^{K} \left(\frac{\partial G}{\partial \theta}(\mathrm{j}\omega_k)\right)^{\!\!H}
\frac{S_{uu}(\omega_k)}{S_{\varepsilon}(\omega_k)}
\left(\frac{\partial G}{\partial \theta}(\mathrm{j}\omega_k)\right),
\]
guiding the allocation of probe power across frequencies and outputs under amplitude, variance, and chemistry constraints specified by the ESM protocol \cite{ljung1999system,pintelon2012system,richter2022assessingresponses}. This design aligns with our E1 amplitudes and frequency bands and formalizes why multi-sine/PRBS excitation is more informative than passive or single-impulse baselines for recovering spectral and nonlinear structure.

Uncertainty quantification and validation are integral. We propagate spectral regression covariance into the state-space fit to obtain frequency-resolved confidence bands for $G(\mathrm{j}\omega)$, and we cross-validate on withheld tones and composite probes (Sec.~E2). Acceptance criteria include: coherence exceeding a threshold on target bands; normalized RMSE on single-tone predictions; smoothness of the recovered Bode curves (L-curve selection) \cite{pintelon2012system}; and stability/causality of the fitted realization. Cross-model tests (Sec.~E5) evaluate whether surrogates trained in an intermediate-complexity model transfer to a coarser ESM with interactive chemistry \cite{tilmes2018stratospheric,richter2022assessingresponses}. Finally, because closed-loop feasibility hinges on interpretable and robust dynamics \cite{macmartin2014dynamicsof}, we expose to the controller both the linear frequency response and the HDI- and phase-drift diagnostics developed in Sec.~E4, enabling constraint-aware designs and early-warning monitoring within the same surrogate framework.

By grounding emulation in frequency-domain system identification \cite{pintelon2012system,ljung1999system} and by training on information-optimized, small-amplitude probes, the proposed surrogates compress the essential SAI-to-climate pathways into compact models that are simultaneously diagnostic, predictive, and controllable. This bridges computationally intensive ESM experiments \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} and the robust control synthesis and risk-aware governance questions motivating this study \cite{macmartin2014dynamicsof,keith2010researchon,robock200820reasons}.


% === AREA: Optimization algorithms for multi-objective climate control. ===

\subsection{Multi-objective optimization and robust control co-design enabled by active spectroscopy}

Active spectroscopy furnishes control-relevant surrogate dynamics that allow SAI scheduling to be posed as a principled multi-objective optimization, rather than as ad hoc pulse selection. Our aim is to simultaneously track global-mean temperature (GMST), protect regional hydrology, limit stratospheric aerosol optical depth (SAOD) excursions, and minimize actuation variability, while maintaining robustness to internal variability and model error. This builds on closed-loop SAI concepts \citep{macmartin2014dynamicsof} and on modern Earth system experimental protocols and ensembles \citep{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}, and leverages frequency-domain identification and optimal input design \citep{ljung1999system,pintelon2012system}.

Control-oriented surrogates estimated in E1–E2 are written in the frequency domain as
\begin{equation}
Y(\omega) \;=\; G(\omega)\,U(\omega) \;+\; \iint H_2(\omega_1,\omega_2)\,U(\omega_1)\,U(\omega_2)\,\delta(\omega-\omega_1-\omega_2)\,d\omega_1 d\omega_2 \;+\; D(\omega),
\label{eq:surrogate}
\end{equation}
where $G(\omega)$ is the Bode frequency response from injection rate $U$ to climate outputs $Y$ (e.g., GMST, precipitation indices), and $H_2$ collects dominant second-order Volterra terms capturing harmonic and intermodulation distortions identified via sparse estimation \citep{pintelon2012system,enhanced_12_20250812}. The active probes supply tight confidence sets $\mathcal{G}$ for $G(\omega)$ across bands of interest and quantify nonlinearity via harmonic distortion indices (HDI).

Given these surrogates, we pose a multi-objective design over a controller $K$ (H-infinity or MPC policy) and, when operating adaptively, over probe spectra $\Phi_u(\omega)$:
\begin{align}
\min_{K,\;\Phi_u} \;\; \mathbf{J}(K,\Phi_u) &:= \Big[ 
J_{\mathrm{T}},\,
J_{\mathrm{P}},\,
J_{\mathrm{S}},\,
J_{\mathrm{U}},\,
J_{\mathrm{EW}}
\Big], \nonumber \\
\text{s.t.}\quad &
\begin{cases}
\text{closed-loop dynamics under } G\in\mathcal{G} \text{ and disturbances (ENSO-like, volcano) are stable},\\
\text{environmental and operational constraints on SAOD/ozone proxies, actuation bounds},\\
\Phi_u(\omega) \text{ feasible for multi-sine/PRBS implementation over the campaign horizon}.
\end{cases}
\label{eq:mo}
\end{align}
The objective components are: (i) temperature tracking $J_{\mathrm{T}}=\int W_{\mathrm{T}}(\omega)\,\big|T_{r\to y}(\omega)\big|^2\,d\omega$; (ii) regional precipitation variability $J_{\mathrm{P}}=\sum_{r}\int W_{\mathrm{P},r}(\omega)\,S^{(r)}_{y}(\omega)\,d\omega$; (iii) SAOD excursions $J_{\mathrm{S}}=\int W_{\mathrm{S}}(\omega)\,|Y_{\mathrm{SAOD}}(\omega)|^2\,d\omega$; (iv) controller effort and smoothness $J_{\mathrm{U}}=\| \Delta u \|_{\mathrm{TV}} + \int W_{\mathrm{U}}(\omega)\,|U(\omega)|^2\,d\omega$; and (v) early-warning penalties $J_{\mathrm{EW}}=\sum_{\omega\in\mathcal{B}}\big(\alpha_{\phi}|\Delta \phi(\omega)| + \alpha_{\mathrm{HDI}}\mathrm{HDI}(\omega)\big)$ that discourage phase-lag drift toward $-\pi$ and rising harmonic content \citep{enhanced_5_20250812}. Scalarization (weighted sum) or $\varepsilon$-constraint formulations trace Pareto-efficient trade-offs familiar from multi-objective control and energy systems optimization \citep{enhanced_12_20250812}.

For H-infinity synthesis we adopt a mixed-sensitivity formulation shaped by the learned frequency response,
\begin{equation}
\min_{K}\;\; \gamma \quad \text{s.t.}\quad 
\sup_{G\in\mathcal{G}} \left\| 
\begin{bmatrix}
W_{S}(\omega)\,S(\omega) & 0 \\
0 & W_{T}(\omega)\,T(\omega) \\
W_{U}(\omega)\,K(\omega)S(\omega) & 0
\end{bmatrix}
\right\|_{\infty} \le \gamma,
\label{eq:hinf}
\end{equation}
where $S=(I+G K)^{-1}$ and $T=G K (I+G K)^{-1}$. The weights $W_{S},W_{T},W_{U}$ are informed by the empirically identified gain/phase structure and emphasize bands with high climatic sensitivity (e.g., interannual modes), thereby tying robustness margins directly to measured climate pathways. For MPC we use the Koopman-regressed predictor or linearized Volterra surrogate to solve, at each step, a finite-horizon program
\begin{align}
\min_{u_{t:t+N-1}} \;\; & \sum_{k=1}^{N} \Big( \| W_{\mathrm{T}}(y_{t+k}-y^\star)\|_2^2 + \sum_{r}\|W_{\mathrm{P},r}\,y^{(r)}_{t+k}\|_2^2 \Big) + \rho \|\Delta u\|_1 + \|W_{\mathrm{U}} u\|_2^2 \nonumber \\
\text{s.t.}\;\; & \text{surrogate dynamics (\ref{eq:surrogate}) under $G\in\mathcal{G}$, SAOD and actuator constraints, chance constraints on $y^{(r)}$},
\label{eq:mpc}
\end{align}
with robust or scenario-based enforcement to hedge internal variability and unmodeled disturbances \citep{enhanced_4_20250812}. Both designs are benchmarked against continuous and naive pulsed baselines under ARISE-SAI-like forcing pathways \citep{richter2022assessingresponses}.

Critically, the probe design is co-optimized for control. Information-optimal multi-sine/PRBS spectra are chosen to maximize Fisher information about parameters $\theta$ that most influence control performance, subject to amplitude and environmental constraints:
\begin{align}
\max_{\Phi_u(\omega)} \;\; & \mathrm{tr}\big( W_{\theta}\, \mathcal{I}(\theta;\Phi_u)\big) - \eta \int W_{\mathrm{risk}}(\omega)\,|Y_{\mathrm{SAOD}}(\omega)|^2 d\omega \nonumber \\
\text{s.t.}\;\; & \int \Phi_u(\omega)\,d\omega \le P_{\max}, \quad 0\le \Phi_u(\omega)\le \Phi_{\max}(\omega),
\label{eq:oid}
\end{align}
with $\mathcal{I}$ assembled from spectral regressors \citep{ljung1999system,pintelon2012system} and optimized via Fisher-information methods adapted to complex systems \citep{enhanced_6_20250812}. Weighting $W_{\theta}$ aligns information gain with the mixed-sensitivity bands in (\ref{eq:hinf}); the risk penalty uses SAOD proxies to respect constraints highlighted by SAI protocols \citep{richter2022assessingresponses}. This closes the loop between experiment design and controller synthesis, improving data efficiency relative to passive observation. A value-of-information (VoI) criterion decides when additional probing is warranted by comparing expected regret reduction in the multi-objective controller against the marginal cost of new data \citep{enhanced_2_20250812}.

Algorithmically, we use a bilevel procedure:
(i) identify $G(\omega)$ and $H_2$ with uncertainty from E1–E2;
(ii) generate Pareto-efficient H-infinity controllers by sweeping weights in (\ref{eq:hinf}), and train an MPC policy (\ref{eq:mpc}) with robust/chance constraints;
(iii) on a validation ensemble (including ENSO-like stochasticity and a volcanic eruption scenario), map the Pareto front in terms of tracking RMSE, regional constraint violation rate, TV-norm of effort, worst-case regional anomaly, and regret against an oracle with access to the true model;
(iv) if VoI merits, redesign probes via (\ref{eq:oid}) to tighten $\mathcal{G}$ where robustness margins are thin;
(v) incorporate early-warning signals as soft constraints or penalties via $J_{\mathrm{EW}}$, triggering a precautionary rollback if phase drift or HDI growth accelerates \citep{enhanced_5_20250812}.

We evaluate cross-model robustness by transferring controllers across tiers (idealized aquaplanet/EMIC to coarser ESM with chemistry) \citep{tilmes2018stratospheric,richter2022assessingresponses}, aggregating uncertainty with Bayesian model combination where appropriate \citep{enhanced_8_20250812}. In sum, the active-spectroscopy-informed, multi-objective co-design transforms pulsing from a heuristic into a quantitative, information-aware control problem, aligning identification, robustness, and governance-relevant trade-offs within a single optimization workflow.


% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{Positioning within SAI Modeling and Uncertainty: Why Active Spectroscopy?}

Stratospheric aerosol injection (SAI) has been examined through coordinated model intercomparisons and targeted large-ensemble simulations that illuminate mean climate responses and spread across designs, models, and internal variability. The Geoengineering Model Intercomparison Project (GeoMIP) established common protocols and revealed substantial model-to-model divergence in temperature and hydrological responses under idealized SAI forcing \citep{kravitz2011thegeoengineering}. The CESM1(WACCM) SAI Large Ensemble demonstrated how internally generated variability and parameter uncertainties shape regional outcomes and extremes under sustained aerosol forcing \citep{tilmes2018stratospheric}. More recently, ARISE-SAI formalized a protocol to study responses and impacts across multiple components of the Earth system under more realistic SAI scenarios \citep{richter2022assessingresponses}. Together, these efforts underscore two realities: (i) SAI perturbations project onto a coupled, multiscale climate with rich internal modes and pathway-dependent effects, and (ii) substantial uncertainty remains in regional hydrological impacts and in the transient response to time-varying forcing. This uncertainty motivates robust, feedback-informed approaches to SAI design and evaluation \citep{macmartin2014dynamicsof}, as well as caution about potential risks and limits \citep{robock200820reasons,keith2010researchon}.

A key gap in the current evidence base is dynamical: most SAI studies assess step, ramp, or slowly varying injection protocols and then diagnose aggregate differences in means and variances. Such “passive” designs are not optimized to resolve frequency-dependent gains, lags, or weak nonlinear distortions that govern how modulated injection propagates through the coupled stratosphere–troposphere–ocean system. Classical system identification shows that reliable recovery of frequency response and low-order nonlinearities requires inputs that are persistently exciting over the band of interest and tailored to maximize information subject to constraints \citep{ljung1999system,pintelon2012system}. In linear settings, multi-sine, chirp, and pseudo-random binary sequences (PRBS) are standard tools to isolate Bode gain/phase with minimal leakage and to separate coherent response from internal variability; random-phase multisines further enable detection of nonlinear distortion by inspecting energy at harmonic and intermodulation lines absent from the excitation \citep{pintelon2012system}. Translating these principles to SAI within Earth system models provides a principled route to quantify how temporal modulation changes outcomes.

We therefore propose to treat pulsing as active spectroscopy: superimpose small-amplitude, information-optimized excitation on a steady SAI baseline in silico and estimate compact surrogate dynamics from injection rate to key outputs (e.g., global-mean surface temperature and regional precipitation indices). The probe amplitudes and spectral content are chosen to satisfy two requirements. First, they must achieve persistent excitation across monthly to interannual bands where coupled modes (e.g., ENSO, QBO, monsoons) mediate SAI impacts, so that frequency response can be estimated with bounded variance despite internal variability. Second, they must remain sufficiently small to respect model-imposed constraints (e.g., stratospheric aerosol optical depth and ozone) and to justify local linearization while still revealing weak but policy-relevant nonlinearities. Within the identification literature, this trade-off is formalized by designing inputs that maximize a scalar measure of Fisher information under amplitude and environmental constraints \citep{ljung1999system}. Abstractly, if y denotes the vector of measured climate responses and θ the parameters of a surrogate model (frequency response or Volterra kernels), the input design solves
\begin{equation}
\max_{u \in \mathcal{U}} \; J(u) \equiv \log \det \mathcal{I}(\theta; u) \quad \text{s.t.} \quad \|u\|_{\infty} \leq u_{\max}, \; g(u) \leq 0,
\end{equation}
where u encodes multi-sine/PRBS amplitudes and phases, g(u) captures model-side constraints, and the Fisher information matrix aggregates sensitivities via
\begin{equation}
\mathcal{I}(\theta; u) \;=\; \sum_{t} \left(\frac{\partial \mu_{y}(t;\theta,u)}{\partial \theta}\right)^{\!\top}\!\Sigma_{y}^{-1}\left(\frac{\partial \mu_{y}(t;\theta,u)}{\partial \theta}\right),
\end{equation}
with Σy the covariance of internal variability and μy the mean response under input u. In frequency-domain estimation, J(u) increases when the input allocates power to frequencies where the signal-to-noise ratio and parameter sensitivity are high, yielding the familiar guidance to shape multisines across the band of interest \citep{pintelon2012system}.

This active-sensing perspective complements existing SAI protocols in three ways grounded in established identification and control theory. First, spectral regression under designed inputs directly yields Bode gain/phase, providing interpretable time constants and delays that cannot be robustly inferred from step/ramp experiments in the presence of colored climate noise \citep{pintelon2012system}. Second, random-phase multisines allow clean separation and quantification of second-order nonlinear distortion via energy at harmonic and sum/difference frequencies, enabling parsimonious Volterra-kernel surrogates that capture cross-frequency coupling relevant for hydrological side-effects \citep{ljung1999system,pintelon2012system}. Third, the resulting surrogate models are precisely the objects needed for robust feedback design: closed-loop formulations of SAI emphasize the need to track temperature targets while managing regional risks, a task for which H-infinity and model predictive control rely on accurate frequency-domain uncertainty descriptions and stability margins \citep{macmartin2014dynamicsof}. By estimating phase margins and monitoring drift in phase lag and harmonic distortion under gradually increased forcing, the same experiments can also provide early warning of deteriorating stability in a control-theoretic sense, complementing variance- and autocorrelation-based diagnostics commonly used in climate science.

Importantly, the proposed active spectroscopy is designed for numerical experiments, not field trials. It leverages the infrastructure and experience of existing multi-model and large-ensemble SAI efforts—GeoMIP for standardized forcing, CESM1(WACCM) ensembles for internal-variability characterization, and ARISE-SAI for realistic pathways and diagnostics—to stage minimally invasive, high-information perturbations within Earth system models \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. In doing so, it transforms the question “Do pulses help?” into the identification problem “What are the frequency-dependent pathways by which pulsing changes outcomes?”, and it provides the surrogate dynamics required to evaluate and design robust, feedback-aware SAI strategies under deep uncertainty \citep{macmartin2014dynamicsof,robock200820reasons,keith2010researchon}.


% === AREA: Information theory applications in climate science and modeling. ===

\subsection{Information-theoretic probe design for active spectroscopy}

The central premise of our framework is that small, deliberately structured perturbations can be designed to maximize the information gained about the climate system’s frequency response while respecting environmental constraints. Classical system identification provides a rigorous basis for such design via Fisher information, optimal input spectra, and coherence analysis, particularly in the frequency domain where multisine, PRBS, and chirp excitations are well understood \cite{ljung1999system,pintelon2012system}. In the SAI context, these tools complement and extend existing scenario-based protocols \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} by quantifying identifiability and enabling targeted experiments that are both high-signal-to-noise and low-risk.

We model the injection rate (control) as
\begin{equation}
u(t) = \bar{u} + \sum_{k \in \mathcal{K}} A_k \sin(2\pi f_k t + \phi_k) + u_{\mathrm{PRBS}}(t) + u_{\mathrm{chirp}}(t),
\label{eq:input}
\end{equation}
superimposed on a baseline $\bar{u}$ (e.g., 5 TgS/yr). Outputs $y(t) \in \mathbb{R}^p$ include GMST, regional hydrological indices, circulation metrics, and SAOD. For identification, we parameterize a surrogate transfer function $G(\mathrm{i}\omega;\theta)$ from $u$ to $y$ and treat internal variability as colored, approximately Gaussian disturbances with spectral density $S_{vv}(\omega)$. For small perturbations, the local linear approximation suffices to define the frequency-domain Fisher information matrix (FIM),
\begin{equation}
\mathcal{F}(\theta) \approx \sum_{\omega_k \in \Omega}
\left[\frac{\partial G(\mathrm{i}\omega_k;\theta)}{\partial \theta}\right]^{\!\!H}
\, S_{vv}^{-1}(\omega_k) \,
\left[\frac{\partial G(\mathrm{i}\omega_k;\theta)}{\partial \theta}\right]
\, S_{uu}(\omega_k)\, T_k,
\label{eq:fim}
\end{equation}
where $S_{uu}(\omega_k)$ is the input power at line $\omega_k\!=\!2\pi f_k$, $T_k$ scales with the number of observed cycles at $\omega_k$ (hence experiment length), and the sum extends over the set of excited frequencies $\Omega$ \cite{pintelon2012system,ljung1999system}. For multisines, $S_{uu}(\omega_k)\!\propto\! A_k^2$, whereas for PRBS and chirps it is determined by their spectra over $\Omega$.

Designing $u(t)$ to be maximally informative can be cast as maximizing a scalar functional of $\mathcal{F}$, for example D-optimality (log-determinant) or A-optimality (trace of inverse). Incorporating a Gaussian prior $\Sigma_{\mathrm{pr}}$ for control-relevant parameters yields an expected mutual information (MI) objective,
\begin{equation}
J(\Omega,\{A_k,\phi_k\}) \;=\; \tfrac{1}{2}\,\log\det\!\Big(I + \Sigma_{\mathrm{pr}}^{1/2}\,\mathcal{F}(\theta_0)\,\Sigma_{\mathrm{pr}}^{1/2}\Big),
\label{eq:mi}
\end{equation}
with $\theta_0$ a nominal operating point. Control-relevant identification is achieved by weighting frequencies at which closed-loop sensitivity will be high, a standard approach to reduce uncertainty where it matters most for regulation \cite{ljung1999system}. In practice, we consider the constrained optimization
\begin{align}
\max_{\Omega,\{A_k,\phi_k\}} \quad & J(\Omega,\{A_k,\phi_k\}) \nonumber\\
\text{s.t.} \quad &
\sum_{k\in\Omega} A_k^2 \leq E_{\max}, \quad
\|u-\bar{u}\|_{\infty} \leq U_{\max}, \label{eq:design}\\
& \mathrm{SAOD}[u] \leq S_{\max}, \;\; \mathrm{O}_3[u] \leq O_{\max}, \;\; \mathrm{CF}(u) \leq C_{\max}, \nonumber
\end{align}
where $E_{\max}$ and $U_{\max}$ limit RMS and peak amplitudes, respectively; $S_{\max}$ and $O_{\max}$ represent operational constraints derived from SAOD and ozone exposure assessments \cite{tilmes2018stratospheric,richter2022assessingresponses}; and $\mathrm{CF}(u)$ is the crest factor, reducible via phase selection (e.g., Schroeder phases) to avoid sharp pulses \cite{pintelon2012system}. This formulation explicitly trades probe amplitude and duration against identifiability: asymptotically, $\mathcal{F}\!\propto\! T$ and $\mathcal{F}\!\propto\! A_k^2$, so posterior variances shrink roughly as $1/(T A^2)$ when the noise spectrum is fixed \cite{ljung1999system}.

Frequency-domain estimation proceeds via spectral regression,
\begin{equation}
\widehat{G}(\omega) \;=\; \frac{S_{yu}(\omega)}{S_{uu}(\omega)}, 
\qquad 
\gamma^2(\omega) \;=\; \frac{|S_{yu}(\omega)|^2}{S_{yy}(\omega)\,S_{uu}(\omega)},
\label{eq:spectralreg}
\end{equation}
with leakage control through line selection, windowing, and multi-taper averaging \cite{pintelon2012system}. The magnitude-squared coherence $\gamma^2(\omega)$ provides an information-theoretic SNR measure, directly diagnosing whether the designed input overcomes internal variability at each frequency. For nonlinear characterization, we adopt multisine layouts that separate estimation lines from detection lines, enabling unambiguous identification of second-order harmonics and intermodulation products in $\widehat{G}$ and in the estimated Volterra kernels \cite{pintelon2012system}. Specifically, we partition $\Omega=\Omega_{\mathrm{B}}\cup\Omega_{\mathrm{N}}$ and avoid frequency triplets with $f_i \pm f_j$ falling back onto $\Omega_{\mathrm{B}}$, a standard strategy to expose nonlinear energy transfers without biasing the linear estimate.

In SAI applications, design constraints arise from both physical and governance considerations. Ensemble protocols indicate plausible injection magnitudes and sensitivities \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, while broader assessments caution against excursions that could amplify hydrological risks \cite{robock200820reasons}. Our small-amplitude regime (0.05–0.5 TgS/yr RMS around $\bar{u}$) meets these conditions by construction, with additional safeguards via SAOD proxies and crest-factor limits in (\ref{eq:design}). Because internal climate variability is colored and exhibits strong low-frequency power, the water-filling intuition applies: under an energy budget $E_{\max}$, optimal amplitude allocation $A_k$ prioritizes frequencies with high parameter sensitivity and relatively low disturbance spectra $S_{vv}(\omega_k)$, adjusted by control-relevant weights \cite{ljung1999system,pintelon2012system}. This yields MI-efficient probes concentrated in monthly-to-interannual bands where SAI forcing translates into measurable, controllable responses.

The information-theoretic design integrates naturally with our experimental plan:
(i) in E1, we maximize (\ref{eq:mi}) over a candidate grid $f_k\!\in\![0.02,2]$ cycles/year with randomized phases optimized to minimize crest factor; (\ii) in E2, we reserve detection lines to estimate second-order Volterra kernels while preserving unbiased Bode estimates on $\Omega_{\mathrm{B}}$; (\iii) in E6, we quantify practicality bounds by mapping the surface of $J$ as a function of amplitude, duration, and ensemble size, thereby determining the minimal design achieving targeted posterior variances. The same FIM machinery also supports adaptive (sequential) design: after an initial wideband PRBS or multisine, we update $\Sigma_{\mathrm{pr}}$ and re-optimize (\ref{eq:design}) to focus subsequent energy where residual uncertainty is largest, a standard active-learning loop for complex dynamical systems \cite{ljung1999system,pintelon2012system}.

Finally, information measures provide early-warning diagnostics complementary to variance and autocorrelation. Specifically, we track (a) reductions in coherence $\gamma^2(\omega)$ and (b) growth of off-diagonal terms in the cross-frequency covariance induced by nonlinear harmonics; both signal deteriorating linear predictability and emerging mode coupling. We formalize this by monitoring a spectral divergence between the current and baseline responses,
\begin{equation}
D(\tau) \;=\; \sum_{\omega_k \in \Omega}\, w_k \,\big\| \widehat{G}_\tau(\omega_k) - \widehat{G}_0(\omega_k) \big\|_{S_{vv}^{-1}(\omega_k)}^{2},
\label{eq:divergence}
\end{equation}
and by testing for systematic phase drift toward $-\pi$ across control-relevant bands as baseline forcing grows. These quantities can be interpreted as reductions in predictive information and are computable from the same identification workflow, thereby offering a unified, information-theoretic basis for both control-oriented learning and instability detection within the SAI spectroscopy program \cite{macmartin2014dynamicsof}.


% === AREA: Volterra kernel methods for nonlinear system identification in climate models. ===

\subsection{Volterra-kernel spectroscopy for nonlinear climate response}
\label{sec:volterra}

Motivation. Small, designed SAI perturbations provide a controlled means to probe dynamical pathways in the coupled human–climate system \citep{macmartin2014dynamicsof}, yet linear frequency-response models are insufficient when pulsed injections generate harmonics and intermodulation across climate timescales (e.g., seasonal–interannual coupling affecting hydrology and circulation) \citep{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}. We therefore augment linear frequency-domain system identification with a second-order Volterra description, enabling explicit estimation of frequency-dependent gains, lags, and nonlinear distortions under multi-sine/PRBS/chirp excitation \citep{ljung1999system,pintelon2012system}. This “volterra spectroscopy” uses input designs that isolate nonlinear contributions in the spectrum, yielding compact, interpretable surrogate models suitable for robust control and early-warning.

Model structure. Let the input be the perturbation about a steady SAI baseline, u_t = \delta\dot{M}_{\mathrm{SAI}}(t), and let y_t \in \mathbb{R}^p collect outputs (e.g., GMST, Sahel JJA precipitation, monsoon and stratospheric wind indices, SAOD). Over an experiment window where the response is wide-sense stationary around the baseline, we adopt a truncated second-order Volterra model with process noise e_t:
\begin{equation}
\label{eq:volterra_time}
y_t = h_0 + \sum_{\tau=0}^{M_1-1} h_1[\tau]\, u_{t-\tau} + \sum_{\tau_1=0}^{M_2-1}\sum_{\tau_2=0}^{M_2-1} h_2[\tau_1,\tau_2]\, u_{t-\tau_1} u_{t-\tau_2} + e_t,
\end{equation}
where h_1[\tau] \in \mathbb{R}^{p\times 1} is the linear impulse response, h_2[\tau_1,\tau_2] \in \mathbb{R}^{p\times 1} is the symmetric second-order kernel, and M_1, M_2 are memory horizons (e.g., months–years). In the frequency domain, writing Y(k), U(k) as discrete Fourier transforms (DFT) at frequency line k, (\ref{eq:volterra_time}) becomes \citep{pintelon2012system}
\begin{equation}
\label{eq:volterra_freq}
Y(k) = H_1(k)\, U(k) \;+\; \sum_{\substack{k_1+k_2\equiv k\;(\mathrm{mod}\;N)}} H_2(k_1,k_2)\, U(k_1)\, U(k_2) \;+\; E(k),
\end{equation}
where H_1(k) is the linear frequency response and H_2(k_1,k_2) is the second-order frequency response (2-D FRF), with N the record length.

Input design to expose nonlinearity. To render (\ref{eq:volterra_freq}) identifiable from a single experiment despite colored internal variability, we adopt random-phase multisine excitation with an odd–even line scheme \citep{pintelon2012system}. Specifically, we excite only a designed set of “odd” frequency lines K_{\mathrm{ex}} (monthly to interannual band, 0.02–2 cycles year^{-1}) with controlled amplitudes and random phases, while keeping the “even” lines unexcited. Under this design:
- Linear contributions appear only on the excited lines (k \in K_{\mathrm{ex}}).
- Even-order nonlinearities (second order) generate energy at unexcited combination lines (k \notin K_{\mathrm{ex}}), cleanly isolating H_2 without linear leakage.
- Cross-frequency intermodulation products map to known sums (k_1+k_2), enabling a sparse, overdetermined linear system for H_2(k_1,k_2).

We ensure an integer number of periods, apply Hann-tapered segment averaging, and use Welch spectra to reduce leakage and variance \citep{pintelon2012system}. PRBS or multilevel PRBS can be used when operational constraints limit harmonic content; their near-white spectra across the target band maintain Fisher information for both H_1 and H_2, with instrumental-variable estimators mitigating bias under colored disturbances \citep{ljung1999system}.

Estimation. Stacking frequency lines and segments, we form a weighted least-squares (WLS) problem for each output component:
\begin{equation}
\label{eq:wls}
\hat{\theta} \;\;=\;\; \arg\min_{\theta}\; \big\| W\,(\Phi\,\theta - y)\big\|_2^2 \;+\; \lambda_1 \|\theta\|_1 \;+\; \lambda_2 \|\theta\|_2^2,
\end{equation}
where y concatenates the measured Y(k), \theta collects unknowns \{H_1(k)\}_{k\in K_{\mathrm{ex}}} and \{H_2(k_1,k_2)\}_{k_1,k_2\in K_{\mathrm{ex}}}, \Phi contains the known regressors [U(k)] and [U(k_1)U(k_2)], and W weights by the inverse noise spectral density estimated from unexcited lines (capturing colored internal variability). The elastic-net penalties (\lambda_1,\lambda_2) promote sparsity and numerical stability in H_2, reflecting the expectation that only a subset of cross-frequency couplings are dynamically significant over the chosen band. For MIMO outputs, we solve (\ref{eq:wls}) jointly with group penalties that enforce shared support across outputs where appropriate (e.g., common interannual couplings), while allowing output-specific gains/phases.

Practical identifiability and complexity control. The dimensionality of H_2 can be reduced by: (i) restricting to a sparse set of frequency pairs based on physical priors (e.g., seasonal–interannual mixing), (ii) imposing Hermitian symmetry and kernel separability where justified, and (iii) low-memory assumptions for rapidly mixing fast processes. Fisher information analysis guides input amplitude and line selection: for Gaussian disturbances, the WLS information matrix is F \approx \Phi^\ast W^\ast W \Phi \citep{ljung1999system}. We maximize \log\det F over multisine amplitudes/phases subject to constraints on RMS injection, SAOD variance, and proxy ozone perturbations, aligning with responsible experiment design in SAI simulations \citep{tilmes2018stratospheric,richter2022assessingresponses,keith2010researchon}.

Validation metrics and early-warning observables. We quantify fidelity on held-out single-tone tests by normalized RMSE and magnitude–phase coherence; cross-frequency predictive error assesses how well estimated H_2 reproduces unexcited intermodulation lines from (\ref{eq:volterra_freq}). We define a harmonic distortion index (HDI) to summarize nonlinear strength over a band \mathcal{B}:
\begin{equation}
\label{eq:hdi}
\mathrm{HDI}(\mathcal{B}) \;=\; \frac{\sum_{k\in \mathcal{B}\setminus K_{\mathrm{ex}}} \|Y(k)\|_2^2}{\sum_{k\in \mathcal{B}\cap K_{\mathrm{ex}}} \|Y(k)\|_2^2},
\end{equation}
with growth in HDI under gradually increased baseline forcing interpreted as nonlinear amplification. Jointly tracking phase-lag drift in H_1(k) and HDI growth provides targeted early-warning indicators complementing passive variance/autocorrelation methods, directly tied to the control channel \citep{macmartin2014dynamicsof,robock200820reasons}.

Integration into the framework. The Volterra kernels estimated here instantiate E2 (frequency response and nonlinear distortion) and feed E3–E4: (a) robust controllers (H_\infty/MPC) are synthesized on linearized models augmented with bounded nonlinear residuals inferred from H_2, improving constraint satisfaction for regional hydroclimate \citep{macmartin2014dynamicsof}; (b) early-warning thresholds are set on HDI and phase drift, calibrated in the same controlled experiments. Because the identification relies on information-optimized, small-amplitude multisines/PRBS embedded in standard SAI protocols \citep{tilmes2018stratospheric,richter2022assessingresponses}, it is compatible with existing Earth system model campaigns (e.g., GeoMIP-like protocols) while revealing spectral and nonlinear structure unattainable from passive observation or single-step experiments \citep{pintelon2012system,ljung1999system}.


% === AREA: Robust control techniques (H-infinity, MPC) for climate stabilization. ===

\subsection{Robust control synthesis informed by active spectroscopy}
\label{sec:robust-control}

Closed-loop control has been proposed to manage solar climate intervention, showing that feedback can mitigate uncertainties in forcing-response relationships if the controller is designed against model mismatch and internal variability \citep{macmartin2014dynamicsof}. Building on the frequency-domain models identified in E1–E2, we synthesize robust controllers that explicitly account for spectral uncertainty and multi-objective performance across temperature and hydrological outcomes. Our approach leverages standard results from frequency-domain system identification \citep{ljung1999system,pintelon2012system} and deploys them in the SAI context using GeoMIP/ARISE-style protocols and diagnostics \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, while acknowledging broader risk concerns that motivate conservatism in control design \citep{robock200820reasons,keith2010researchon}.

\paragraph{Uncertainty-aware surrogate plant.}
Let $u(t)$ denote deviations in injection rate (TgS/yr) around a baseline, and let $y(t) \in \mathbb{R}^{p}$ collect key outputs (e.g., GMST, regional precipitation indices, SAOD). From E1–E2, we obtain a nonparametric frequency response estimate
\begin{equation}
\hat{G}(\mathrm{i}\omega) \;=\; S_{yu}(\omega)\,S_{uu}^{-1}(\omega),
\end{equation}
with coherence $\gamma^2(\omega)=\frac{\|S_{yu}(\omega)\|^2}{S_{uu}(\omega)\,S_{yy}(\omega)}$ and spectral averaging across $M$ segments. Following \citet{pintelon2012system}, the relative uncertainty of $\hat{G}$ can be summarized by
\begin{equation}
\sigma_{\mathrm{rel}}(\omega)\;\approx\;\sqrt{\frac{1-\gamma^2(\omega)}{2M\,\gamma^2(\omega)}},
\end{equation}
which we translate into a multiplicative uncertainty bound,
\begin{equation}
G(\mathrm{i}\omega) \;=\; \hat{G}(\mathrm{i}\omega)\,\bigl(1 + W_m(\mathrm{i}\omega)\,\Delta_m(\mathrm{i}\omega)\bigr),\qquad \|\Delta_m\|_{\infty}\le 1,
\end{equation}
with a rational weight $W_m(s)$ fitted to $k\,\sigma_{\mathrm{rel}}(\omega)$ (safety factor $k\!\ge\!1$) and shaped to reflect low-frequency process uncertainty and high-frequency noise leakage (E1). Where second-order Volterra effects are significant (E2), we retain a linear surrogate for control design and treat nonlinear distortions as an additive uncertainty channel $d_{\mathrm{nl}}$ confined to harmonics and intermodulation bands characterized in E2; this is conservative yet tractable for robust synthesis.

To enable state-space synthesis and MPC, we fit a low-order rational model $\hat{G}(s)\approx C(sI-A)^{-1}B + D$ by vector fitting on the identified band (monthly to interannual). In parallel, we train a Koopman-regressed linear predictor on the same inputs/outputs to capture multi-output dynamics with minimal state dimension, ensuring consistency with $\hat{G}$ on the identified band (E2).

\paragraph{Generalized plant and performance channels.}
We construct a generalized plant $P$ with exogenous disturbances $w=[d_{\mathrm{int}},\,d_{\mathrm{volc}},\,n]^\top$ (internal variability, volcanic forcing, measurement noise), control $u$, measured outputs $y$, and performance variables $z$,
\begin{equation}
z \;=\; 
\begin{bmatrix}
W_T(s)\,e_T \\[3pt]
W_H(s)\,y_H \\[3pt]
W_S(s)\,y_{\mathrm{SAOD}} \\[3pt]
W_u(s)\,\Delta u
\end{bmatrix},
\qquad
e_T \equiv y_T - r_T,\quad \Delta u \equiv \frac{\mathrm{d}}{\mathrm{d}t}u,
\end{equation}
where $W_T$ emphasizes low-frequency GMST tracking, $W_H$ penalizes interannual precipitation anomalies, $W_S$ limits SAOD excursions, and $W_u$ regularizes actuation variability (a frequency-domain proxy for total variation). Weight magnitudes and break frequencies are chosen from the identified Bode gains and lags (E2) and scaled by parameter covariance from the Fisher information design (E1), prioritizing bands with high identifiability and de-emphasizing poorly observed frequencies. The multiplicative uncertainty $W_m(s)$ closes around the plant input-output pair used for $y_T$ and $y_H$.

\paragraph{Multi-plant $H_\infty$ synthesis with spectral uncertainty.}
We seek a dynamic output-feedback controller $K$ that achieves robust stability and performance across:
(i) the multiplicative uncertainty ball defined by $W_m$;
(ii) a multi-plant set $\mathcal{P}$ spanning models and operating points from tiers (E5).
The synthesis problem is
\begin{equation}
\min_{K} \;\gamma \quad \text{s.t.}\quad \sup_{P\in\mathcal{P}}\;\sup_{\|\Delta_m\|_\infty\le 1}\;\bigl\|T_{zw}(P,\Delta_m,K)\bigr\|_{\infty} \;<\; \gamma.
\end{equation}
We employ standard loop-shaping choices: $W_T(s)=\frac{s/M_T+\omega_{b,T}}{s+\omega_{b,T}\,\epsilon_T}$ to enforce integral action up to an interannual bandwidth $\omega_{b,T}$; $W_H(s)$ as a low-pass emphasizing 0.1–1 yr$^{-1}$ bands identified as hydrologically sensitive; $W_S$ as a low-pass barrier around the SAOD constraint; and $W_u(s)$ as a high-pass to attenuate sub-seasonal injection variability. The $H_\infty$ controller guarantees an upper bound $\gamma$ on the worst-case closed-loop gain from disturbances (including unmodeled harmonics) to weighted performance, translating into explicit limits on tracking error, precipitation variability, SAOD deviations, and actuation effort over the designed band. Multi-plant synthesis promotes cross-model robustness critical for transfer from idealized to chemistry-resolving ESMs \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}.

\paragraph{Robust MPC for constraint handling and scenario planning.}
To explicitly enforce state and output constraints under time-varying scenarios (e.g., ENSO modulation, exogenous eruptions), we formulate a monthly robust MPC using the Koopman-regressed linear predictor,
\begin{align}
x_{k+1} &= A x_k + B u_k + E w_k, \qquad y_k = C x_k,\\
\min_{\{u_{k+i}\}} \; J &= \sum_{i=0}^{N-1} \bigl(\|W_T (y_{T,k+i}-r_{k+i})\|_2^2 + \|W_H y_{H,k+i}\|_2^2 \nonumber\\
&\quad + \|W_S y_{\mathrm{SAOD},k+i}\|_2^2 + \|W_u \Delta u_{k+i}\|_2^2 \bigr) + \|W_f x_{k+N}\|_2^2,
\end{align}
subject to mixed hard/chance constraints,
\begin{equation}
\|y_{\mathrm{SAOD},k+i}\|_\infty \le b_S,\quad \mathbb{P}\bigl( |y_{H,k+i}| \le b_H \bigr)\ge 1-\alpha,\quad u_{\min}\le u_{k+i}\le u_{\max},
\end{equation}
and a tube or distributionally robust uncertainty model calibrated from E1–E2 residuals. This formulation naturally incorporates:
(i) disturbance forecasts or scenarios (e.g., a volcanic SAOD pulse injected as $w_k$);
(ii) actuator slew limits via costs on $\Delta u$;
(iii) explicit trade-offs between GMST tracking and regional hydrology through weights $(W_T,W_H)$.
In the experiments (E3), we compare the robust $H_\infty$ controller, robust MPC, continuous injection, and naive square-wave pulsing under ENSO-like stochasticity and eruption scenarios, evaluating tracking error, constraint violations, controller effort, and regret relative to an oracle with access to the true model.

\paragraph{Design links to active spectroscopy and early warning.}
The identification covariance and coherence from E1 directly inform $W_m(s)$ and weight selection, tying experiment design to control robustness \citep{ljung1999system,pintelon2012system}. As baseline forcing increases (E4), drift of the identified phase toward $-\pi$ at key interannual bands signals reduced phase margin; we implement an automated guardrail that tightens $W_u$ and relaxes $W_T$ when phase margins erode, and raises $W_H$ if harmonic distortion growth indicates rising nonlinearity, providing a control-relevant early warning that complements variance/autocorrelation diagnostics. This closed-loop spectroscopic monitoring operationalizes the hypothesis that active, frequency-resolved probing yields earlier and more actionable signals of instability than passive observation.

\paragraph{Practical considerations and governance.}
Large-ensemble resources (e.g., CESM1(WACCM) protocols) provide the variability baselines necessary to stress-test controllers \citep{tilmes2018stratospheric,richter2022assessingresponses}. Robust control does not eliminate deep uncertainties or distributional ethical concerns \citep{robock200820reasons}, but it offers explicit, auditable performance and safety margins under model error and variability, aligning with calls for carefully scoped research \citep{keith2010researchon}. Our design transparently exposes trade-offs (e.g., GMST tracking versus regional precipitation stability), making it suitable for governance contexts that require quantified uncertainty and constraint satisfaction.

\paragraph{Outcomes.}
We expect:
(i) controllers that achieve lower tracking error and fewer hydrological constraint violations than continuous and naive pulsed baselines under the same variability;
(ii) quantifiable robustness margins linked to spectral identifiability;
(iii) cross-model transfer of controllers with limited performance degradation (E5);
(iv) practical bounds on probe amplitudes and experiment lengths needed to realize these gains (E6).
These deliverables advance temporal strategy optimization for SAI by unifying information-optimal probing, spectral system identification, and robust control synthesis within standard Earth system modeling workflows.


% === AREA: Early warning signals for climate tipping points and instability. ===

\subsection{Active early-warning via frequency-resolved phase drift and harmonic growth}

Early-warning signals (EWS) for approaching instabilities typically leverage increases in variance and lag-1 autocorrelation associated with critical slowing down, but these passive indicators require long, stationary records and are easily confounded by exogenous variability in the Earth system \citep{enhanced_5_20250812}. Our framework exploits designed inputs to estimate the frequency response and nonlinear distortions of the injection-to-climate map in sliding time windows, yielding EWS that are intrinsically referenced to the known excitation and thus achieve higher signal-to-noise and shorter lead times. The approach builds on frequency-domain system identification and optimal input design \citep{ljung1999system,pintelon2012system,enhanced_6_20250812}, and it is compatible with state-of-the-art SAI modeling experiments and ensembles \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} and with closed-loop geoengineering analyses \citep{macmartin2014dynamicsof}. We focus on two complementary indicators that emerge naturally from active spectroscopy: (i) drift of the Bode phase toward $-\pi$ at energy-containing bands, and (ii) growth of harmonic and intermodulation products produced by weak nonlinearities.

Let $u(t)=\bar{u}(t)+\delta u(t)$ be the SAI mass injection rate, with a small-amplitude multi-sine probe
\begin{equation}
\delta u(t)=\sum_{\ell=1}^{L} a_\ell \sin\!\big(2\pi f_\ell t + \varphi_\ell\big), \quad f_\ell\in[0.02,2]\ \text{yr}^{-1}, \quad \text{RMS}(\delta u)\in[0.05,0.5]\ \text{TgS/yr},
\label{eq:probe}
\end{equation}
superimposed on a baseline scenario $\bar{u}(t)$ (e.g., ARISE-SAI-like trajectories \citep{richter2022assessingresponses}). For an output $y(t)$ (e.g., GMST, monsoon indices, Sahel JJA precipitation, QBO winds), we estimate in each sliding window $W_k$ of length $\tau$ years the complex frequency response $\hat{G}_k(\omega)$ from $u$ to $y$ via spectral regression with leakage correction and coherence-weighted least squares \citep{pintelon2012system}:
\begin{equation}
\hat{G}_k(\omega)=\frac{\hat{S}_{yu,k}(\omega)}{\hat{S}_{uu,k}(\omega)}, 
\quad 
\gamma_k^2(\omega)=\frac{|\hat{S}_{yu,k}(\omega)|^2}{\hat{S}_{uu,k}(\omega)\,\hat{S}_{yy,k}(\omega)},
\label{eq:frf}
\end{equation}
where $\hat{S}_{(\cdot)(\cdot),k}$ are multitaper or Welch spectra computed on $W_k$ and $\gamma_k^2\in[0,1]$ is the magnitude-squared coherence, used both as an uncertainty metric and for frequency weighting \citep{pintelon2012system,enhanced_9_20250812}.

Phase-drift indicator. Define the unwrapped phase $\hat{\phi}_k(\omega)=\operatorname{unwrap}\!\big(\arg\hat{G}_k(\omega)\big)$ and a reference phase $\hat{\phi}_0(\omega)$ obtained from an initial baseline window $W_0$. We track the coherence-weighted phase drift
\begin{equation}
\Delta \Phi_k=\frac{\sum_{\omega\in\mathcal{F}} \gamma_k^2(\omega)\,w(\omega)\,\Delta \phi_k(\omega)}{\sum_{\omega\in\mathcal{F}} \gamma_k^2(\omega)\,w(\omega)},
\quad 
\Delta \phi_k(\omega)=\operatorname{wrap}_{(-\pi,\pi]}\!\big(\hat{\phi}_k(\omega)-\hat{\phi}_0(\omega)\big),
\label{eq:phasedrift}
\end{equation}
over a design band $\mathcal{F}$ spanning monthly-to-interannual scales, with $w(\omega)$ chosen proportional to the probe spectral density or to the Fisher information contribution at $\omega$ \citep{ljung1999system,enhanced_6_20250812,enhanced_2_20250812}. In a linearized setting, reductions in effective phase margin as external forcing or control intensity increases manifest as drift of $\hat{\phi}_k$ toward $-\pi$ at the gain-crossover neighborhood; thus large negative $\Delta\Phi_k$ indicates erosion of stability buffers in open-loop diagnostics, and can be mapped to loop stability when a candidate controller $K$ is known via $\hat{L}_k(\omega)=K(\omega)\hat{G}_k(\omega)$ \citep{macmartin2014dynamicsof,pintelon2012system}.

Harmonic-distortion indicator. Weak nonlinearities generate energy at harmonics and intermodulation frequencies of the probe tones. Let $\mathcal{F}_1=\{f_\ell\}$ denote the fundamentals, $\mathcal{F}_\mathrm{H}=\{2f_\ell,3f_\ell\}$ the low-order harmonics, and $\mathcal{F}_\mathrm{IM}=\{|f_\ell\pm f_m|:\ell\neq m\}$ the pairwise intermodulation set. We define the harmonic distortion index (HDI) in window $W_k$ as
\begin{equation}
\mathrm{HDI}_k=\frac{\sum_{\nu\in\mathcal{F}_\mathrm{H}\cup\mathcal{F}_\mathrm{IM}} \hat{P}_{y,k}(\nu)}{\sum_{\omega\in\mathcal{F}_1} \hat{P}_{y,k}(\omega)},
\label{eq:hdi}
\end{equation}
where $\hat{P}_{y,k}$ denotes the line-spectral power after leakage correction. In parallel, the second-order Volterra kernel $\hat{H}_{2,k}$ estimated from multi-sine or PRBS experiments \citep{ljung1999system,enhanced_12_20250812,enhanced_3_20250812} provides a parametric nonlinear growth metric $J_{2,k}=\|\hat{H}_{2,k}\|_F$. Growth in $\mathrm{HDI}_k$ and $J_{2,k}$ signals strengthening cross-frequency coupling that often precedes qualitative regime changes \citep{enhanced_5_20250812}.

Composite EWS and sequential testing. We aggregate standardized indicators into a composite score
\begin{equation}
\mathrm{EWS}_k=\alpha\,Z(\Delta\Phi_k)+\beta\,Z(\mathrm{HDI}_k)+\gamma\,Z(J_{2,k}),
\label{eq:ews}
\end{equation}
with $(\alpha,\beta,\gamma)$ selected by maximizing detection power in training scenarios while controlling false discovery across frequencies via an FDR procedure. We implement a sequential generalized likelihood ratio test on $\mathrm{EWS}_k$ to detect change points as baseline forcing or SAI intensity is ramped \citep{enhanced_2_20250812}. Because the indicators are tied to the known input spectrum, detection can be based on short windows $\tau\approx 3$–$5$ years with improved identifiability relative to passive variance/autocorrelation approaches that assume slow-roll dynamics and require longer stationary segments \citep{pintelon2012system,enhanced_5_20250812}.

Experimental design and evaluation. In E4, we gradually increase $\bar{u}(t)$ to offset stronger greenhouse forcing while maintaining a small, fixed RMS of $\delta u(t)$ and a persistent set of tones $\mathcal{F}$ chosen by Fisher information maximization under variance and ozone constraints \citep{enhanced_6_20250812,ljung1999system,tilmes2018stratospheric}. We compute $\Delta\Phi_k$, $\mathrm{HDI}_k$, and $J_{2,k}$ for GMST, regional hydroclimate indices, circulation diagnostics (e.g., QBO), and SAOD. Performance is quantified by (i) detection lead time relative to predefined instability or constraint-violation events in the model, (ii) area under the ROC curve (AUC) for event prediction, and (iii) robustness across internal variability, ensembles, and models (E5) \citep{kravitz2011thegeoengineering,richter2022assessingresponses}. Comparisons against passive EWS based on variance and lag-1 autocorrelation assess whether active, frequency-resolved indicators deliver earlier and more reliable warnings under the nonstationary forcing and colored noise typical of SAI scenarios \citep{enhanced_5_20250812}.

Integration with control. When a candidate controller is in the loop, the same machinery yields online estimates of loop gain and phase margins from $\hat{L}_k(\omega)$, enabling risk-aware supervisory logic: if margins fall below thresholds, controller aggressiveness is reduced or the operating point is adjusted \citep{macmartin2014dynamicsof}. This bridges identification and robust control design in our pipeline and operationalizes governance-relevant safety constraints \citep{robock200820reasons,keith2010researchon}. Because the probes are small amplitude and information-optimized, the procedure is minimally invasive and can be executed within the simulation campaigns already used to assess SAI strategies \citep{tilmes2018stratospheric,richter2022assessingresponses}.


% === AREA: Fisher information maximization for experimental design in complex systems. ===

\subsection{Information-optimal active probes via Fisher information}
\label{subsec:fim_design}

A central pillar of our framework is to treat pulsed SAI as an experiment whose informativeness can be quantified and optimized before simulation. We use Fisher information to design band-limited multi-sine, PRBS, and chirp inputs that maximize identifiability of frequency response and low-order nonlinearities under realistic constraints on amplitude, sulfate burden, and environmental risk. This approach connects mature optimal input design from system identification to Earth system experiments \cite{ljung1999system,pintelon2012system}, and embeds within established SAI protocols and modeling platforms \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. It is also consistent with risk-aware calls for carefully designed, small-amplitude research perturbations rather than large-scale trials \cite{keith2010researchon,robock200820reasons}.

We consider discrete-time monthly dynamics around a steady SAI baseline in an Earth system model,
\begin{equation}
y_t \;=\; G(q;\,\theta)\,u_t \;+\; d_t \;+\; e_t,
\quad t=1,\ldots,T,
\label{eq:ltimodel}
\end{equation}
where $u_t$ is the small-amplitude probe superimposed on baseline injection, $y_t\in\mathbb{R}^{p}$ are outputs (e.g., GMST, regional precipitation indices, circulation metrics), $G(q;\theta)$ is a locally LTI multiple-input multiple-output (MIMO) operator parameterized by $\theta$ (e.g., a low-order rational FRF in the frequency domain), $d_t$ captures internal variability/process noise (colored, approximately Gaussian on monthly scales), and $e_t$ is measurement/diagnostic noise. For small-amplitude probes, this linearization is standard \cite{ljung1999system,pintelon2012system}; identified residual structure motivates second-order Volterra augmentation downstream. We explicitly design $u_t$ to be persistently exciting over monthly–interannual bands while respecting operational and environmental constraints drawn from ARISE-SAI and GeoMIP practice \cite{kravitz2011thegeoengineering,richter2022assessingresponses}.

For periodic multisines with lines at $\Omega=\{\omega_j\}_{j=1}^{m}$ and complex amplitudes $U_j$ (random phases to reduce crest factor), the expected Fisher information for $\theta$ under Gaussian colored noise admits a frequency-domain approximation \cite{pintelon2012system}:
\begin{equation}
\mathcal{I}(\theta;U) \;\approx\; \frac{T}{2}\sum_{\omega_j\in\Omega}
\big[\partial_\theta G(i\omega_j;\theta)\,U_j\big]^{\!*}\, S_{\varepsilon}^{-1}(\omega_j)\,
\big[\partial_\theta G(i\omega_j;\theta)\,U_j\big],
\label{eq:fim}
\end{equation}
where $S_{\varepsilon}(\omega)$ is the output noise cross-spectral density of $d_t+e_t$, and $(\cdot)^{*}$ denotes conjugate transpose. Equation \eqref{eq:fim} makes clear three levers: allocate power $|U_j|^2$ where (i) the model is most sensitive, via the Jacobian $\partial_\theta G(i\omega_j;\theta)$, and (ii) the climate noise is weak, via $S_{\varepsilon}^{-1}(\omega_j)$; and (iii) extend duration $T$ to linearly accumulate information (with diminishing returns at very low frequencies due to red noise and leakage).

We pose input design as a convex optimal design problem in the line powers $p_j \equiv |U_j|^2$:
\begin{equation}
\begin{aligned}
\max_{\{p_j\ge 0\}} \quad & \Phi\!\left(\sum_{\omega_j\in\Omega} p_j\, M_j(\theta)\right) \\
\text{s.t.}\quad & \sum_{\omega_j\in\Omega} p_j \le P,\;\; 0\le p_j \le \bar{p}_j, \\
& \mathbb{E}\big[\text{SAOD}(u)\big] \le \text{SAOD}_{\max},\;\; \|u\|_\infty \le u_{\max},
\end{aligned}
\label{eq:design}
\end{equation}
where $M_j(\theta)\!:=\!\frac{T}{2}\,\partial_\theta G(i\omega_j;\theta)^{\!*} S_{\varepsilon}^{-1}(\omega_j)\partial_\theta G(i\omega_j;\theta)$, $P$ is the total probe power budget, $\bar{p}_j$ enforce per-line and band-specific bounds (e.g., to avoid QBO-sensitive bands), and $\Phi$ is a concave information criterion, e.g., D-optimality $\Phi(M)=\log\det M$ or A-optimality $\Phi(M)=-\mathrm{tr}(M^{-1})$ \cite{ljung1999system}. Maximizing a concave $\Phi$ over a convex set yields a convex program solvable efficiently; per-line bounds and linear SAOD proxies embed environmental guardrails from prior SAI protocols \cite{richter2022assessingresponses,tilmes2018stratospheric}. PRBS and chirps are covered by replacing the discrete sum with a Riemann integral over their power spectral densities $\Phi_u(\omega)$ \cite{ljung1999system,pintelon2012system}.

Because $\theta$ is uncertain a priori, we adopt a robust/Bayesian design:
\begin{equation}
\max_{\{p_j\}}\;\; \mathbb{E}_{\theta\sim\pi}\big[\Phi(M(p,\theta))\big]
\quad\text{or}\quad
\max_{\{p_j\}}\;\; \min_{\theta\in\Theta}\, \Phi\big(M(p,\theta)\big),
\label{eq:robust}
\end{equation}
with $\pi$ formed from pre-experiments or literature ranges and $\Theta$ a credible set. This guards against local misspecification and promotes designs that remain informative when the true FRF deviates from the linearization point \cite{ljung1999system}. In practice we (i) estimate $S_{\varepsilon}(\omega)$ from baseline runs (no probes) using multitaper spectral estimates to capture red noise; (ii) initialize $\theta$ via coarse spectral regression \cite{pintelon2012system}; and (iii) solve \eqref{eq:design}–\eqref{eq:robust} on a frequency grid spanning monthly to interannual bands (0.02–2 cycles/year), consistent with our E1 protocol.

Phase selection minimizes crest factor and spectral leakage while enabling nonlinear diagnostics. We use random-phase multisines combined with iterative phase optimization to reduce the crest factor subject to fixed $\{p_j\}$, thereby staying within instantaneous injection bounds \cite{pintelon2012system}. To expose second-order Volterra effects without intermodulation overlap, we partition $\Omega$ into disjoint odd/even line sets so that generated harmonics ($2f$) and sum/difference tones ($f_1\pm f_2$) fall into unexcited bins, enabling clean estimation and sparsity-regularized recovery of second-order kernels in E2 \cite{pintelon2012system}. PRBS designs provide an alternative with approximately white spectra over a chosen band and are classical in closed-loop settings \cite{ljung1999system}.

The resulting design offers clear, quantitative trade-offs for E6. Since $\mathcal{I}\propto T$ and (locally) $\mathcal{I}\propto p_j$, the Cramér–Rao bound scales roughly as $\mathrm{Cov}(\hat{\theta})\simeq \mathcal{I}^{-1} = \mathcal{O}\big((TP)^{-1}\big)$ when leakage and red-noise saturation are controlled. This yields practical curves of probe amplitude versus experiment length to reach target prediction errors, conditioned on the observed $S_{\varepsilon}(\omega)$ and chosen bands. Moreover, by explicitly down-weighting low-frequency bands with high climate noise (large $S_{\varepsilon}$), the design avoids over-investing where passive variability dominates and concentrates power near months-to-few-years bands where SNR and sensitivity are high—precisely where questions about temporal modulation matter most.

Finally, our information design dovetails with control and monitoring. The same band-limited probes that maximize $\mathcal{I}$ produce high-coherence FRF estimates for Bode gain/phase over controller-relevant bands, improving H-infinity/MPC synthesis and robustness margins \cite{ljung1999system,pintelon2012system,macmartin2014dynamicsof}. Repeated application in sliding windows supports sequential re-estimation, with Fisher information serving as a design-time proxy for the power of change-detection tests on phase drift and harmonic growth (E4). Together with established SAI modeling efforts \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}, this information-theoretic layer makes active spectroscopy minimally invasive yet maximally informative for both identification and governance-relevant risk metrics \cite{keith2010researchon,robock200820reasons}.


% === AREA: Cross-model validation techniques for climate models and surrogate models. ===

\subsection{Cross-model validation and transferability (E5)}
\label{sec:cross_model_validation}
A central requirement for actionable active-sensing of the climate is that identified dynamics and controllers transfer across models of differing complexity and formulation. The geoengineering community has repeatedly highlighted the necessity of cross-model comparison to avoid artifact-driven conclusions and to expose structural uncertainty (e.g., GeoMIP intercomparisons of SAI forcing patterns and impacts) \citep{kravitz2011thegeoengineering}, and large-ensemble protocols in chemistry–climate models provide the variance-resolving datasets needed to quantify such uncertainty \citep{tilmes2018stratospheric,richter2022assessingresponses}. We therefore formalize the cross-model robustness experiment (E5) as a set of invariance tests on frequency responses and nonlinear distortion, together with controller portability and stability-margin assessments, using frequency-domain system identification tools \citep{ljung1999system,pintelon2012system} and closed-loop control diagnostics \citep{macmartin2014dynamicsof}.

We consider two tiers of models: (a) an idealized aquaplanet or EMIC used for rapid iteration and input design, and (b) an Earth system model with interactive stratospheric aerosols and, where available, stratospheric chemistry (e.g., CESM(WACCM)-class) \citep{tilmes2018stratospheric,richter2022assessingresponses}. In each model \(m\), we superimpose the same information-optimized probe \(u(t)\) (multi-sine/PRBS/chirp) on a common SAI baseline and estimate: (i) the best-linear-approximation frequency response \(H_m(\omega)\) from injection rate to outputs via spectral regression with leakage correction and coherence weighting \citep{pintelon2012system}; and (ii) a sparse second-order Volterra representation capturing harmonic and intermodulation terms. The following cross-model metrics operationalize transferability.

1) Frequency-response consistency. Let \(\widehat{H}_m(\omega)\) be the estimated FRF and \(\gamma_m^2(\omega)\) the output–input coherence. We define a coherence-weighted Bode distance between models \(m,n\):
\[
d_{\mathrm{FRF}}(m,n)
=
\left(
\int_{\Omega}
w(\omega)\,\gamma_m(\omega)\,\gamma_n(\omega)\,
\left[
\big(\log|\widehat{H}_m|-\log|\widehat{H}_n|\big)^2
+
\operatorname{wrap}_{\pi}\!\big(\angle \widehat{H}_m-\angle \widehat{H}_n\big)^2
\right]
\,\mathrm{d}\omega
\right)^{\!1/2},
\]
with band-weights \(w(\omega)\) emphasizing monthly-to-interannual bands used for control. Small \(d_{\mathrm{FRF}}\) indicates an invariant linear pathway from SAI to the chosen output across models, whereas discrepancies localize frequency bands where Tier-(b) physics modifies gain or phase (e.g., aerosol–chemistry–QBO couplings).

2) Nonlinear distortion consistency. For a multi-sine probe with excited lines \(\{\omega_k\}\), define the harmonic distortion index
\[
\mathrm{HDI}_m = \frac{\sum_{h\ge 2}\sum_{k} S_{y,m}(\omega_h=\!h\omega_k)}{\sum_{k} S_{y,m}(\omega_1=\!\omega_k)},
\]
where \(S_{y,m}\) is the output line power. Cross-model nonlinear invariance is summarized by
\[
d_{\mathrm{HDI}}(m,n) = \left(\sum_{h,k} \alpha_{h,k}\,[\mathrm{HDI}_{m}(h\omega_k)-\mathrm{HDI}_{n}(h\omega_k)]^2\right)^{\!1/2},
\]
with \(\alpha_{h,k}\) reflecting scientific or operational priorities (e.g., penalties on interannual intermodulation near ENSO bands). This complements the FRF by testing whether the same weakly nonlinear distortions occur across models \citep{pintelon2012system}.

3) Surrogate generalization. Let \(\widehat{\mathcal{M}}_m\) denote a compact surrogate identified in model \(m\) (frequency-domain ARX/BLA, Koopman-regressed linear predictor, or sparse Volterra). The cross-model prediction error on model \(n\) under held-out probes \(u^{\mathrm{val}}\) is
\[
\varepsilon_{\mathrm{gen}}(m\!\rightarrow\!n)=
\frac{\|y_n - \widehat{\mathcal{M}}_m[u^{\mathrm{val}}]\|_2}{\|y_n\|_2},
\]
reported per-output and per-band. Low \(\varepsilon_{\mathrm{gen}}\) indicates that the learned operators capture model-invariant structure; high error pinpoints components that require model-specific augmentation.

4) Controller portability and robust margins. A controller \(K_m\) synthesized from \(\widehat{\mathcal{M}}_m\) is deployed in closed loop on model \(n\). We report regret relative to an oracle \(K_n^\star\) that knows model \(n\):
\[
\mathcal{R}(K_m;n) = J_n(K_m) - J_n(K_n^\star),
\]
for a multi-objective cost \(J_n\) combining GMST tracking, regional precipitation variance constraints, SAOD limits, and effort (total variation), as in E3. To quantify stability robustness, we form a multiplicative-uncertainty envelope around a reference FRF \(\widehat{H}_{\mathrm{ref}}\) by
\[
W(\omega) = \sup_{q\in\{m,n,\ldots\}} \left| \frac{\widehat{H}_q(\omega)-\widehat{H}_{\mathrm{ref}}(\omega)}{\widehat{H}_{\mathrm{ref}}(\omega)} \right|,
\quad
\Delta_q(\omega)=\frac{\widehat{H}_q(\omega)-\widehat{H}_{\mathrm{ref}}(\omega)}{\widehat{H}_{\mathrm{ref}}(\omega)},
\]
and evaluate the classical sufficient condition for robust stability, \(\sup_{\omega} |W(\omega)\,T_{\mathrm{ref}}(\omega)|<1\), where \(T_{\mathrm{ref}}\) is the complementary sensitivity with \(K_m\). This yields frequency-resolved margins that directly trace to inter-model discrepancies \citep{pintelon2012system,macmartin2014dynamicsof}.

5) Early-warning invariance. Under slowly increasing baseline forcing, we track phase-lag drift \(\Delta\phi_m(\omega;F)\) and HDI growth \(\Delta\mathrm{HDI}_m(F)\) versus forcing level \(F\). We compare the forcing at which thresholds are crossed across models and report detection lead-time deltas relative to passive variance/autocorrelation baselines, thereby testing whether spectroscopy-based early warnings are model-invariant in their qualitative behavior.

Implementation details. To ensure comparability, we use identical probe spectra, phases, and PRBS seeds across models, and we align analysis windows to common seasonal calendars. Spectral estimates use leakage-robust regression, transient gating, and multitaper averaging; coherence thresholds screen poorly excited bands \citep{pintelon2012system}. Ensembles from Tier-(b) models (e.g., CESM(WACCM) large ensembles and ARISE-SAI protocols) are leveraged to reduce sampling error and to bootstrap uncertainty on \(d_{\mathrm{FRF}}\), \(d_{\mathrm{HDI}}\), and \(\varepsilon_{\mathrm{gen}}\) \citep{tilmes2018stratospheric,richter2022assessingresponses}. When cross-model gaps concentrate in specific bands, we augment the probe there in a follow-on identifiability cycle (E1), consistent with optimal input design principles \citep{ljung1999system,pintelon2012system}.

Relation to prior intercomparisons and governance. Unlike one-off scenario intercomparisons that aggregate over time \citep{kravitz2011thegeoengineering}, the proposed spectroscopy-based validation isolates frequency-local pathways and weak nonlinearities that determine controller design and early-warning performance. The use of existing SAI protocols and ensembles ensures feasibility \citep{tilmes2018stratospheric,richter2022assessingresponses}; closed-loop tests follow prior demonstrations that feedback can be implemented in climate models \citep{macmartin2014dynamicsof}. By explicitly quantifying where and how surrogate dynamics and controllers fail to transfer, this section provides the uncertainty bounds and robustness diagnostics needed for risk-aware assessment of temporally modulated SAI, complementing broader cautions about intervention risks \citep{robock200820reasons} and calls for carefully designed research \citep{keith2010researchon}.


% === AREA: Uncertainty quantification methods in climate modeling and control. ===

\subsection{Uncertainty quantification for active spectroscopy and robust SAI control}
Active spectroscopy of the climate under stratospheric aerosol injection (SAI) must be designed, interpreted, and controlled under deep uncertainty arising from internal variability, observational and estimator noise, and model-structure error. Large-ensemble SAI experiments and intercomparisons demonstrate substantial spread in both mean responses and regional impacts, underscoring the need to quantify and propagate uncertainty through identification, control synthesis, and early-warning stages \citep{tilmes2018stratospheric,kravitz2011thegeoengineering,richter2022assessingresponses}. Moreover, governance concerns emphasize the importance of robust, risk-aware decision support for any active perturbation to the climate system \citep{robock200820reasons,keith2010researchon}. Here we formalize an uncertainty quantification (UQ) layer that integrates with our identification–control pipeline and grounds the experimental design (E1–E6) in information-theoretic principles and robust control theory.

\paragraph{Uncertainty-aware identification in the frequency domain}
We model the response of climate outputs y(t) to small-amplitude, information-optimized SAI inputs u(t) by a low-order, weakly nonlinear surrogate: a linear time-invariant component H(q;\theta) and a second-order Volterra operator V^{(2)}(\cdot;\eta), with residual e(t):
\[
y(t) \;=\; H(q;\theta)\,u(t)\;+\;V^{(2)}\!\big[u\big](t;\eta)\;+\;e(t), \quad e(t)\sim \mathcal{E},
\]
where \theta and \eta collect linear and quadratic parameters, respectively, and \mathcal{E} captures internal variability and measurement noise. Under multi-sine and PRBS perturbations designed to be periodic over the record, spectral regression yields consistent estimates of the frequency response function (FRF) G(\omega;\theta) and second-order kernels, with well-characterized sampling distributions \citep{pintelon2012system,ljung1999system,enhanced_9_20250812}. For a set of excited lines \Omega and output-noise spectral density S_e(\omega), the (block) Fisher information for \theta under a linearized model is
\[
\mathcal{I}_{\theta}
\;=\;
\sum_{\omega\in\Omega}
\Big(\partial_{\theta}G(\omega)\Big)^{\!\top}
\,S_e^{-1}(\omega)\,
\Big|U(\omega)\Big|^2
\Big(\partial_{\theta}G(\omega)\Big),
\]
where |U(\omega)|^2 is shaped by the probe amplitudes and phases \citep{pintelon2012system}. For the quadratic terms, with feature vector \phi(t) comprising polynomial–convolution terms of u at selected lags, the information matrix approximates \mathcal{I}_{\eta}\approx X^{\top}W X, where X is the feature design matrix in the spectral or time domain and W weights by spectral estimate variances; sparsity-promoting estimators reduce variance and mitigate overfitting of Volterra kernels \citep{enhanced_12_20250812,ljung1999system}.

Input design solves a constrained optimal-excitation problem to maximize identification quality subject to safety and resource limits:
\[
\max_{a_k,\phi_k}\;\Phi\!\big(\mathcal{I}_{\theta,\eta}(a_k,\phi_k)\big)
\;\;\text{s.t.}\;\;
\mathrm{RMS}(u)\leq \bar{u},\;
\text{SAOD and ozone constraints},\;
\text{band limits},
\]
with \Phi chosen as D- or A-optimality to minimize posterior volume or average variance \citep{ljung1999system,pintelon2012system,enhanced_6_20250812,enhanced_2_20250812}. Periodic multisine designs minimize leakage and bias \citep{pintelon2012system}. The experiment-length, amplitude, and ensemble-size trade-off follows from \mathcal{I}\propto T\,\mathrm{SNR} (approximately), enabling practicality bounds in E6.

\paragraph{Posterior inference and propagation to frequency-domain targets}
We adopt a hybrid frequentist–Bayesian UQ. Spectral regression yields (\hat{\theta},\hat{\eta}) with asymptotic covariance \Sigma_{\theta,\eta}\approx \mathcal{I}^{-1}, which we combine with weakly informative priors to obtain Gaussian posteriors for small-signal regimes. For any smooth functional f of the identified model—e.g., Bode magnitude |G(\omega)|, phase \angle G(\omega), harmonic distortion index (HDI), or cross-frequency gains—the delta method provides
\[
\mathrm{Var}\big[f(\hat{\theta},\hat{\eta})\big]
\;\approx\;
\nabla f^{\top}\,\Sigma_{\theta,\eta}\,\nabla f,
\]
yielding credible intervals over frequency that we report alongside point estimates in E2. This propagation is essential for comparing pulsed schedules to continuous baselines on equal footing and for quantifying the incremental value of active information relative to passive observation \citep{enhanced_2_20250812,enhanced_9_20250812}.

\paragraph{From identification uncertainty to robust control}
Closed-loop SAI must tolerate model error and internal variability \citep{macmartin2014dynamicsof}. We represent linear identification error as multiplicative uncertainty
\[
G_{\text{true}}(\omega)=G(\omega)\big(1+W_m(\omega)\Delta(\omega)\big),\quad \|\Delta\|_{\infty}\le 1,
\]
with W_m derived from the FRF posterior bands; nonlinear residuals are bounded by a frequency-weighted HDI. We synthesize controllers by:
- H-infinity design to minimize the worst-case weighted tracking and disturbance amplification, enforcing robust stability for all admissible \Delta and bounded nonlinear distortion \citep{macmartin2014dynamicsof}.
- Chance-constrained MPC with posterior-predictive uncertainty, solving
\[
\min_{u_{0:H-1}}\;\mathbb{E}\!\left[\sum_{t=0}^{H-1}\ell(x_t,u_t)\right]
\quad\text{s.t.}\quad
\mathbb{P}\big(\text{regional precip. constraints}\big)\ge 1-\varepsilon,
\]
via scenario or tube MPC using the identified Koopman-regressed predictors, with risk budgets \varepsilon allocated to regions of concern \citep{enhanced_4_20250812,enhanced_8_20250812}.
We evaluate robust margins, regret versus an oracle, and constraint violation rates in E3, and benchmark against continuous and naive pulsing baselines within ARISE/GeoMIP-like scenarios \citep{richter2022assessingresponses,kravitz2011thegeoengineering}.

\paragraph{Uncertainty-aware early warning}
We interpret phase-lag drift toward -\pi and HDI growth under ramped forcing as instability precursors, but we require calibrated false-alarm control. We construct sequential detectors on the posterior trajectories \{\angle G(\omega_t), \mathrm{HDI}_t\}, declaring a warning when credible intervals breach design thresholds or when a Bayes factor exceeds a pre-specified limit under a change-point model \citep{enhanced_5_20250812}. Lead-time and AUC are computed against passive variance/autocorrelation baselines with uncertainty bands, ensuring that claimed gains in detection are statistically robust (E4).

\paragraph{Cross-model and ensemble UQ}
Structural uncertainty is addressed by hierarchical pooling across model tiers (idealized to ESM) and ensembles \citep{tilmes2018stratospheric,richter2022assessingresponses}. We treat model-specific parameters (\theta_m,\eta_m) as draws from population hyperparameters, enabling partial pooling of frequency responses and nonlinearities while retaining model idiosyncrasies; posterior predictive checks quantify cross-model generalization and guide controller transfer (E5) \citep{enhanced_11_20250812,enhanced_2_20250812}. Where deep emulators are used to accelerate scenario evaluation, we adopt uncertainty-aware surrogates (e.g., ensembles or Bayesian last layers) and validate them in frequency space to preserve phase and gain fidelity \citep{enhanced_11_20250812}.

\paragraph{Practicality bounds and value of information}
Design variables—probe amplitude, duration, and ensemble size—are chosen to hit target precision at minimal cost. For a line at frequency \omega with noise PSD S_e(\omega), the approximate variance of the estimated FRF magnitude obeys
\[
\mathrm{Var}\big(|\hat{G}(\omega)|\big)\;\approx\;\frac{S_e(\omega)}{2T\,|U(\omega)|^2}\,c(\omega),
\]
where c(\omega) accounts for leakage and windowing \citep{pintelon2012system}. Thus, the Fisher information grows linearly with record length T and quadratically with probe amplitude, while internal variability inflates S_e(\omega). We quantify the marginal value of longer experiments, stronger probes, or larger ensembles via D-optimality gains and adopt an L-curve criterion to balance bias–variance and cost (E6) \citep{ljung1999system,enhanced_2_20250812,enhanced_6_20250812}. These practicality bounds ensure feasibility within academic compute budgets while meeting pre-specified uncertainty targets germane to governance \citep{keith2010researchon,robock200820reasons}.

\paragraph{Reporting and metrics}
Across E1–E6 we report, for each output and band: SNR, posterior FRF and HDI credible intervals, D-/A-optimality values, controller robust-stability margins, chance-constraint satisfaction, worst-case regional anomalies, and early-warning lead times with uncertainty. By quantifying and propagating uncertainty from experiment design through control and monitoring, the framework converts active spectroscopy into decision-grade evidence for risk-aware SAI planning \citep{macmartin2014dynamicsof,tilmes2018stratospheric,richter2022assessingresponses}.


% === AREA: Spectral regression techniques for climate data analysis and system identification. ===

\subsection{Spectral regression for active, frequency-domain system identification}

We estimate the climate system’s best linear approximation (BLA) from stratospheric aerosol injection rate to key outputs by spectral regression on designed, small-amplitude excitations. Frequency-domain identification is well suited to our active spectroscopy setting because it (i) targets specific bands with multi-sine/PRBS/chirp inputs, (ii) yields direct Bode gain/phase with compact uncertainty quantification via coherence, and (iii) cleanly separates stochastic internal variability from input-induced response under random-phase multisine designs \citep{pintelon2012system,ljung1999system}. In climate applications, spectral regression has been used to recover sensitivity and lags from short, noisy simulations \citep{enhanced_9_20250812}, and our design builds on that foundation to exploit dedicated, information-optimized perturbations.

Model and estimator. Let u_t denote the SAI injection rate perturbation (RMS 0.05–0.5 TgS yr^{-1}) superimposed on a baseline scenario consistent with CESM/WACCM and ARISE-SAI protocols \citep{tilmes2018stratospheric,richter2022assessingresponses}, and y_t a climate response (e.g., GMST, Sahel JJA precipitation, QBO index). Over windows where the response is weakly nonlinear and wide-sense stationary around the baseline, we represent
\[
y_t \;=\; G(q^{-1})\,u_t \;+\; d_t \;+\; e_t,
\]
where G is an unknown, stable linear operator (the BLA), d_t collects weak nonlinear distortions, and e_t is zero-mean colored variability (e.g., ENSO, NAO). For a set of K commensurate excitation lines \Omega=\{\omega_k\}, we compute windowed DFTs U(\omega_k), Y(\omega_k) over N_s independent segments (or ensemble members) and the cross- and auto-spectral density estimates
\[
\hat S_{yu}(\omega_k) = \frac{1}{N_s}\sum_{s=1}^{N_s}Y_s(\omega_k)\,U_s(\omega_k)^{\!*}, 
\quad
\hat S_{uu}(\omega_k) = \frac{1}{N_s}\sum_{s=1}^{N_s}U_s(\omega_k)\,U_s(\omega_k)^{\!*}.
\]
The spectral regression (H1) estimate of the frequency response is
\[
\hat G(\omega_k) \;=\; \frac{\hat S_{yu}(\omega_k)}{\hat S_{uu}(\omega_k)},
\]
with asymptotic variance governed by the magnitude-squared coherence
\[
\hat\gamma^2(\omega_k) \;=\; \frac{|\hat S_{yu}(\omega_k)|^2}{\hat S_{yy}(\omega_k)\,\hat S_{uu}(\omega_k)},
\qquad
\mathrm{Var}\big[\hat G(\omega_k)\big] \approx \frac{1}{2N_s}\,\frac{1-\hat\gamma^2(\omega_k)}{\hat\gamma^2(\omega_k)} \;\;\citep{pintelon2012system}.
\]
To mitigate colored-noise bias and leakage, we use (i) commensurate random-phase multisines with guard bins, (ii) local-polynomial leakage correction around each excited line, and (iii) multitaper averaging for very low frequencies (0.02–0.1 cycles yr^{-1}) where segments are long \citep{pintelon2012system}. When identification proceeds under a supervisory controller (e.g., for baseline tracking), we adopt a closed-loop spectral instrumental-variables variant, replacing u_t with an instrument z_t constructed from the programmed multisine to remove feedback bias \citep{ljung1999system}:
\[
\hat G_{\mathrm{IV}}(\omega_k) \;=\; \frac{\hat S_{yz}(\omega_k)}{\hat S_{uz}(\omega_k)}.
\]

Input design by Fisher information. With a prior or pilot estimate of the output-noise PSD S_{ee}(\omega), the frequency-wise Fisher information for G(\omega_k) under a multisine with line power |U(\omega_k)|^2 scales as |U(\omega_k)|^2/S_{ee}(\omega_k) \citep{ljung1999system,pintelon2012system}. We therefore allocate amplitudes across \Omega by a D-optimal (log-det) or A-optimal (trace) criterion subject to amplitude, rate-of-change, and chemistry/safety constraints (e.g., SAOD bounds, QBO perturbation limits), yielding a water-filling-like profile that prioritizes bands with high signal-to-variability ratios \citep{enhanced_6_20250812}. Frequency grids are chosen to avoid dominant internal modes (e.g., QBO at ~0.43 cycles yr^{-1}) while ensuring coverage from monthly to interannual scales (0.02–2 cycles yr^{-1}) as specified in E1.

Nonlinear distortion and Volterra structure. Random-phase multisines permit separation of stochastic variability, linear response, and deterministic nonlinear distortion (harmonics and intermodulation) by allocating detection lines and exploiting unexcited bins \citep{pintelon2012system}. We quantify distortion via a harmonic distortion index (HDI) and, when warranted, fit a second-order Volterra approximation in the frequency domain,
\[
Y(\omega) \;\approx\; G(\omega)\,U(\omega) \;+\; \sum_{\omega_1+\omega_2=\omega} H_2(\omega_1,\omega_2)\,U(\omega_1)\,U(\omega_2),
\]
estimated by sparsity-promoting regression on polynomial-convolution features with cross-validation to prevent overfit (see E2), informed by recent sparse Volterra identification advances \citep{enhanced_12_20250812,ljung1999system}. This provides a compact map from input spectra to output spectra, including cross-frequency coupling needed to interpret interannual modulation of seasonal responses.

MIMO formulation and regularization. For multiple outputs y^{(m)}_t and a multi-point injection vector u^{(p)}_t (e.g., latitude/height channels in emulator experiments), we estimate the MIMO FRF matrix
\[
\mathbf{G}(\omega_k) \;=\; \mathbf{S}_{\mathbf{y}\mathbf{u}}(\omega_k)\,\mathbf{S}_{\mathbf{u}\mathbf{u}}(\omega_k)^{-1},
\]
with Tikhonov or nuclear-norm regularization when \mathbf{S}_{\mathbf{u}\mathbf{u}} is ill-conditioned and with ridge penalties to stabilize poorly observed bands \citep{ljung1999system,pintelon2012system}. This yields directly the cross-variable phase relations exploited by the robust controllers in E3 to trade off global-mean temperature tracking against regional hydrological variability \citep{macmartin2014dynamicsof,enhanced_4_20250812}.

Uncertainty quantification and validation. We report coherence-weighted confidence intervals on |G| and ∠G and use block bootstraps over years or ensemble members to capture low-frequency variability and model stochasticity. Single-tone validation experiments held out from identification provide out-of-sample checks of gain/phase, with coherence and HDI as acceptance metrics (E2). Cross-model robustness is assessed by transferring the identified FRFs and Volterra terms between an idealized model and a coarser-resolution ESM with interactive aerosols and chemistry \citep{tilmes2018stratospheric,richter2022assessingresponses}, following best practices for cross-scale validation and surrogate assessment \citep{enhanced_7_20250812,enhanced_11_20250812}. The approach complements and extends GeoMIP-style scenario comparisons by explicitly resolving temporal pathways and lags \citep{kravitz2011thegeoengineering}.

Link to early warning and control. Phase-lag drift toward -\pi at specific bands and growth in HDI under gradually intensifying forcing provide physics-grounded early-warning indicators of emerging instabilities, which we benchmark against passive variance and autocorrelation metrics in E4 \citep{enhanced_5_20250812}. The identified FRFs and low-order Volterra kernels supply compact, control-ready surrogate dynamics for H-infinity and MPC synthesis (E3), enabling closed-loop SAI strategies that explicitly account for frequency-dependent trade-offs and uncertainty \citep{macmartin2014dynamicsof,enhanced_4_20250812}. Throughout, probe amplitudes remain well below operational injection scales and within bounds motivated by existing SAI simulation protocols and risk considerations \citep{tilmes2018stratospheric,richter2022assessingresponses,robock200820reasons,keith2010researchon}.

Practical guidance. In E1–E2 we target coherence γ^2(ω)\ge 0.6 on priority bands with total experiment lengths of 10–30 years or ensembles thereof, leveraging information-optimal amplitude allocation to minimize runtime. Leakage control (commensurate lines, guard bins, local-polynomial correction) and closed-loop IV variants are essential at low frequencies and when baseline controllers operate. These spectral-regression practices, standard in engineering identification \citep{pintelon2012system,ljung1999system} and increasingly used in climate data analysis \citep{enhanced_9_20250812}, operationalize the core hypothesis: purposefully designed, small-amplitude pulsed SAI acts as a high-information probe that reveals frequency-dependent gains, lags, and distortions more directly and data-efficiently than passive observation or single-impulse experiments.


% === AREA: Pseudo-random binary sequences (PRBS) in climate model excitation. ===

\subsection{Pseudo-random binary sequences (PRBS) for active excitation and MIMO spectral identification}

We integrate pseudo-random binary sequences (PRBS) as a core input class for active spectroscopy of stratospheric aerosol injection (SAI). PRBS inputs deliver broad, near-white spectral content under simple operational constraints (piecewise-constant toggles), are well understood in system identification theory, and admit closed-form identifiability analyses via the Fisher information for both SISO and MIMO settings \citep{ljung1999system,pintelon2012system}. Embedding PRBS micro-perturbations around a steady SAI baseline within established protocols (e.g., GeoMIP, ARISE-SAI, CESM1(WACCM) ensembles) preserves comparability to prior studies \citep{kravitz2011thegeoengineering,richter2022assessingresponses,tilmes2018stratospheric}, while enabling frequency-domain estimation tuned for control design \citep{macmartin2014dynamicsof}. We constrain amplitudes and spectral content to remain within environmental and governance considerations \citep{robock200820reasons,keith2010researchon}.

Rationale. Compared to single-tone or slowly varying ramps, PRBS yields (i) broadband excitation with controllable spectral shaping via the clock period and zero-order hold, (ii) high coherence estimates in the presence of colored internal variability when combined with segment averaging, and (iii) straightforward multi-input designs using low-correlation binary code families to identify cross-channel couplings \citep{ljung1999system,pintelon2012system}. These properties are central to our objective of learning gains, lags, and weak nonlinear distortions across monthly–interannual bands for key outputs (GMST, monsoon indices, regional precipitation, stratospheric winds).

Design. Let the baseline global injection rate be $\bar u$ (TgS yr$^{-1}$). We superimpose a balanced PRBS perturbation
\begin{equation}
u(t) \;=\; \bar u \;+\; a\, s\!\left(\left\lfloor t/T_c \right\rfloor\right), 
\quad s_k \in \{-1,+1\}, \quad \mathbb{E}[s_k]=0,
\label{eq:prbs_u}
\end{equation}
with amplitude $a$ selected so that the RMS modulation lies in the 0.05–0.5 TgS yr$^{-1}$ range (E1), and a clock period $T_c$ chosen to cover target frequencies $\Omega=\{\omega: 0.02\!-\!2\ \text{yr}^{-1}\}$ (interannual to subannual). Piecewise-constant implementation is operationally natural for SAI and yields a continuous-time input power spectral density
\begin{equation}
S_{uu}(\omega) \;\approx\; a^2\, T_c\, \mathrm{sinc}^2\!\left(\tfrac{\omega T_c}{2}\right),
\label{eq:Su}
\end{equation}
for an i.i.d. $\pm 1$ sequence held with zero-order hold at period $T_c$; maximal-length (m-)sequences approximate this spectrum with small line structure and favorable autocorrelation \citep{ljung1999system}. To mitigate spectral notches from the $\mathrm{sinc}^2$ envelope, we combine two or more PRBS streams with different clock periods (multi-rate PRBS) over disjoint time blocks, yielding near-uniform energy across $\Omega$.

MIMO excitation for spatial channels. For $m$ injection channels (e.g., equatorial and subtropical longitudes/latitudes), we assign $m$ binary sequences with low cross-correlation, $s^{(i)}_k\in\{-1,+1\}$, and define
\begin{equation}
u_i(t) \;=\; \bar u_i \;+\; a_i\, s^{(i)}\!\left(\left\lfloor t/T_c \right\rfloor\right),\quad i=1,\dots,m,
\label{eq:mimo_prbs}
\end{equation}
with amplitude vector $a=(a_1,\ldots,a_m)$ constrained by SAOD and stratospheric heating limits. Using code families with near-orthogonal cross-correlation ensures that the input cross-spectral matrix $S_{uu}(\omega)\in\mathbb{C}^{m\times m}$ is well conditioned over $\Omega$, which directly improves MIMO identification accuracy \citep{pintelon2012system}.

Frequency-response estimation. For outputs $y(t)\in\mathbb{R}^p$ (e.g., GMST, indices of Sahel JJA precipitation, QBO/strat winds), we estimate the MIMO frequency response $G(\omega)\in\mathbb{C}^{p\times m}$ via spectral regression
\begin{equation}
\widehat{G}(\omega) \;=\; S_{yu}(\omega)\, S_{uu}(\omega)^{-1},
\label{eq:frf_mimo}
\end{equation}
where $S_{yu}$ and $S_{uu}$ are cross- and auto-spectral density matrices computed with segment averaging and local polynomial leakage correction \citep{pintelon2012system}. For SISO cases, we use the $H_1$/$H_2$ estimators depending on whether input or output noise dominates \citep{pintelon2012system}. Coherence,
\begin{equation}
\gamma^2(\omega) \;=\; \frac{\|S_{yu}(\omega)\|_F^2}{\|S_{uu}(\omega)\|_F \,\|S_{yy}(\omega)\|_F},
\label{eq:coherence}
\end{equation}
guides the choice of $T_c$, $a$, and experiment length to maintain target SNR across $\Omega$ (E1, E6).

Information-optimal PRBS tuning. For a parametric surrogate $G(\omega;\theta)$ with parameter vector $\theta$, the continuous-time Fisher information for Gaussian disturbances with spectrum $S_{ee}(\omega)$ satisfies \citep{ljung1999system,pintelon2012system}
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \frac{T}{2\pi}\int_{\Omega}
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\right]^H
S_{uu}(\omega)\,
\left[\frac{\partial G(\omega;\theta)}{\partial \theta}\right]\,
S_{ee}(\omega)^{-1}\, d\omega,
\label{eq:fim}
\end{equation}
with $T$ the experiment duration. We select $(a,T_c)$ and, in MIMO, the amplitude vector $a$ to maximize $\log\det \mathcal{I}(\theta)$ or $\mathrm{trace}\,\mathcal{I}(\theta)$ subject to environmental constraints (bounds on SAOD excursions, ozone/stratospheric heating proxies), ensuring identifiability where the climate’s sensitivity is largest (E1, E6). In practice, the design is iterated: start from priors informed by ARISE-SAI/GeoMIP baselines \citep{kravitz2011thegeoengineering,richter2022assessingresponses}, run a short pilot PRBS, update $\widehat{G}$ and $S_{ee}$, and retune $(a,T_c)$.

Nonlinearity diagnostics under PRBS. The best linear approximation (BLA) under broadband excitation provides a consistent linear surrogate; deviations are quantified via higher-order spectra \citep{pintelon2012system}. We compute a normalized bicoherence of outputs,
\begin{equation}
b^2(\omega_1,\omega_2) \;=\;
\frac{\big|\mathbb{E}\left[ Y(\omega_1)Y(\omega_2)Y^\ast(\omega_1+\omega_2)\right]\big|^2}
{\mathbb{E}\left[|Y(\omega_1)Y(\omega_2)|^2\right]\;\mathbb{E}\left[|Y(\omega_1+\omega_2)|^2\right]},
\label{eq:bicoherence}
\end{equation}
as a quadratic nonlinearity indicator complementary to the harmonic distortion index used with multisine (E2). Growth in $b^2$ and systematic phase drift of $\widehat{G}(\omega)$ toward $-\pi$ at low frequencies, tracked in sliding windows, constitute early-warning signals in E4 that are tailored to the actively excited bands.

Workflow and practicalities.
\begin{enumerate}
\item Preprocess to remove or model the seasonal cycle (cyclostationary regression), preserving interannual variability.
\item Choose $m$ injection channels (e.g., latitudinal bands) consistent with ARISE-SAI or CESM(WACCM) implementations \citep{tilmes2018stratospheric,richter2022assessingresponses}; assign low-correlation binary codes $s^{(i)}_k$ and select $(a_i,T_c)$ via \eqref{eq:fim}.
\item Run PRBS experiments for $T=10$–30 years with monthly or bimonthly toggles; for low-frequency coverage, stitch blocks with larger $T_c$.
\item Estimate $\widehat{G}(\omega)$, coherence, and residual spectra with leakage-corrected spectral regression \citep{pintelon2012system}. Fit compact parametric surrogates (e.g., low-order lag/lead networks) to $\widehat{G}$ for controller synthesis (E3).
\item Quantify nonlinear distortions via bicoherence and BLA residuals (E2); validate on held-out single-tone tests.
\item Feed identified models into $H_\infty$/MPC designs that trade off GMST tracking and regional hydrological constraints \citep{macmartin2014dynamicsof}; stress-test under ENSO-like variability and volcanic injections (E3).
\end{enumerate}

Relation to prior SAI protocols and governance. GeoMIP and ARISE-SAI have established community baselines for injection strategies and diagnostics \citep{kravitz2011thegeoengineering,richter2022assessingresponses}. Our PRBS superposition is minimally invasive, preserves comparability, and is explicitly designed for information gain and control-readiness. Amplitudes and duty cycles are bounded to avoid large SAOD swings and potential side effects \citep{robock200820reasons}, consistent with the research-first ethos advocated by \citet{keith2010researchon}. The resulting frequency-domain surrogates directly support closed-loop evaluations in line with \citet{macmartin2014dynamicsof}.

In sum, PRBS excitation operationalizes the “active spectroscopy” of the climate system: it is implementable in existing ESM workflows, yields statistically efficient spectral estimates with quantifiable information content, scales to multi-input injection designs, and provides the linear and weakly nonlinear structure needed for robust control design and early-warning analyses \citep{ljung1999system,pintelon2012system}.


% === AREA: Climate model emulation and surrogate modeling techniques. ===

\subsection{Emulation-enabled active spectroscopy and surrogate control models}

A central practical challenge in the proposed active-sensing program is the computational expense of running ensembles of Earth system model (ESM) simulations under designed, small-amplitude pulsed SAI experiments. We therefore introduce an emulation layer that distills each ESM’s input–output response to compact surrogate models in the frequency domain. These surrogates enable (i) information-optimal probe design and identifiability analysis, (ii) fast prediction of responses to arbitrary pulsing schedules, (iii) robust controller synthesis, and (iv) real-time early-warning diagnostics based on phase and harmonic content. The approach builds on established frequency-domain system identification and experiment design theory \cite{pintelon2012system,ljung1999system} and leverages standardized SAI protocols and large ensembles for signal-to-noise (SNR) gains and cross-model validation \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. In addition to improving computational efficiency, the emulators provide an auditably simple representation suitable for governance contexts wary of opaque black-box models \cite{robock200820reasons,keith2010researchon}.

\paragraph{Surrogate model classes.}
We focus on three complementary, small-signal surrogate classes around a steady SAI baseline:
(i) linear frequency responses; (ii) second-order Volterra models for weak nonlinearities; and (iii) linear predictors in a lifted feature space for control.

1) Linear frequency response (FRF). For a scalar SAI injection anomaly input \(u_t\) (e.g., TgS yr\(^{-1}\) about baseline) and multivariate outputs \(y_t\) (e.g., GMST, precipitation indices), we linearize the ESM around the baseline to obtain, in the frequency domain,
\[
Y(\omega)=G(\omega)U(\omega)+E(\omega),
\]
where \(G(\omega)\) is the multi-input/multi-output FRF and \(E(\omega)\) collects internal variability and model error \cite{pintelon2012system}. With designed multi-sine or PRBS excitations aligned to the discrete Fourier grid, we estimate
\[
\widehat{G}(\omega)=S_{yu}(\omega)\,S_{uu}^{-1}(\omega),
\]
with Welch-averaged cross/auto spectra and leakage correction \cite{pintelon2012system}. We impose smoothness via Tikhonov regularization on \(\partial_\omega G\) and select the regularization weight by an L-curve criterion to balance bias and variance, as in frequency-domain identification best practice \cite{pintelon2012system}.

2) Second-order Volterra kernels. To capture harmonic generation and intermodulation under small but finite pulsed amplitudes, we fit a truncated Volterra model \cite{ljung1999system}:
\[
y(t)=h_0+\sum_{k}h_1(k)u(t-k)+\sum_{k_1\le k_2} h_2(k_1,k_2)\,u(t-k_1)u(t-k_2)+e(t),
\]
where \(h_1\) recovers the linear impulse response and \(h_2\) captures quadratic distortions. We estimate \(\theta=\{h_1,h_2\}\) by sparse regression,
\[
\min_{\theta}\ \frac{1}{N}\,\lVert y-\Phi\theta\rVert_2^2+\lambda\lVert \theta\rVert_1,
\]
with polynomial–convolution features \(\Phi\), choosing \(\lambda\) by cross-validation on held-out tones. This yields a harmonic distortion index (HDI) computable from predicted spectral lines at \(2f,3f,\dots\) relative to the fundamentals, which we later use as an early-warning indicator.

3) Lifted linear predictors for control. For controller synthesis we construct a low-order predictor in a lifted space of lagged and quadratic features \(\psi(y_t)\),
\[
z_{t+1}=A z_t+B u_t+w_t,\quad \hat{y}_t=C z_t,
\]
estimated by ridge regression or subspace identification \cite{ljung1999system}. This “Koopman-regressed” linear predictor provides a convex surrogate for model predictive control (MPC), while the FRF and Volterra models anchor frequency-domain understanding and diagnostics.

\paragraph{Information-optimal probe design.}
We co-design multi-sine/PRBS/chirp excitations to maximize information about the surrogate parameters under environmental and ethical constraints. Let \(\theta\) parameterize \(G(\omega)\) on a band-limited grid (e.g., piecewise-constant or spline coefficients), and let \(S_{ee}(\omega)\) denote the noise spectrum from unforced ensembles. For linear-in-the-parameters frequency-domain estimators, the Fisher information matrix (FIM) satisfies, to first order \cite{ljung1999system,pintelon2012system},
\[
\mathcal{J}(\theta)\approx \sum_{\omega\in\Omega}\Big(\frac{\partial G(\omega)}{\partial \theta}\Big)^\top
\frac{S_{uu}(\omega)}{S_{ee}(\omega)}
\Big(\frac{\partial G(\omega)}{\partial \theta}\Big),
\]
where \(S_{uu}(\omega)\) is the designed input spectrum over the probed band \(\Omega\). We choose amplitudes \(a(\omega)\) and phases \(\phi(\omega)\) of a multi-sine input
\[
u_t=\sum_{\omega\in\Omega} a(\omega)\sin(\omega t+\phi(\omega))
\]
to maximize a scalarized criterion (e.g., \(\log\det \mathcal{J}\) or \(\mathrm{trace}(W\mathcal{J})\)) subject to:
(i) RMS power budget; (ii) crest-factor limits via phase optimization; and (iii) safety/feasibility constraints on stratospheric aerosol optical depth (SAOD), ozone, and circulation metrics informed by prior SAI experiments \cite{tilmes2018stratospheric,richter2022assessingresponses}. Aligning tones to the discrete Fourier grid minimizes leakage and bias in \(\widehat{G}\) \cite{pintelon2012system}. Where internal variability is strong, we distribute power across frequencies with high \(S_{uu}(\omega)/S_{ee}(\omega)\) and exploit ensemble averaging from large ensembles to increase effective information \cite{tilmes2018stratospheric}.

\paragraph{Validation, uncertainty, and cross-model transfer.}
We validate surrogates on held-out single-tone and chirp tests, reporting normalized RMSE, magnitude–phase coherence, and HDI errors. Uncertainty in \(\widehat{G}\) is quantified by nonparametric bootstrap over ensemble members and time blocks, yielding frequency-resolved confidence bands that propagate into control design. Cross-model robustness is assessed by repeating the identification in an intermediate-complexity model and a chemistry-enabled ESM, following standardized SAI protocols \cite{kravitz2011thegeoengineering,richter2022assessingresponses}. The same excitation design and estimators are applied across models to measure generalization gaps and to identify frequency bands where physics differs, guiding controller robustness margins.

\paragraph{Integration with control and early warning.}
The emulators close the loop between identification and decision-making. We synthesize MPC and H-infinity controllers on the lifted linear predictor, adding frequency-domain constraints derived from \(\widehat{G}\) (e.g., bounds on gains/phase in precipitation-sensitive bands) and hard limits on SAOD excursions. Prior work demonstrates the importance—and feasibility—of closed-loop SAI governance at the system level \cite{macmartin2014dynamicsof}; our surrogates supply the low-order dynamics such controllers require. In parallel, we compute online early-warning diagnostics from the identified FRF and Volterra layers:
(i) phase-lag drift toward \(-\pi\) at low frequencies under gradually increasing baseline forcing; and
(ii) HDI growth indicating rising nonlinearity. These indicators are extracted from the same pulsed experiments, offering targeted sensitivity to instability mechanisms beyond variance/autocorrelation heuristics, while remaining interpretable and auditable.

\paragraph{Practicality and safeguards.}
Small-amplitude probing is designed to be minimally invasive while scientifically informative. The FIM scaling implies that information grows with input power, record length, and ensemble size \cite{ljung1999system,pintelon2012system}; we therefore map trade-offs between amplitude (e.g., 0.02–0.5 TgS yr\(^{-1}\) RMS), duration, and ensembles to meet target errors under internal variability. Protocols and constraints adopted from community SAI experiments \cite{tilmes2018stratospheric,richter2022assessingresponses} and multi-model practices \cite{kravitz2011thegeoengineering} reduce the risk of unintended model states, aligning with the broader cautionary and governance-oriented perspectives on geoengineering research \cite{robock200820reasons,keith2010researchon}.

In sum, emulation-enabled active spectroscopy translates expensive, high-dimensional ESM behavior into compact, frequency-aware surrogates. These surrogates are tailored to the inputs we can design and the outputs we must manage, thereby providing a direct bridge from information-optimal probing to robust control and early warning within a unified, auditable framework grounded in frequency-domain system identification \cite{pintelon2012system,ljung1999system}.


% === AREA: Optimization algorithms for multi-objective climate control. ===

\subsection{Active spectroscopy for SAI: information-optimal probing, frequency-domain identification, and robust control}

We propose to treat temporally modulated stratospheric aerosol injection (SAI) as an active spectroscopy experiment on the coupled climate system: small, carefully designed perturbations are superimposed on a steady baseline to excite known spectral lines and reveal frequency-dependent gains, lags, and nonlinear distortions that are otherwise confounded by internal variability. This fills a methodological gap between open-loop scenario intercomparisons (e.g., GeoMIP and ARISE-SAI) and conceptual closed-loop studies by explicitly identifying dynamics from designed inputs using mature tools from system identification and control theory \cite{kravitz2011thegeoengineering,richter2022assessingresponses,tilmes2018stratospheric,macmartin2014dynamicsof,ljung1999system,pintelon2012system}. The approach is strictly in-silico and bounded by governance and risk considerations \cite{robock200820reasons,keith2010researchon}.

We model the injection-rate-to-output mapping around a baseline operating point as a weakly nonlinear, noise-perturbed system. Let the control input be the deviation in sulfur injection rate, $\delta u(t)$, around a baseline $u_0$ chosen for climate stabilization; key outputs $y(t)$ include global-mean surface temperature (GMST), regional precipitation indices, and circulation metrics. Designed probes use multisines, chirps, or PRBS to span monthly-to-interannual bands while respecting environmental constraints:
\[
u(t)=u_0+\delta u(t),\quad 
\delta u(t)=\sum_{k=1}^{K} a_k \sin(2\pi f_k t+\phi_k),
\]
with $a_k$ chosen to keep the RMS amplitude in a conservative range (e.g., $0.05$--$0.5$ TgS yr$^{-1}$) and with phases $\phi_k$ optimized to maximize information while controlling crest factor and aerosol optical depth excursions \cite{pintelon2012system,ljung1999system}. In the frequency domain, a local linear approximation yields
\[
Y(\omega)=G(\omega)\,U(\omega)+D(\omega)+N(\omega),
\]
where $G(\omega)$ is the frequency response function (FRF) from injection to output, $D(\omega)$ captures coherent but unmodeled dynamics (e.g., ENSO aliasing at excited lines), and $N(\omega)$ aggregates internal variability and numerical noise.

Frequency-domain system identification. We estimate $G(\omega)$ by spectral regression at the designed lines, using cross-spectral ratios with leakage correction and coherence screening \cite{pintelon2012system}:
\[
\widehat{G}(\omega_k)=\frac{S_{yu}(\omega_k)}{S_{uu}(\omega_k)},\qquad
\gamma^2(\omega_k)=\frac{|S_{yu}(\omega_k)|^2}{S_{yy}(\omega_k)\,S_{uu}(\omega_k)},
\]
retaining $\omega_k$ with high $\gamma^2$ and smoothing $\widehat{G}$ to enforce physically plausible roll-off. Multisine design decouples linear FRF estimates from nonlinear distortions: by exciting only odd lines and reserving even/combination lines as ``nonlinear detectors,'' we can quantify second-order harmonics and intermodulation without biasing the linear estimate \cite{pintelon2012system}. The Bode gain and phase thus obtained provide compact, interpretable summaries of the climate’s temporal pathways from SAI to impacts, complementing scenario-based assessments \cite{kravitz2011thegeoengineering,richter2022assessingresponses}.

Nonlinear distortion and compact surrogates. To capture weak nonlinearities, we fit a second-order Volterra model,
\[
y(t)\approx (h_1 * \delta u)(t)\;+\;\iint h_2(\tau_1,\tau_2)\,\delta u(t-\tau_1)\,\delta u(t-\tau_2)\,d\tau_1 d\tau_2,
\]
estimated from polynomial–convolution features with sparsity regularization and cross-validation to avoid overfitting \cite{ljung1999system}. We summarize nonlinearity via a harmonic distortion index (HDI),
\[
\mathrm{HDI}=\frac{\sum_{\ell\in \mathcal{H}} |Y(\omega_\ell)|^2}{\sum_{k\in \mathcal{F}} |Y(\omega_k)|^2},
\]
where $\mathcal{F}$ are excited lines and $\mathcal{H}$ are reserved harmonic and intermodulation lines. Rising HDI under increased baseline forcing flags growing nonlinear coupling that can degrade controller performance.

Information-optimal probe design. We parameterize $G(\omega)$ (and selected elements of $h_2$) by $\theta$ and choose amplitudes and phases to maximize a Fisher information criterion,
\[
\max_{\{a_k,\phi_k\}} \;\Phi\big(\mathcal{I}(\theta)\big)\quad\text{s.t.}\quad \mathrm{RMS}(\delta u)\le \alpha,\;\mathrm{SAOD}(t)\le \mathrm{SAOD}_{\max},
\]
with $\Phi$ chosen as $\log\det$ or trace to balance multi-output identifiability \cite{ljung1999system,pintelon2012system}. Constraints reflect operational and environmental safeguards; practical feasibility leverages ensemble and moderate-resolution configurations demonstrated in CESM/WACCM SAI ensembles and ARISE-SAI protocols \cite{tilmes2018stratospheric,richter2022assessingresponses}.

Robust control synthesis. Identified FRFs and low-order surrogates inform controller design that trades off GMST tracking against regional hydrological stability. We consider H-infinity and MPC formulations built on the identified models \cite{macmartin2014dynamicsof}:
\[
\min_{\{u_t\}} \sum_{t=1}^{T}\Big[w_T\,(T_t-T^\star)^2+w_P\,\|P_t\|_2^2+\rho\,(\Delta u_t)^2\Big]
\]
subject to bounds on injection rate, its rate-of-change, and stratospheric aerosol optical depth. Frequency-shaped penalties (derived from $\widehat{G}$) suppress bands where precipitation is sensitive, reducing regional risk relative to naive pulsing or purely continuous injection. We report tracking RMSE, constraint-violation rates, controller effort, and regret against an oracle that has access to the full model. This extends prior closed-loop analyses of solar geoengineering with empirically identified dynamics \cite{macmartin2014dynamicsof}.

Early-warning indicators. Because Bode phase at key bands drifts toward $-\pi$ as a system approaches oscillatory instability, and nonlinear energy leaks into harmonics as weakly stable modes saturate, we monitor two indicators during gradual baseline escalation: (i) phase-lag drift $\Delta\phi(\omega)$ at monthly-to-annual bands, and (ii) HDI growth at reserved lines. These active indicators are designed for higher specificity than passive variance/autocorrelation metrics by conditioning on known excitation \cite{pintelon2012system}. They are not substitutes for broad risk assessment \cite{robock200820reasons} but provide targeted diagnostics under controlled experimental conditions.

Cross-model robustness and practicality. We implement the protocol across a tiered model hierarchy: idealized aquaplanet or EMIC, and a coarser-resolution ESM with interactive stratospheric aerosols and chemistry \cite{richter2022assessingresponses,kravitz2011thegeoengineering}. Controllers identified in the lower tier are transferred to the higher tier without retraining to test generalization; ensemble strategies and multi-year experiments mitigate internal variability, as demonstrated by large-ensemble SAI studies \cite{tilmes2018stratospheric}. Practicality bounds are quantified by varying probe amplitude, duration, and ensemble size, reporting Fisher information growth and estimation bias/variance \cite{ljung1999system,pintelon2012system}.

Protocol summary (E1–E6). 
\begin{itemize}
\item E1: Design multisine/PRBS/chirp probes (0.05–0.5 TgS yr$^{-1}$ RMS; 0.02–2 cycles yr$^{-1}$), optimize phases/amplitudes to maximize Fisher information under SAOD/ozone proxies \cite{pintelon2012system,ljung1999system}. 
\item E2: Estimate FRFs via spectral regression with leakage correction; quantify nonlinear distortions via reserved lines and a second-order Volterra fit; validate on single-tone tests \cite{pintelon2012system}.
\item E3: Synthesize H-infinity/MPC controllers using identified models; benchmark against continuous and naive pulsed baselines under internal variability and volcanic-like disturbances \cite{macmartin2014dynamicsof}.
\item E4: Track phase drift and HDI under gradual baseline escalation; compare detection lead time against passive metrics; interpret as risk-aware diagnostics, not forecasts \cite{robock200820reasons}.
\item E5: Repeat across model tiers (idealized $\rightarrow$ ESM) and assess transferability and robustness \cite{kravitz2011thegeoengineering,richter2022assessingresponses,tilmes2018stratospheric}.
\item E6: Map practicality bounds by varying amplitude, duration, and ensemble size; report information–cost trade-offs \cite{ljung1999system}.
\end{itemize}

By reinterpreting pulsing as purposeful spectroscopy, this framework yields compact, testable surrogate dynamics for control design and governance-relevant early warnings, while remaining anchored in established system identification practice and existing SAI modeling infrastructure \cite{pintelon2012system,ljung1999system,richter2022assessingresponses,tilmes2018stratospheric}.


% === AREA: Stratospheric aerosol injection (SAI) climate impacts and uncertainties. ===

\subsection{Active spectroscopy for SAI impacts and uncertainties}

Large-ensemble and intercomparison studies have established that stratospheric aerosol injection (SAI) can reduce global-mean temperature but induces regionally heterogeneous impacts, with responses that depend sensitively on injection strategy, background state, and model configuration \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. Persistent uncertainties include hydrological changes, circulation shifts, and stratospheric chemistry interactions, alongside governance-relevant risks and ethical concerns \cite{robock200820reasons,keith2010researchon}. Critically, most existing assessments evaluate step or ramp perturbations and report time-mean differences, leaving the temporal pathways by which SAI influences coupled climate variables weakly constrained. Yet policy-relevant deployment would inevitably be dynamic and adaptive, with feedback between observations and decisions \cite{macmartin2014dynamicsof}. To design such feedback, one needs the frequency-dependent gains, lags, and nonlinear distortions from SAI actuation to key outputs, identified under controlled, high signal-to-noise experiments rather than inferred passively.

We propose to treat temporally modulated SAI as an active spectroscopy experiment: small-amplitude, information-optimized pulses superimposed on a baseline to excite climate modes across monthly to interannual bands, from which frequency response functions and low-order nonlinearities are estimated. This draws on mature frequency-domain system identification for engineered systems \cite{ljung1999system,pintelon2012system}, adapted to the constraints of Earth system modeling and the specific uncertainties of SAI. The goal is not to induce large climate changes, but to reveal the dynamic map from injection rate to climate outputs in a minimally invasive, high-information manner.

We construct probe signals as multi-sine, chirp, or pseudo-random binary sequences (PRBS) with amplitude chosen to remain within the quasi-linear regime while permitting detection of weak nonlinear distortions:
\begin{equation}
u(t) \;=\; u_0 \;+\; \sum_{k=1}^{K} a_k \sin\big(2\pi f_k t + \phi_k\big),
\label{eq:multisine}
\end{equation}
where $u(t)$ is the perturbation to the SAI injection rate about a baseline $u_0$ (e.g., 5 TgS/yr), frequencies $f_k$ span $[0.02,2]$ cycles per year, and amplitudes $a_k$ are small (e.g., 0.05--0.5 TgS/yr RMS). Phases $\phi_k$ and amplitudes $\{a_k\}$ are chosen to maximize an information metric for the parameters of an assumed surrogate (e.g., a rational transfer function or a low-order Volterra model) subject to safety and feasibility constraints. A canonical design problem is
\begin{align}
\max_{\{a_k,\phi_k\}} \quad & \log\det \mathcal{I}(\theta;\{a_k,\phi_k\}) \label{eq:design}\\
\text{s.t.} \quad & \tfrac{1}{T}\int_0^T \big(u(t)-u_0\big)^2 dt \leq \bar{U}^2,\quad \mathrm{SAOD}(t) \in \mathcal{S}, \nonumber
\end{align}
where $\mathcal{I}(\theta)$ is the Fisher information matrix for surrogate parameters $\theta$, $\bar{U}$ limits probe energy, and $\mathcal{S}$ encodes bounds on stratospheric aerosol optical depth (SAOD) or ozone-related proxies. For linear time-invariant surrogates with output noise power spectrum $S_{\varepsilon\varepsilon}(\omega)$, a frequency-discretized approximation of $\mathcal{I}$ reads \cite{ljung1999system,pintelon2012system}
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \sum_{\omega\in\Omega} \frac{1}{S_{\varepsilon\varepsilon}(\omega)} \left(\frac{\partial H(\omega;\theta)}{\partial \theta}\right)^{\!\!*} S_{uu}(\omega)\, \left(\frac{\partial H(\omega;\theta)}{\partial \theta}\right),
\label{eq:FIM}
\end{equation}
with $H(\omega;\theta)$ the surrogate frequency response and $S_{uu}(\omega)$ the probe spectrum implied by \eqref{eq:multisine}. This formulation favors placing input power where the surrogate is most sensitive and the output noise is low, while allowing explicit constraints on aerosol burden, as appropriate for in-silico experiments within established protocols \cite{richter2022assessingresponses,tilmes2018stratospheric}.

Given simulated input-output records $\{u(t),y(t)\}$ (e.g., global mean surface temperature, regional precipitation indices, stratospheric winds), we estimate linear frequency response via spectral regression with leakage control \cite{pintelon2012system}. Let $\widehat{S}_{yu}(\omega)$ and $\widehat{S}_{uu}(\omega)$ denote cross- and auto-spectral density estimates obtained with multitaper or optimized windows at the excited lines $\omega\in\Omega$. A consistent frequency response estimator is
\begin{equation}
\widehat{H}(\omega) \;=\; \frac{\widehat{S}_{yu}(\omega)}{\widehat{S}_{uu}(\omega)}, \qquad
\widehat{\gamma}^2(\omega) \;=\; \frac{|\widehat{S}_{yu}(\omega)|^2}{\widehat{S}_{yy}(\omega)\widehat{S}_{uu}(\omega)},
\label{eq:frf}
\end{equation}
where $\widehat{\gamma}^2$ is the magnitude-squared coherence used to screen frequencies with insufficient excitation. We then fit compact parametric models $H(\omega;\theta)$ to $\widehat{H}(\omega)$ via weighted nonlinear least squares across bands, yielding Bode magnitude and phase with uncertainty.

To quantify nonlinear distortions at probe amplitudes, we estimate second-order Volterra kernels that capture harmonics and intermodulation products \cite{ljung1999system}:
\begin{equation}
y(t) \;=\; \sum_{\tau} h_1(\tau)\,u(t-\tau) \;+\; \sum_{\tau_1,\tau_2} h_2(\tau_1,\tau_2)\,u(t-\tau_1)u(t-\tau_2) \;+\; \varepsilon(t),
\label{eq:volterra}
\end{equation}
with sparsity-promoting regularization to control complexity. The degree of nonlinearity can be summarized by a harmonic distortion index (HDI) at a fundamental frequency $\omega$,
\begin{equation}
\mathrm{HDI}(\omega) \;=\; \frac{\sum_{m\ge 2} P_y(m\omega)}{P_y(\omega)},
\label{eq:hdi}
\end{equation}
where $P_y$ is the line power at each harmonic; growth in HDI under rising baseline forcing can signal increasing nonlinearity in the response pathway.

The identified surrogates support robust control synthesis that explicitly accounts for dynamic trade-offs. Building on the insight that closed-loop actuation interacts with internal variability and delayed climate responses \cite{macmartin2014dynamicsof}, we formulate controllers that track temperature targets while constraining regional hydrology and aerosol burden. For a linear surrogate, a model predictive control (MPC) problem takes the form
\begin{align}
\min_{\{u_{t|t}\}} \quad & \sum_{k=1}^{N_p} \big\|y_{t+k|t} - r_{t+k}\big\|_Q^2 \;+\; \sum_{k=0}^{N_c-1} \|\Delta u_{t+k|t}\|_R^2 \label{eq:mpc}\\
\text{s.t.} \quad & y_{t+k|t} \;=\; \mathcal{M}\big(u_{t:t+k-1}\big),\quad \mathrm{Var}\big[\mathcal{H}y_{t+k|t}\big] \le \sigma^2_{\max},\quad \mathrm{SAOD}_{t+k|t} \in \mathcal{S}, \nonumber
\end{align}
where $\mathcal{M}$ is the identified predictor (linear or Volterra-based), $r$ is the temperature target, $\mathcal{H}$ extracts constrained regional metrics, and $(Q,R)$ trade off tracking and control effort. In parallel, an $\mathcal{H}_\infty$ design limits worst-case gain from disturbances (e.g., ENSO-like variability, volcanic eruptions) to regulated outputs, directly leveraging the identified $H(\omega;\theta)$ and its uncertainty. The combination enables quantifiable performance margins and constraint guarantees that are difficult to obtain from static, time-mean comparisons alone.

Finally, we propose early-warning indicators derived from the same spectral experiments. As the baseline forcing increases (e.g., escalating SAI to counter stronger greenhouse forcing), many systems exhibit changes in phase lag and amplification near emergent modes. We therefore monitor phase drift $\Delta\phi(\omega)$ of $\widehat{H}(\omega)$ and HDI growth \eqref{eq:hdi} across bands as candidate precursors of instability. In models, these indicators can be benchmarked against passive metrics (variance, lag-1 autocorrelation) for detection lead time and false-alarm trade-offs, providing a dynamic complement to existing risk assessments \cite{robock200820reasons}.

This active-sensing program is designed to dovetail with established Earth system modeling efforts. GeoMIP and ARISE-SAI have demonstrated the value of coordinated protocols to interrogate SAI impacts across models and scenarios \cite{kravitz2011thegeoengineering,richter2022assessingresponses}. Our framework reuses these infrastructures but replaces large step changes with targeted, low-amplitude, information-rich perturbations that are feasible at moderate computational cost, particularly in intermediate-complexity or coarser-resolution configurations prior to higher-fidelity confirmation \cite{tilmes2018stratospheric}. The outcome is a compact, frequency-aware representation of how temporal modulation of SAI propagates through coupled climate subsystems, supporting: (i) clearer attribution of regional impacts to specific dynamical pathways, (ii) synthesis of robust controllers with explicit uncertainty margins, and (iii) actionable early-warning diagnostics. In short, frequency-domain identification under designed perturbations addresses a central source of uncertainty in SAI---the time-structure of its impacts---more directly and data-efficiently than passive observation or one-off impulse experiments, while remaining aligned with calls for rigorous, model-based assessment prior to any consideration of real-world interventions \cite{keith2010researchon,robock200820reasons}.


% === AREA: Information theory applications in climate science and modeling. ===

\subsection{Information-theoretic probe design for active SAI spectroscopy}

Passive multi-scenario ensembles have established first-order responses and uncertainties of SAI but are not designed to reveal frequency-dependent gains, lags, or nonlinear distortions of the coupled climate response \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. We recast the comparison of pulsed versus continuous injection as an optimal experimental design problem: choose small-amplitude, spectrally structured perturbations that maximize the information about the climate’s frequency-domain dynamics per unit climatic risk. This connects Earth system experimentation with well-established identification and input-design theory \citep{ljung1999system,pintelon2012system} and complements prior work on closed-loop SAI control \citep{macmartin2014dynamicsof}.

\paragraph{Modeling setup.}
Let $u_t$ denote the SAI perturbation (a micro-pulse superimposed on a steady baseline injection), and let $\mathbf{y}_t\in\mathbb{R}^p$ collect $p$ outputs (e.g., GMST, regional precipitation indices, circulation metrics). Around a fixed baseline, assume a small-signal linearization over the monthly–interannual band of interest:
\begin{equation}
\mathbf{y}_t \;=\; \mathbf{y}^{(0)}_t \;+\; \mathcal{G}(q;\boldsymbol{\theta})\,u_t \;+\; \mathbf{v}_t,
\label{eq:lin_model}
\end{equation}
where $\mathcal{G}(q;\boldsymbol{\theta})$ is a (possibly low-order) linear time-invariant operator with parameter vector $\boldsymbol{\theta}$, and $\mathbf{v}_t$ is zero-mean, wide-sense stationary internal variability with cross-spectral density matrix $\mathbf{S}_{\!vv}(\omega)$. In the frequency domain, at excited lines $\{\omega_k\}_{k=1}^K$,
\begin{equation}
\mathbf{Y}(\omega_k) \;=\; \mathbf{G}(\omega_k;\boldsymbol{\theta})\,U(\omega_k) \;+\; \mathbf{V}(\omega_k).
\end{equation}
We consider multi-sine inputs $u_t=\sum_{k=1}^K a_k\cos(\omega_k t + \phi_k)$ or PRBS-like sequences filtered to the target band \citep{pintelon2012system,ljung1999system}. Baselines and perturbation magnitudes are chosen to align with prior SAI protocols (e.g., constant injections of several TgS/yr with perturbation RMS $\ll 1$ TgS/yr) to remain within small-signal regimes \citep{tilmes2018stratospheric,richter2022assessingresponses}.

\paragraph{Fisher information for frequency-response identification.}
For Gaussian $\mathbf{v}_t$, the (expected) Fisher Information Matrix (FIM) for $\boldsymbol{\theta}$ under a length-$N$ experiment is additive over excited lines \citep{ljung1999system,pintelon2012system}:
\begin{equation}
\mathcal{I}(\boldsymbol{\theta}) \;\approx\; \frac{N}{2}\sum_{k=1}^K 
\big(\partial_{\boldsymbol{\theta}}\mathbf{G}(\omega_k)\,U(\omega_k)\big)^\ast
\,\mathbf{S}_{\!vv}^{-1}(\omega_k)\,
\big(\partial_{\boldsymbol{\theta}}\mathbf{G}(\omega_k)\,U(\omega_k)\big),
\label{eq:fim_general}
\end{equation}
where ${}^\ast$ denotes Hermitian transpose. For multi-sine inputs $U(\omega_k)=a_k e^{\mathrm{i}\phi_k}$, \eqref{eq:fim_general} can be written as
\begin{equation}
\mathcal{I}(\boldsymbol{\theta}) \;=\; \sum_{k=1}^K p_k\,\mathbf{B}_k, 
\qquad 
\mathbf{B}_k \;\equiv\; \frac{N}{2}\,
\big(\partial_{\boldsymbol{\theta}}\mathbf{G}(\omega_k)\big)^\ast
\,\mathbf{S}_{\!vv}^{-1}(\omega_k)\,
\big(\partial_{\boldsymbol{\theta}}\mathbf{G}(\omega_k)\big),
\label{eq:fim_linear_power}
\end{equation}
with power allocation variables $p_k \equiv a_k^2$. The Cramér–Rao bound (CRB) then guarantees $\mathrm{cov}(\widehat{\boldsymbol{\theta}})\succeq \mathcal{I}(\boldsymbol{\theta})^{-1}$. When estimating a nonparametric frequency response (treating $\{\mathbf{G}(\omega_k)\}$ as parameters), \eqref{eq:fim_linear_power} remains block-diagonal across $k$, yielding explicit variance formulas for Bode gain/phase estimates as a function of $N$, $a_k$, and $\mathbf{S}_{\!vv}(\omega_k)$ \citep{pintelon2012system}.

\paragraph{D-/E-optimal power allocation under climatic constraints.}
We allocate spectral power $p_k$ across lines to maximize an information metric subject to risk and feasibility constraints:
\begin{align}
\max_{\mathbf{p}\in\mathbb{R}_+^K} \quad 
& J(\mathbf{p}) \;\equiv\; \log\det\!\Big(\mathbf{I}_0 + \sum_{k=1}^K p_k \mathbf{B}_k\Big) 
&& \text{(D-optimality)} \label{eq:dopt}\\
\text{s.t.}\quad 
& \sum_{k=1}^K p_k \;\leq\; P_{\max}, \qquad 0 \le p_k \le p_k^{\max}, \nonumber\\
& \mathrm{CF}(u) \;\leq\; C_{\max}, \qquad \mathcal{R}(\mathbf{p}) \;\leq\; R_{\max}. \nonumber
\end{align}
Here $\mathbf{I}_0$ can encode prior information from previous experiments, $P_{\max}$ enforces an RMS bound on the perturbation, $p_k^{\max}$ can restrict energy near sensitive bands, $\mathrm{CF}(u)$ is the crest factor (peak-to-RMS) of the time waveform, and $\mathcal{R}(\mathbf{p})$ is a convex proxy for climatic risk (e.g., added variance of a constrained output). The D-optimal criterion is concave in $\{p_k\}$ because \eqref{eq:fim_linear_power} is affine in $\mathbf{p}$, yielding a tractable convex program. E-optimality ($\max \lambda_{\min}$) or A-optimality ($\min \mathrm{tr}[\mathcal{I}^{-1}]$) can be used to emphasize worst-case or average-variance reduction, respectively \citep{ljung1999system}. 

The crest-factor constraint is handled by phase selection: random-phase or Schroeder-phase multisines produce approximately Gaussian time series with low crest factor while preserving assigned line powers \citep{pintelon2012system}. This limits peak injection excursions relative to the baseline (e.g., $\mathcal{O}(0.05$–$0.5)$ TgS/yr RMS around $\sim 5$ TgS/yr; cf. protocols in \citealp{tilmes2018stratospheric,richter2022assessingresponses}), and keeps perturbations within small-signal and governance-relevant bounds \citep{robock200820reasons,keith2010researchon}.

\paragraph{Amplitude–duration trade-offs and identifiability.}
From \eqref{eq:fim_linear_power}, information scales linearly with both experiment length $N$ and line power $p_k$. For nonparametric FRF estimates at $\omega_k$,
\begin{equation}
\mathrm{var}\!\big(\widehat{\mathbf{G}}(\omega_k)\big) \;\gtrsim\; 
\Big[\tfrac{N}{2}\,p_k\,\mathbf{S}_{\!vv}^{-1}(\omega_k)\Big]^{-1},
\label{eq:crb_line}
\end{equation}
up to constants related to estimator choice and leakage corrections \citep{pintelon2012system}. Equation \eqref{eq:crb_line} quantifies the E6 trade-space: halving standard error at a given line requires quadrupling experiment length or line power, guiding practical choices of perturbation amplitude (e.g., $0.05$ vs.\ $0.2$ TgS/yr RMS), duration (e.g., 5 vs.\ 20 years), and the number of excited lines. Because $\mathbf{S}_{\!vv}(\omega)$ generally increases toward lower frequencies, optimal designs allocate more power to low-frequency lines to offset stronger internal variability—consistent with classical “water-filling” intuition for band-limited identification \citep{ljung1999system,pintelon2012system}.

\paragraph{PRBS versus multi-sine excitation.}
PRBS inputs approximate spectrally flat excitation in time domain and are convenient for broad-band identification and time-domain Volterra fitting; multi-sine designs provide precise control of line powers and phases, enabling leakage-robust spectral regression and targeted probing of specific bands \citep{pintelon2012system,ljung1999system}. Both can be accommodated within \eqref{eq:fim_linear_power} by treating $p_k$ as the expected power at $\omega_k$ and using $\mathbf{S}_{\!vv}$ estimated from a baseline (no-pulse) run.

\paragraph{Sequential design and closed-loop integration.}
The additivity of Fisher information across experiments allows sequential refinement: after each batch, update $\mathbf{I}_0$ with the realized information and resolve \eqref{eq:dopt} to reallocate power toward frequencies with highest posterior uncertainty. This dovetails with closed-loop SAI concepts \citep{macmartin2014dynamicsof}: identification runs can be interleaved with tracking control while keeping perturbations small, and the same information-optimal surrogates directly support robust controller synthesis.

\paragraph{Protocol integration.}
In practice: (i) estimate $\mathbf{S}_{\!vv}(\omega)$ from a baseline simulation and define the target band (e.g., $0.02$–$2$ cycles/yr); (ii) obtain preliminary sensitivities $\partial_{\boldsymbol{\theta}}\mathbf{G}(\omega_k)$ via a short pilot with very small multi-sine; (iii) solve \eqref{eq:dopt} for $p_k$ under amplitude, crest-factor, and risk constraints; (iv) realize phases to satisfy $\mathrm{CF}(u)\le C_{\max}$; (v) run the experiment, estimate Bode gain/phase with leakage correction, and update $\mathbf{I}_0$; (vi) repeat until target CRB is achieved. This information-theoretic workflow turns pulsing into purposeful spectroscopy: a minimally invasive, high-yield method to uncover the temporal pathways by which SAI affects coupled climate variables, complementing scenario-based assessments \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}.


% === AREA: Volterra kernel methods for nonlinear system identification in climate models. ===

\subsection{Nonlinear Spectral Identification via Sparse Volterra Kernels}

Linear frequency response functions (FRFs) are necessary but insufficient to characterize the climate response to stratospheric aerosol injection (SAI): hydrological and circulation responses are amplitude- and state-dependent, and model studies show regionally heterogeneous, nonlinear sensitivities to the magnitude and pattern of forcing and to background variability (e.g., ENSO, QBO) under SAI scenarios and protocols such as GeoMIP, CESM1(WACCM) large ensembles, and ARISE-SAI \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. To explicitly capture weak nonlinearities induced by micro-perturbations, we augment the linear FRF with a second-order Volterra representation, estimated using multisine-based spectroscopy and sparsity regularization. This yields compact, interpretable surrogates that (i) separate linear gain/phase from nonlinear harmonic and intermodulation distortions, (ii) expose cross-frequency pathways by which pulsed SAI couples into the climate system, and (iii) can be lifted into quadratic predictors for robust control design \citep{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.

We consider a single-input (SAI injection perturbation) multi-output setting with deseasonalized monthly anomalies. For output $y^{(q)}_t$ (e.g., GMST, Sahel JJA precipitation, SAOD), we model the weakly nonlinear, fading-memory response as
\begin{equation}
\label{eq:volterra_time}
y^{(q)}_t \;=\; h^{(q)}_0 \;+\; \sum_{\tau=0}^{L_1-1} h^{(q)}_1[\tau]\,u_{t-\tau} \;+\; \sum_{\tau_1=0}^{L_2-1}\sum_{\tau_2=0}^{L_2-1} h^{(q)}_2[\tau_1,\tau_2]\,u_{t-\tau_1}u_{t-\tau_2} \;+\; e^{(q)}_t,
\end{equation}
with $h^{(q)}_2$ symmetric in $(\tau_1,\tau_2)$, memory lengths $L_1,L_2$ chosen to cover interannual dynamics, and $e^{(q)}_t$ zero-mean residual variability. The first-order kernel $h^{(q)}_1$ recovers the linear FRF; the second-order kernel $h^{(q)}_2$ generates harmonics and intermodulation products that we quantify as diagnostic indicators of nonlinear climate response to SAI.

Frequency-domain multisine excitation enables a clean separation of linear and nonlinear contributions \citep{pintelon2012system}. Let $u_t$ be a small-amplitude, information-optimized multisine with line set $\Omega=\{\omega_\ell\}$ spanning monthly to interannual bands (0.02–2 cyc yr$^{-1}$), randomized phases, and reserved detection lines where the input amplitude is set to zero. Denoting the discrete Fourier transforms by $U(\omega)$ and $Y^{(q)}(\omega)$, the second-order Volterra model implies, at the excited lines,
\begin{equation}
\label{eq:volterra_freq}
Y^{(q)}(\omega) \;\approx\; H^{(q)}_1(\omega)\,U(\omega) \;+\; \sum_{\omega_i+\omega_j=\omega} H^{(q)}_2(\omega_i,\omega_j)\,U(\omega_i)U(\omega_j),
\end{equation}
where $H^{(q)}_1$ and $H^{(q)}_2$ are the 1D and 2D Fourier transforms of $h^{(q)}_1$ and $h^{(q)}_2$, respectively. Power at detection lines (unexcited by $U$) directly estimates nonlinear distortion and noise, enabling bias correction in the FRF and structured estimation of $H^{(q)}_2$ \citep{pintelon2012system}.

Estimation proceeds in two coupled stages, both leveraging leakage-corrected spectral regression and regularization for statistical efficiency under internal variability \citep{ljung1999system,pintelon2012system}. First, we obtain a linear FRF estimate at each excited line using
\begin{equation}
\label{eq:frf_est}
\widehat{H}^{(q)}_1(\omega_\ell) \;=\; \frac{\widehat{S}_{y^{(q)}u}(\omega_\ell)}{\widehat{S}_{uu}(\omega_\ell)} \;-\; \widehat{B}^{(q)}(\omega_\ell),
\end{equation}
where $\widehat{S}_{y^{(q)}u}$ and $\widehat{S}_{uu}$ are multitaper or windowed cross- and auto-spectral estimates at $\omega_\ell$ with small-sample leakage correction, and $\widehat{B}^{(q)}$ subtracts the expected second-order bias inferred from detection-line statistics and neighboring intermodulation lines \citep{pintelon2012system}. Second, we estimate the second-order kernel by pooling all output lines and solving a weighted, sparsity- and smoothness-regularized least-squares problem:
\begin{equation}
\label{eq:volterra_est}
\min_{\theta^{(q)}} \;\;\big\| W^{1/2}\big(y^{(q)} - \Phi \theta^{(q)}\big)\big\|_2^2 \;+\; \lambda_1 \|\theta^{(q)}\|_1 \;+\; \lambda_2 \|D\,\theta^{(q)}\|_2^2,
\end{equation}
where $y^{(q)}$ stacks $Y^{(q)}(\omega)$ across lines, $\Phi$ concatenates the linear regressors $\{U(\omega)\}$ and quadratic regressors $\{U(\omega_i)U(\omega_j)\}_{\omega_i+\omega_j=\omega}$ associated with the discretized $H^{(q)}_2$, $W$ weights by the estimated spectral noise covariance (from detection lines and ensemble spread), $D$ encodes difference operators enforcing smoothness in lag/frequency, and $(\lambda_1,\lambda_2)$ are chosen by cross-validation or L-curve analysis. The $\ell_1$ penalty promotes sparse, low-complexity Volterra surfaces (compact memory, localized cross-frequency couplings), while the Tikhonov term stabilizes estimates under colored climate variability and finite experiment length \citep{ljung1999system,pintelon2012system}. For multi-output surrogates, we use a group-sparse variant that encourages shared memory scales across outputs while allowing distinct gains.

Validation uses held-out single-tone and two-tone tests embedded in the multisine schedule (E2), reporting: (i) normalized RMSE in the time domain on outputs not used in fitting, (ii) magnitude-squared coherence at excited lines, (iii) a harmonic distortion index (HDI) defined for band $\mathcal{B}$ by
\begin{equation}
\label{eq:hdi}
\mathrm{HDI}_{\mathcal{B}}^{(q)} \;=\; \frac{\sum_{\omega \in \mathcal{B}\cap \mathcal{H}} |Y^{(q)}(\omega)|^2}{\sum_{\omega \in \mathcal{B}\cap \Omega} |Y^{(q)}(\omega)|^2},
\end{equation}
where $\mathcal{H}$ collects harmonic and intermodulation lines implied by \eqref{eq:volterra_freq}, and (iv) cross-frequency prediction error for two-tone intermodulation. The HDI and the energy of $\widehat{H}^{(q)}_2$ in low-frequency neighborhoods provide interpretable measures of nonlinearity that complement linear FRF phase/gain, with direct read-through to the early-warning experiment (E4): drift of low-frequency phase toward $-\pi$ and growth in HDI under increasing baseline forcing are hypothesized indicators of diminishing stability margins \citep{pintelon2012system,macmartin2014dynamicsof}.

Input design is critical for identifiability and risk management. We construct random-phase multisines with: (a) line spacing commensurate with record length and memory to limit leakage; (b) tailored amplitude spectra to maximize Fisher information on $\{H^{(q)}_1,H^{(q)}_2\}$ subject to constraints on SAOD variance and ozone-relevant metrics; and (c) reserved detection lines for unbiased nonlinearity/noise estimation \citep{ljung1999system,pintelon2012system}. Within our amplitude envelope (0.05–0.5 TgS yr$^{-1}$ RMS around a 5 TgS yr$^{-1}$ baseline), the weakly nonlinear assumption is consistent with the small-signal operating regime used in closed-loop analyses of geoengineering and in ensemble protocols \citep{macmartin2014dynamicsof,tilmes2018stratospheric,richter2022assessingresponses}. Fisher-information-based allocation across frequency bands balances interannual sensitivity (temperature, SAOD) against higher-frequency hydrological modes to ensure precise recovery of both memory and cross-frequency couplings \citep{ljung1999system}.

The resulting Volterra surrogates integrate seamlessly with our control and warning layers. For control synthesis (E3), we form a quadratic Koopman-style lifting of \eqref{eq:volterra_time}, yielding a linear predictor in an augmented feature space that supports robust H-infinity loop-shaping around the identified linear FRF while accounting for bounded quadratic residuals, or scenario-based MPC that penalizes predicted HDI and SAOD excursions alongside GMST tracking \citep{macmartin2014dynamicsof}. For early warning (E4), we track the temporal evolution of $\widehat{H}^{(q)}_1$ phase at low frequencies and of $\mathrm{HDI}^{(q)}$ within bands sensitive to hydrological and circulation responses; rising nonlinear distortion and phase drift under gradually increased offsetting are used as high-signal indicators of approach to instability, to be compared against passive variance and autocorrelation benchmarks.

Practical implementation details for E2 are as follows. We use $L_1\approx 60$ and $L_2\approx 36$ months to capture multi-annual memory while controlling dimensionality; symmetric $h_2$ halves the parameter count. Spectral regression employs multitaper estimates with adaptive weights for colored backgrounds. Regularization paths $(\lambda_1,\lambda_2)$ are selected by K-fold splits across years and ensemble members, and uncertainty is quantified by block bootstrap over seasons and by across-ensemble variability. All experiments are conducted in silico within established Earth system modeling protocols \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, with governance-relevant caution that active perturbations remain small and diagnostic, and that any control synthesis is confined to model space with explicit uncertainty communication \citep{keith2010researchon,robock200820reasons}.


% === AREA: Robust control techniques (H-infinity, MPC) for climate stabilization. ===

\subsection{Robust control synthesis from active spectroscopy}
The identified, frequency-resolved mappings from stratospheric aerosol injection (SAI) rate to climate outputs (Section E1–E2) enable principled synthesis of feedback policies that trade tracking performance against regional risk, while explicitly accounting for uncertainty and nonlinear distortions. We design two complementary classes of controllers: (i) H-infinity mixed-sensitivity loop-shaping to secure worst-case stability/performance across an uncertainty set inferred from the spectral identification, and (ii) constraint-aware model predictive control (MPC) based on Koopman-regressed predictors. Closed-loop SAI has been argued to reduce sensitivity to model errors and disturbances in the coupled human–climate system \cite{macmartin2014dynamicsof}; here we operationalize this idea with information-aware weights and uncertainty models grounded in our active-spectroscopy experiments and evaluated in SAI-enabled Earth system models (ESMs) \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}.

\paragraph{Uncertain plant from spectral identification.}
Let \(u_k\) denote the discrete-time SAI control signal (e.g., injection rate anomaly relative to a baseline scenario) and \(y_k \in \mathbb{R}^p\) collect outputs such as global-mean surface temperature (GMST), regional precipitation indices, and stratospheric aerosol optical depth (SAOD). Small-signal identification yields a nominal multi-output frequency response \(\hat{G}_{yu}(e^{j\omega}) \in \mathbb{C}^{p\times 1}\) and variance/interval estimates across the probed band \(\omega \in \Omega\) using spectral regression with leakage correction \cite{pintelon2012system,ljung1999system}. We represent model-form and sampling uncertainty as multiplicative perturbations
\begin{equation}
G_{yu}(e^{j\omega}) \;=\; \hat{G}_{yu}(e^{j\omega})\bigl(I + W_m(e^{j\omega}) \Delta_m(e^{j\omega})\bigr), \qquad \|\Delta_m\|_\infty \le 1,
\end{equation}
with diagonal weight \(W_m\) chosen so that \(\|W_m(\omega)\|_2\) upper-bounds the identified relative error, e.g., from bootstrap confidence bands or Fisher-information–derived covariance mapped to frequency \cite{pintelon2012system}. Nonlinear distortions estimated via sparse Volterra kernels (Section E2) enter as an amplitude-dependent residual \(n_k\); for robust design we treat \(n_k\) as a bounded, color-shaped uncertainty whose gain scales with the measured harmonic distortion index \(\mathrm{HDI}(\omega)\), inflating \(W_m\) where nonlinear energy is concentrated. Exogenous variability and shocks (e.g., ENSO-like fluctuations, episodic volcanic aerosols) are modeled as disturbances \(w_k\) entering additively at plant input/output channels with empirically fitted spectra from the unforced model runs.

\paragraph{H-infinity mixed-sensitivity design.}
We synthesize a discrete-time controller \(K(z)\) that minimizes the worst-case closed-loop amplification of reference, disturbance, and uncertainty inputs over monthly to interannual bands relevant for SAI operation. Denote the sensitivity \(S=(I+G K)^{-1}\) and complementary sensitivity \(T=I-S\). We solve the standard mixed-sensitivity problem
\begin{equation}
\min_{K} \;\gamma \quad \text{s.t.}\quad
\Bigl\| \begin{bmatrix}
W_e(z) S(z) \\[3pt]
W_u(z) K(z) S(z) \\[3pt]
W_m(z) T(z)
\end{bmatrix} \Bigr\|_{\infty} \;<\; \gamma,
\label{eq:hinf}
\end{equation}
where:
(i) \(W_e\) shapes tracking/attenuation priorities per output: we emphasize low-frequency GMST tracking (decadal band) and place higher penalties on mid-frequency precipitation variability to avoid hydrological side-effects; 
(ii) \(W_u\) penalizes actuation magnitude and slew (encoded with a discrete-time derivative filter) to limit SAOD excursions and operational volatility; 
(iii) \(W_m\) enforces robust stability/performance against the identified multiplicative uncertainty, enlarged in bands with low coherence or high \(\mathrm{HDI}\). Weighting templates are initialized from \(\hat{G}_{yu}\) and its confidence envelopes \cite{pintelon2012system}, then tuned to meet SAI-specific limits derived from ARISE-SAI and CESM1(WACCM) ensembles \cite{richter2022assessingresponses,tilmes2018stratospheric}. The optimization in \eqref{eq:hinf} is solved with standard discrete-time Riccati/LMI methods; we adopt a two-degree-of-freedom architecture with a low-order prefilter for reference commands and incorporate anti-windup for hard bounds on \(u_k\). This loop-shaping guarantees margins against modeling error and internal variability in the probed bands, addressing key concerns about unforeseen responses to SAI \cite{robock200820reasons} by construction of worst-case performance bounds.

\paragraph{Constraint-aware MPC with Koopman predictors.}
Complementing the frequency-shaped \(H_\infty\) inner loop, we formulate a supervisory MPC that handles multi-output constraints and slow target evolution. Using Koopman-regressed linear predictors fit on the actively probed data (Section E2), we obtain
\begin{equation}
x_{k+1} = A x_k + B u_k + E d_k, \qquad y_k = C x_k + v_k,
\end{equation}
with disturbance \(d_k\) and residual \(v_k\) calibrated from identification errors. The MPC solves, at each month,
\begin{align}
\min_{\{u_{k+i}\}} \; & \sum_{i=0}^{N-1} \bigl\|Q\bigl(y_{k+i}-r_{k+i}\bigr)\bigr\|_2^2 \;+\; \|\!R \Delta u_{k+i}\!\|_2^2 \\
\text{s.t.}\;\; & x_{k+i+1}=A x_{k+i}+B u_{k+i} + E d_{k+i}, \;\; y_{k+i}=C x_{k+i}, \nonumber\\
& u_{\min} \le u_{k+i} \le u_{\max}, \;\; |\Delta u_{k+i}| \le \Delta u_{\max}, \nonumber\\
& y_{k+i} \in \mathcal{Y} \;\; \text{(e.g., SAOD and regional precipitation envelopes)}, \nonumber
\end{align}
using either tube MPC (with a disturbance invariant set estimated from residuals) or scenario-based MPC for colored variability. This layer enforces operational and impact constraints explicitly, and can embed early-warning–aware soft constraints that tighten when phase lag drifts toward \(-\pi\) or harmonic growth is detected (Section E4). Recent results support the feasibility of MPC for SAI-like tasks and carbon-management analogs under deep uncertainty \cite{enhanced_4_20250812,enhanced_4_20250812Comprehensive}.

\paragraph{From identified spectra to weights and constraints.}
All weights and robust sets are derived from, and updated by, the active-spectroscopy diagnostics:
(i) \(W_m(\omega)\) is set from relative FRF uncertainty and inflated where \(\mathrm{HDI}\) is elevated; 
(ii) \(W_e(\omega)\) is shaped to reflect policy priorities (tight GMST tracking below \(\sim 0.1\) yr\(^{-1}\); strong attenuation of precipitation variability in the seasonal band), consistent with ensemble sensitivities reported in SAI protocols \cite{richter2022assessingresponses,tilmes2018stratospheric}; 
(iii) MPC constraint sets \(\mathcal{Y}\) use ARISE-SAI and GeoMIP ranges \cite{kravitz2011thegeoengineering,richter2022assessingresponses} to bound SAOD and regional anomalies, with slack penalization tuned to maintain feasibility under volcanic-like shocks.

\paragraph{Evaluation and guarantees.}
We report standard robust-control metrics in the E3 experiments: temperature-tracking RMSE, constraint violation rate, controller effort (total variation norm), and worst-case regional anomaly under multi-model uncertainty sets. Frequency-domain robustness is quantified via closed-loop margins and the bound \(\|[W_e S,\, W_u K S,\, W_m T]\|_\infty\) achieved in \eqref{eq:hinf}. Cross-model transfers (E5) assess generalization by re-evaluating these bounds in a second model tier without retuning. The combined \(H_\infty\)+MPC architecture is designed to outperform continuous or naive pulsed baselines by exploiting identified dynamics while providing explicit safeguards against instability and unintended impacts, aligning with calls for carefully controlled and risk-aware geoengineering research \cite{keith2010researchon,robock200820reasons}.

\paragraph{Positioning within the literature.}
Our synthesis connects frequency-domain system identification and robust control \cite{ljung1999system,pintelon2012system} to contemporary SAI simulation infrastructures \cite{tilmes2018stratospheric,richter2022assessingresponses} and closed-loop climate control concepts \cite{macmartin2014dynamicsof}. Information-optimized probing tightens uncertainty sets and, consequently, robust performance bounds; the value of information for control is central in this setting and motivates our experimental design \cite{enhanced_2_20250812,enhanced_6_20250812}. Early-warning signals based on phase drift and harmonic growth can be integrated as supervisory triggers to tighten weights/constraints before loss of robustness, complementing classical variance/autocorrelation indicators \cite{enhanced_5_20250812}. Together, these elements realize an active, information-theoretic pathway from designed perturbations to certified controllers for SAI.


% === AREA: Early warning signals for climate tipping points and instability. ===

\subsection{Early-warning spectroscopy for instability detection}
Closed-loop geoengineering introduces additional dynamical feedbacks between intervention and climate state that may create or exacerbate instabilities if operated near the limits of controllability \cite{macmartin2014dynamicsof}. Given long adjustment times and coupled modes (e.g., stratosphere--troposphere exchange, ocean heat uptake), early detection of degrading stability margins is essential for safe operation and governance \cite{robock200820reasons,keith2010researchon}. We propose an active early-warning module that leverages the same small-amplitude, information-optimized probes used for system identification to track frequency-resolved indicators of approaching instability: phase-lag drift and growth of nonlinear harmonic/intermodulation content. The approach builds on frequency-domain system identification and leakage-robust spectral methods \cite{ljung1999system,pintelon2012system}, and is implementable in existing SAI experiment protocols and ensembles \cite{tilmes2018stratospheric,richter2022assessingresponses,kravitz2011thegeoengineering}.

\paragraph{Concept.}
Consider a small probe signal $u(t)$ (e.g., multi-sine or PRBS) superimposed on a baseline SAI injection $\bar{u}$ within an Earth system model (ESM). For an output $y(t)$ (e.g., GMST, Sahel JJA precipitation, SAOD, circulation indices), we estimate the local, small-signal frequency response function (FRF) in a sliding time window $W$:
\begin{equation}
\hat{H}_W(\omega) \;=\; \frac{\hat{S}_{yu,W}(\omega)}{\hat{S}_{uu,W}(\omega)} \,,
\quad
\hat{C}_{yu,W}(\omega) \;=\; \frac{|\hat{S}_{yu,W}(\omega)|^2}{\hat{S}_{uu,W}(\omega)\,\hat{S}_{yy,W}(\omega)} \,,
\label{eq:frf}
\end{equation}
where $\hat{S}_{\cdot,W}$ denotes windowed, leakage-corrected spectral estimates (e.g., multi-taper or parametric spectral regression \cite{pintelon2012system}), and $\hat{C}_{yu,W}$ is the magnitude-squared coherence to screen frequencies with adequate signal-to-noise ratio (SNR). The phase $\phi_W(\omega) = \arg \hat{H}_W(\omega)$ and gain $G_W(\omega) = |\hat{H}_W(\omega)|$ summarize linear dynamics from injection rate to output. Nonlinear distortions generated by the climate response under the probe are quantified by power at harmonics and intermodulation frequencies that are absent in a purely linear response.

\paragraph{Phase-drift early warning.}
As a system approaches loss of stability (e.g., poles drifting toward the imaginary axis/zero-damping limit), phase lags typically increase near the affected time scales. To track this, we define a band-averaged phase drift index over a frequency band $\mathcal{B}$:
\begin{equation}
\mathrm{PDI}_{t_1\to t_2}(\mathcal{B}) \;=\; \frac{\sum_{\omega \in \mathcal{B}} w(\omega)\,\Delta\phi(\omega)}{\sum_{\omega \in \mathcal{B}} w(\omega)} \,,
\quad
\Delta\phi(\omega) \;=\; \mathrm{unwrap}\big(\phi_{W_2}(\omega) - \phi_{W_1}(\omega)\big),
\label{eq:pdi}
\end{equation}
where $W_1$ and $W_2$ are successive windows centered at $t_1$ and $t_2$, respectively, and $w(\omega) = \hat{C}_{yu,W}(\omega)$ downweights low-coherence frequencies. Negative values (drift toward $-\pi$) sustained across adjacent bands (monthly to interannual) constitute an early-warning flag. Because the probes isolate input--output pathways, $\mathrm{PDI}$ directly reflects changes in controllable dynamics, complementing passive variance/autocorrelation indicators that conflate forcing, internal variability, and slow trend contributions. Classical identification theory supports the superior efficiency of designed excitations for tracking parametric drift in dynamical systems \cite{ljung1999system,pintelon2012system}.

\paragraph{Harmonic-distortion early warning.}
In weakly nonlinear regimes, multi-sine excitation $u(t) = \sum_{m=1}^{M} a_m \sin(2\pi f_m t + \varphi_m)$ produces output energy at harmonics $2f_m, 3f_m,\ldots$ and at intermodulation tones $f_m \pm f_n$. We monitor the harmonic distortion index (HDI) in a window $W$:
\begin{equation}
\mathrm{HDI}_W \;=\; \frac{\sum_{\nu \in \mathcal{H}} \hat{S}_{yy,W}(\nu)}{\sum_{\nu \in \mathcal{F}} \hat{S}_{yy,W}(\nu)} \,,
\quad
\mathcal{F}=\{f_1,\ldots,f_M\},\;
\mathcal{H}=\{2f_m,\,3f_m,\,f_m\!\pm\! f_n\}_{m\neq n},
\label{eq:hdi}
\end{equation}
with frequencies selected away from known internal climate peaks to avoid aliasing. Rising $\mathrm{HDI}_W$ at fixed probe amplitude indicates growing nonlinearity and cross-frequency coupling, consistent with increased Volterra second-order contributions. When second-order Volterra kernels $\hat{G}_2(\omega_1,\omega_2)$ are estimated (Sec. E2), we can form a model-based nonlinear energy ratio
\begin{equation}
\mathrm{NER}_W \;=\; \frac{\sum_{\omega_1,\omega_2 \in \mathcal{F}} |\hat{G}_2(\omega_1,\omega_2)|^2\,\hat{S}_{uu,W}(\omega_1)\,\hat{S}_{uu,W}(\omega_2)}{\sum_{\omega \in \mathcal{F}} |\hat{H}_W(\omega)|^2\,\hat{S}_{uu,W}(\omega)} \,,
\label{eq:ner}
\end{equation}
which grows as quadratic interactions intensify. These distortion metrics connect directly to the surrogate models used downstream for robust control synthesis (Sec. E3), enabling controllers to adapt their bandwidth and effort before nonlinearities compromise performance.

\paragraph{Detection protocol and evaluation (E4).}
We implement early-warning spectroscopy within the experimental protocol as follows.
\begin{enumerate}
\item Superimpose low-amplitude, information-optimized probes (0.05--0.5 TgS yr$^{-1}$ RMS) on a steady SAI baseline $\bar{u}$, with frequencies spanning 0.02--2 cycles yr$^{-1}$ and phases chosen to maximize Fisher information under variance and ozone constraints \cite{ljung1999system,pintelon2012system}. Execute in ensembles following ARISE-SAI and CESM-WACCM practices to characterize variability and uncertainty \cite{richter2022assessingresponses,tilmes2018stratospheric}.
\item Estimate $\hat{H}_W(\omega)$, $\phi_W(\omega)$, and $\mathrm{HDI}_W$ in sliding windows (e.g., 5-year windows with 1-year stride), applying leakage correction and coherence screening \cite{pintelon2012system}.
\item Gradually increase baseline forcing (e.g., ramp $\bar{u}$ to offset stronger warming, or impose exogenous perturbations such as volcanic analogs in scenario experiments), recomputing $\mathrm{PDI}_{t\to t+\Delta}$ and $\Delta\mathrm{HDI}$ across bands.
\item Trigger criteria: declare an early-warning state if (i) $\mathrm{PDI}$ falls below a negative threshold in two adjacent bands and (ii) $\mathrm{HDI}$ or $\mathrm{NER}$ exceeds a quantile-based threshold relative to an initial baseline distribution, with false discovery control across outputs.
\item Benchmark against passive indicators computed from $y(t)$ (variance, lag-1 autocorrelation) using the same windows. Report lead time to threshold crossing, area under the ROC curve (AUC) across ensemble members, and false positive rates under stationary baselines.
\end{enumerate}
Because the probes target the actuation pathway, the resulting indicators are directly actionable for controller scheduling and constraint tightening. This aligns with recommendations to consider closed-loop dynamics explicitly when assessing geoengineering risks and operations \cite{macmartin2014dynamicsof}.

\paragraph{Integration with control and cross-model robustness.}
The estimated phase and distortion trends inform robust control design by shaping bandwidth, gain, and slew-rate constraints in H-infinity/MPC synthesis (Sec. E3), reducing the risk of exciting near-resonant or increasingly nonlinear modes. In multi-model assessments (GeoMIP-style tiers \cite{kravitz2011thegeoengineering}), we will test portability of thresholds and trends across an idealized aquaplanet/EMIC and a coarser ESM with interactive stratospheric chemistry \cite{richter2022assessingresponses}, quantifying cross-model consistency. Large ensembles \cite{tilmes2018stratospheric} provide sampling to estimate uncertainty in $\mathrm{PDI}$ and $\mathrm{HDI}$ under internal variability, supporting governance-relevant confidence bounds \cite{robock200820reasons}.

\paragraph{Why active early warning.}
Designed, low-amplitude probes concentrate information at diagnostically relevant frequencies and disentangle input--output pathways from background variability, a hallmark advantage of frequency-domain identification \cite{ljung1999system,pintelon2012system}. This makes phase-drift and harmonic-growth indicators more sensitive---and more specific to controllable dynamics---than passive metrics computed solely from outputs. By embedding early-warning spectroscopy within the identification and control loop, the framework operationalizes continuous ``health monitoring'' of the climate response to SAI, consistent with the need for careful, stepwise research and rigorous risk management \cite{keith2010researchon}.


% === AREA: Fisher information maximization for experimental design in complex systems. ===

\subsection{Information-optimal active probing for frequency-domain system identification}

We formalize the design of pulsed SAI probes as an input design problem that maximizes the information content of small-amplitude excitations about a steady baseline, subject to environmental and operational constraints. In contrast to scenario-based forcing experiments (e.g., GeoMIP; \citep{kravitz2011thegeoengineering}) or large ensembles with fixed schedules \citep{tilmes2018stratospheric,richter2022assessingresponses}, our goal is to deliberately shape the power and phases of multi-sine/PRBS/chirp perturbations to optimize identifiability of the frequency response and low-order nonlinearities relevant for control. The approach builds on classical system identification and frequency-domain experiment design \citep{ljung1999system,pintelon2012system}, adapted to the Earth system context with colored internal variability, multi-output objectives, and safety constraints (e.g., SAOD and ozone burden).

We consider small perturbations in the injected sulfur flux around a baseline schedule, writing the perturbation as
\begin{equation}
\delta u_t \;=\; \sum_{k\in\mathcal{K}} a_k \sin(\omega_k t + \phi_k),
\quad \omega_k \in [\omega_{\min}, \omega_{\max}],
\label{eq:multisine}
\end{equation}
where $\mathcal{K}$ is a set of discrete frequency lines spanning monthly to interannual bands (e.g., $0.02$--$2$ cycles yr$^{-1}$, consistent with E1), with amplitudes $a_k$ and phases $\phi_k$ chosen to achieve low crest factor and high information content \citep{pintelon2012system}. For PRBS and logarithmic chirps, analogous expressions hold for the power spectral density (PSD) allocation across $\mathcal{K}$.

Around the operating point, we approximate the input–output map from $\delta u$ to a vector of outputs $y=(y_1,\dots,y_m)$ (e.g., global mean surface temperature, regional precipitation indices, stratospheric winds) by a stable linear time-invariant system plus small nonlinear distortions:
\begin{equation}
Y_j(\omega) \;=\; G_j(\e^{\mathrm{i}\omega};\theta)\,U(\omega) \;+\; V_j(\omega) \;+\; \mathcal{O}(\|\delta u\|^2),
\label{eq:lti}
\end{equation}
where $G_j$ denotes the frequency response of output $j$, $U$ is the DFT of $\delta u$, $V_j$ is colored internal variability with PSD $S_{v,j}(\omega)$, and $\theta$ parameterizes $G=(G_1,\dots,G_m)$ (e.g., a low-order stable rational model or a piecewise-smooth Bode representation). The second-order term is treated separately via Volterra kernels in E2; here it informs probe design by reserving detection lines to diagnose harmonics and intermodulation \citep{pintelon2012system}.

Under Gaussian disturbances, the Fisher information matrix (FIM) for $\theta$ induced by a periodic experiment of length $N$ samples is well approximated in the frequency domain by \citep{ljung1999system,pintelon2012system}
\begin{equation}
\mathcal{I}(\theta) \;\approx\; 2N \sum_{k\in\mathcal{K}} \left( \sum_{j=1}^m \frac{|U(\omega_k)|^2}{S_{v,j}(\omega_k)}\, \Psi_{j}(\omega_k;\theta)^\ast \Psi_{j}(\omega_k;\theta) \right),
\label{eq:fim}
\end{equation}
where $\Psi_{j}(\omega;\theta) \equiv \partial G_j(\e^{\mathrm{i}\omega};\theta)/\partial \theta$ and ${}^\ast$ denotes conjugate transpose. When identifying a nonparametric FRF at the excited lines (i.e., $\theta$ collects the real and imaginary parts of $G_j(\omega_k)$), \eqref{eq:fim} becomes diagonal with entries proportional to $|U(\omega_k)|^2/S_{v,j}(\omega_k)$, highlighting the key role of spectral SNR.

We pose input design as allocating spectral power across $\mathcal{K}$ to optimize a scalar function of $\mathcal{I}(\theta)$, subject to physical and governance constraints:
\begin{align}
\max_{\{a_k,\phi_k\}} \quad & \Phi\big(\mathcal{I}(\theta)\big)
\label{eq:design_objective}\\[2pt]
\text{s.t.} \quad & \frac{1}{T}\sum_{t=1}^T \big(u_{\mathrm{base}} + \delta u_t\big) \leq u_{\max}, \quad u_{\mathrm{base}} + \delta u_t \ge 0 \quad \forall t, \label{eq:rate_bounds}\\
& \| H_{\mathrm{SAOD}} \delta u \|_{\infty} \le \Delta \mathrm{SAOD}_{\max}, \label{eq:saod_bound}\\
& \mathrm{CF}(\delta u) \le \mathrm{CF}_{\max}, \quad \sum_{k\in\mathcal{K}} a_k^2 \le P, \label{eq:energy_crest}
\end{align}
where $\Phi$ may be D-optimality $\Phi=\log\det(\mathcal{I})$, A-optimality $\Phi=-\mathrm{tr}(\mathcal{I}^{-1})$, or E-optimality, $H_{\mathrm{SAOD}}$ is a linearized mapping from injection to SAOD, and CF denotes crest factor. The aggregate power constraint $P$ captures RMS amplitude budgets (e.g., $0.05$–$0.5$ TgS yr$^{-1}$ RMS as in E1), while \eqref{eq:rate_bounds} enforces non-negativity of the absolute injection rate and an upper bound motivated by prior SAI protocols \citep{kravitz2011thegeoengineering,richter2022assessingresponses}. The SAOD constraint \eqref{eq:saod_bound} and related ozone safeguards operationalize the “minimally invasive” imperative stressed in the geoengineering risk literature \citep{robock200820reasons} and calls for careful, small-scale research \citep{keith2010researchon}.

Because $|U(\omega_k)|^2$ enters \eqref{eq:fim} linearly and $\log\det(\cdot)$ is concave, D- and A-optimal designs in the spectral weights are convex in the variables $p_k \equiv |U(\omega_k)|^2$ when constraints are expressed in quadratic/linear approximations (e.g., using convex surrogates for crest factor via phase randomization and for \eqref{eq:saod_bound} via induced norms). For multi-output identification, we incorporate priorities through a positive semidefinite weighting $W$ on parameter subsets or outputs, optimizing $\Phi(\mathcal{I}_W)=\log\det(W^{1/2}\mathcal{I}W^{1/2})$ \citep{ljung1999system}. Practical solutions instantiate $p_k$ through multi-sine amplitudes $a_k$ with random-phase or Schroeder-phase sequences to reduce crest factor while retaining the optimized spectrum \citep{pintelon2012system}.

Colored internal variability strongly shapes identifiability. We estimate $S_{v,j}(\omega)$ from control-run or baseline SAI ensembles (e.g., CESM1(WACCM) and ARISE-SAI protocols; \citep{tilmes2018stratospheric,richter2022assessingresponses}), and pre-whiten outputs in estimation, consistent with frequency-domain identification practice \citep{pintelon2012system}. The resulting Cramér–Rao bounds make the amplitude–duration–ensemble trade-offs explicit. For a nonparametric FRF estimate at line $\omega_k$ and output $j$,
\begin{equation}
\mathrm{Var}\big[\widehat{G}_j(\omega_k)\big] \;\approx\; \frac{c}{N_{\mathrm{eff}}}\,\frac{S_{v,j}(\omega_k)}{|U(\omega_k)|^2},
\label{eq:crlb}
\end{equation}
where $c$ depends on leakage/tapering and $N_{\mathrm{eff}}$ is the effective number of periods/ensemble members. Equation \eqref{eq:crlb} underpins E6: to reach a target spectral error budget $\epsilon^2(\omega_k)$ one can solve for the minimal experiment length $N_{\mathrm{eff}}$ or the minimal RMS amplitude given $S_{v,j}(\omega_k)$, then verify compliance with \eqref{eq:rate_bounds}–\eqref{eq:energy_crest}. The same logic applies to parametric models via \eqref{eq:fim}, enabling principled power allocation (“water-filling”) toward frequencies with high sensitivity-to-noise ratios $\sum_j \|\Psi_j(\omega_k;\theta)\|^2/S_{v,j}(\omega_k)$.

Nonlinearity-aware probing follows standard multisines practice \citep{pintelon2012system}: we reserve “detection lines” (unexcited input frequencies) within each band to quantify harmonic distortion at $2\omega_k,3\omega_k,\dots$ and intermodulation products, which informs sparse second-order Volterra kernel estimation in E2. To support robust control synthesis (E3), we bias information toward crossover bands where closed-loop sensitivity is most critical. For example, if a candidate controller will place the temperature loop crossover near an annual band, we emphasize those lines in $\mathcal{K}$ to reduce uncertainty in gain/phase there, leveraging the well-known link between frequency-response uncertainty and closed-loop performance margins \citep{ljung1999system} and prior demonstrations of SAI feedback control \citep{macmartin2014dynamicsof}.

Implementation details that improve estimator efficiency and reduce leakage include: (i) choosing $N$ as an integer number of periods for all $\omega_k$; (ii) using synchronized sampling (monthly means) and appropriate tapers; (iii) distributing $a_k$ within bands to flatten the predicted parameter covariance (L-curve tuning) under \eqref{eq:fim}; and (iv) sequential (adaptive) design that alternates estimation and re-optimization of $\{p_k\}$ as $\widehat{\theta}$ and $\widehat{S}_{v}$ are updated \citep{ljung1999system}. In practice, we proceed as follows:
\begin{enumerate}
\item Estimate $S_{v,j}(\omega)$ from baseline ensembles and specify a parametric or semi-parametric $\theta$ for $G$ over the target bands.
\item Solve \eqref{eq:design_objective}–\eqref{eq:energy_crest} for $p_k^\star$ with D- or A-optimality, then realize a multi-sine with phases chosen to minimize crest factor subject to detection-line constraints.
\item Run the periodic experiment for $N$ months/years, monitor SAOD/ozone guardrails online, and update $\widehat{\theta}$ via spectral regression with leakage correction \citep{pintelon2012system}.
\item If needed, adapt $\mathcal{K}$ and $\{p_k\}$ to target remaining high-variance parameters or to stress prospective closed-loop crossover frequencies before controller synthesis \citep{macmartin2014dynamicsof}.
\end{enumerate}

The information-theoretic design articulated here directly supports E1 (active probing and identifiability) and E6 (practicality bounds), while respecting constraints and practices established in community protocols \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. By concentrating limited excitation power where it most reduces uncertainty in gain/phase—and by reserving detection lines for nonlinear diagnosis—this framework delivers the compact, high-fidelity surrogate dynamics needed for robust SAI controllers and for phase/harmonic early-warning indicators, without resorting to invasive forcing levels that raise governance concerns \citep{robock200820reasons,keith2010researchon}.


% === AREA: Cross-model validation techniques for climate models and surrogate models. ===

\subsection{Cross-model validation, transferability, and robustness}

A central requirement for any actionable SAI control architecture is that identified dynamics, surrogate models, and synthesized controllers remain valid under plausible structural differences across Earth system models (ESMs). Multi-model intercomparison and large-ensemble studies have repeatedly shown that SAI responses vary across modeling systems and across experimental protocols, particularly for regional hydrology and stratosphere–troposphere coupling \citep{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}. We therefore embed cross-model validation and transferability into the active spectroscopy framework to (i) quantify what frequency-domain features are invariant enough to support policy-relevant control, and (ii) design controllers that maintain performance across an explicitly modeled set of plant uncertainties, following standard practice in robust identification and control \citep{ljung1999system,pintelon2012system,macmartin2014dynamicsof}.

\paragraph{Plant set, common stimuli, and comparable outputs.}
Let each model $m\in\mathcal{M}$ (e.g., an idealized aquaplanet/EMIC and a chemistry-enabled CESM-like ESM) be a distinct plant with frequency response $G_m(\omega)$ mapping scalar SAI injection rate perturbations $u(t)$ to outputs $y_m(t)$: global-mean surface temperature, regional precipitation indices, and stratospheric/SAOD diagnostics. To ensure comparability, we (a) superimpose identical, small-amplitude multi-sine/PRBS/chirp probe sequences on a common SAI baseline across models; (b) harmonize target outputs via identical diagnostics and filtering; and (c) calibrate the probe amplitude to achieve matched signal-to-noise ratio (SNR) at the relevant bands, acknowledging that sulfur injection-to-SAOD conversion is model dependent \citep{tilmes2018stratospheric,richter2022assessingresponses}. Frequency-domain estimators incorporate leakage and internal-variability corrections \citep{pintelon2012system}.

\paragraph{Multi-model spectral identification and envelopes.}
For each model $m$, we estimate a smooth frequency response $\widehat{G}_m(\omega)$ by spectral regression with Tikhonov regularization on the log-magnitude slope to stabilize ill-conditioned bands. We summarize cross-model variability via the Bode envelope
\[
\underline{g}(\omega)\;=\;\min_{m\in\mathcal{M}} |\widehat{G}_m(\omega)|,\qquad
\overline{g}(\omega)\;=\;\max_{m\in\mathcal{M}} |\widehat{G}_m(\omega)|,
\]
and the phase spread
\[
\Delta\phi(\omega)\;=\;\max_{m,m'} \big|\arg \widehat{G}_m(\omega)-\arg \widehat{G}_{m'}(\omega)\big|.
\]
We also compute the (magnitude-squared) coherence $\gamma^2_m(\omega)$ between $u$ and $y_m$ to bound linear explainability at each band and the harmonic distortion index ${\rm HDI}_m(\omega)$ from second-order Volterra fits to quantify nonlinear energy at harmonics and intermodulation tones \citep{pintelon2012system,ljung1999system}. These diagnostics partition bands into: (i) robustly linear and invariant (high $\gamma^2$, small $\Delta\phi$, tight $\underline{g}$–$\overline{g}$), (ii) model-dependent but linearly predictable, and (iii) nonlinear or weakly excited (low $\gamma^2$, high ${\rm HDI}$).

\paragraph{Multi-task estimation with cross-model coupling.}
To further stabilize identification and promote transferability, we formulate a multi-task spectral estimator that shares structure across models while allowing model-specific deviations:
\[
\min_{\{G_m\}\in\mathcal{H}} \sum_{m\in\mathcal{M}} \int_{\Omega}
w_m(\omega)\,\big|Y_m(\omega)-G_m(\omega)U(\omega)\big|^2\,d\omega
+\lambda_s \sum_{m}\mathcal{R}[G_m]+\lambda_c \int_{\Omega}\mathrm{Var}_{m}\big(G_m(\omega)\big)\,d\omega,
\]
where $\mathcal{H}$ enforces smoothness and minimum-phase constraints where justified, $\mathcal{R}[\cdot]$ penalizes excessive curvature in Bode coordinates, and the coupling term $\mathrm{Var}_m(\cdot)$ shrinks model responses toward a shared envelope in bands with strong evidence of invariance. This is compatible with classical frequency-domain identification and reduces variance without masking genuine structural differences \citep{pintelon2012system,ljung1999system}.

\paragraph{Uncertainty sets for robust control.}
From $\{\widehat{G}_m\}$ we construct an uncertainty set $\mathcal{P}$ suitable for $H_\infty$ synthesis by fitting a nominal $\widehat{G}_0$ and frequency-shaped multiplicative uncertainty $W_\Delta(\omega)$ such that each model satisfies
\[
G_m(\omega)\;=\;\widehat{G}_0(\omega)\big(1+\Delta_m(\omega)W_\Delta(\omega)\big),\qquad \|\Delta_m\|_\infty\le 1,
\]
with $W_\Delta$ chosen to tightly bound the empirical envelope and phase spread in bands with adequate coherence. Nonlinear distortions estimated via second-order Volterra kernels inform additive uncertainty weights $W_n$ that penalize harmonic spillover into protected outputs (e.g., regional precipitation variance). We then design $K$ to minimize the worst-case weighted closed-loop norm
\[
\min_{K}\;\max_{G\in\mathcal{P}} \big\|{\rm diag}\big(W_S(\omega)S(\omega),\,W_T(\omega)T(\omega),\,W_U(\omega)K(\omega)S(\omega)\big)\big\|_\infty,
\]
where $S=(I+GK)^{-1}$ and $T=GK(I+GK)^{-1}$, with weights trading off global temperature tracking, regional hydrological stability, and actuation effort \citep{macmartin2014dynamicsof}. This loop-shaping approach provides guaranteed margins across the identified plant set and directly targets cross-model robustness.

\paragraph{Transfer tests and cross-model generalization metrics.}
We implement explicit cross-model generalization tests aligned with E5:
(i) fit surrogates on model $m$ and predict responses in $m'\neq m$ to common single-tone and multi-tone validations; report normalized RMSE, coherence, and cross-frequency prediction error;
(ii) transfer $K$ designed on $\mathcal{P}\setminus\{m\}$ to the held-out model $m$ and evaluate tracking RMSE, constraint-violation rate, and worst-case regional anomalies under prescribed variability (ENSO-like forcing, volcanic aerosol shocks), benchmarking against continuous and naive pulsing \citep{kravitz2011thegeoengineering,richter2022assessingresponses};
(iii) compute decision regret $\mathcal{R}_m=J_m(K)-J_m(K^\star_m)$ relative to an oracle $K^\star_m$ that knows $G_m$, where $J_m$ is the weighted quadratic cost used in MPC, and summarize robust performance by $\max_m \mathcal{R}_m$.

\paragraph{Protocol considerations and safeguards.}
- Alignment with community protocols: We reuse GeoMIP/ARISE-SAI boundary conditions and diagnostics where feasible to facilitate intercomparison and reproducibility \citep{kravitz2011thegeoengineering,richter2022assessingresponses}. CESM1(WACCM) large-ensemble experience informs ensemble sizing and internal-variability handling \citep{tilmes2018stratospheric}.
- Probe design across models: Input spectra are optimized to maximize Fisher information subject to shared variance/ozone constraints, with band allocation biased toward frequencies exhibiting cross-model coherence and policy relevance (annual–interannual bands for hydrology) \citep{ljung1999system,pintelon2012system}.
- Early-warning transferability: We evaluate whether phase-drift trends toward $-\pi$ and growth in ${\rm HDI}$ under gradually increasing forcing are consistent across models and provide earlier detection than passive variance/autocorrelation, reporting cross-model lead time and AUC; disagreement flags model-dependent tipping-risk signals requiring conservative controller scheduling.

\paragraph{Anticipated outcomes.}
Cross-model validation is expected to reveal: (i) low-frequency gain and phase from SAI to GMST that are comparatively invariant and thus controller-friendly; (ii) model-dependent mid-frequency features linked to circulation and hydrology where multiplicative uncertainty must be wider; and (iii) consistent early-warning signatures in phase and harmonic content that outperform passive baselines in lead time while remaining robust across models. Embedding these findings into $H_\infty$/MPC design provides explicit robustness margins and quantifies transfer risk, advancing SAI governance beyond single-model tuning toward principled, uncertainty-aware operation \citep{macmartin2014dynamicsof,kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}.


% === AREA: Uncertainty quantification methods in climate modeling and control. ===

\subsection{Uncertainty quantification and robustness for active spectroscopy and control}

Robust decision-making for stratospheric aerosol injection (SAI) requires that identification, prediction, and control be accompanied by explicit uncertainty quantification (UQ) that accounts for internal variability, structural model error, and limits of observability. Ensemble and intercomparison studies have repeatedly highlighted substantial spread in SAI responses and sensitivities \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, while governance discussions stress that risks increase if uncertainty is ignored or misrepresented \cite{robock200820reasons,keith2010researchon}. Our active-spectroscopy framework is designed to carry UQ through the entire pipeline: from information-optimal probe design and frequency-domain identification to robust controller synthesis and early-warning detection under uncertainty. Below we formalize the UQ elements used throughout E1–E6 and how they connect to governance-relevant guarantees.

Information-aware experiment design. We pose the multi-sine/PRBS/chirp design as a constrained optimal design problem that maximizes Fisher information about the parameters of the surrogate dynamics while respecting environmental and operational limits. For a linear time-invariant approximation with output spectrum
Y(\omega_k)=G(\mathrm{e}^{\mathrm{j}\omega_k},\theta)\,U(\omega_k)+\varepsilon(\omega_k),
and colored output noise with spectral density S_{\varepsilon}(\omega_k), the frequency-domain Fisher information matrix (FIM) is \cite{ljung1999system,pintelon2012system}
\begin{equation}
\mathcal{I}(\theta)\;=\;\sum_{\omega_k\in\Omega}
\left[\frac{\partial G(\mathrm{e}^{\mathrm{j}\omega_k},\theta)}{\partial \theta}\right]^{\!\!H}
\,\frac{|U(\omega_k)|^2}{S_{\varepsilon}(\omega_k)}\,
\left[\frac{\partial G(\mathrm{e}^{\mathrm{j}\omega_k},\theta)}{\partial \theta}\right],
\label{eq:FIM}
\end{equation}
so that the asymptotic covariance of an efficient estimator satisfies
\Sigma_{\hat{\theta}}\simeq \left(\frac{N}{2}\,\mathcal{I}(\theta)\right)^{-1}, with N the record length. We maximize a scalarized information metric (e.g., D- or A-optimal design, or a weighted trace that emphasizes bands governing hydrology) subject to bounds on probe energy, per-tone amplitude, and state constraints that proxy ozone/SAOD risks:
\begin{align}
\max_{\{U(\omega_k)\}} \quad & \Phi\big(\mathcal{I}(\theta)\big) \\
\text{s.t.}\quad & \sum_{\omega_k}|U(\omega_k)|^2 \le E_{\max},\quad |U(\omega_k)|\le A_{\max}(\omega_k), \nonumber\\
& \mathbb{E}[\mathrm{SAOD}(u)]\le \mathrm{SAOD}_{\max},\ \text{and safety constraints.} \nonumber
\end{align}
This follows the optimal input design literature for (non)linear systems \cite{pintelon2012system,enhanced_6_20250812}, extends spectral regression ideas already used in climate inference \cite{enhanced_9_20250812}, and admits value-of-information evaluation (expected reduction in control regret under the designed pulse vs. passive baselines) \cite{enhanced_2_20250812}.

Identification error bars and coherence. We estimate Bode gain/phase via leakage-corrected spectral regression and report:
(i) parametric uncertainty via \Sigma_{\hat{\theta}} from \eqref{eq:FIM} and delta-method propagation to gain/phase,
(ii) nonparametric confidence intervals using seasonal/block bootstraps that preserve low-frequency climate variability,
(iii) frequency-dependent coherence and noise floors, \gamma^2(\omega)=1/\big(1+S_{\varepsilon}(\omega)/(|G(\omega)|^2 S_u(\omega))\big), to assess identifiability at each band \cite{pintelon2012system}.
We explicitly propagate internal variability by repeating the experiments across ensemble members (E1, E6), in line with common practice in CESM/WACCM and ARISE-SAI protocols \cite{tilmes2018stratospheric,richter2022assessingresponses}.

Nonlinear distortion UQ. To capture harmonics and intermodulation, we identify sparse second-order Volterra kernels,
\begin{equation}
y(t) = \sum_{\tau} h_1(\tau)\,u(t-\tau)+\sum_{\tau_1,\tau_2} h_2(\tau_1,\tau_2)\,u(t-\tau_1)u(t-\tau_2)+\eta(t),
\end{equation}
with regularization and orthogonal forward selection for parsimony \cite{enhanced_12_20250812}. We quantify nonlinear uncertainty by:
(i) stability selection across resampled datasets to obtain inclusion probabilities for kernel coefficients,
(ii) cross-frequency prediction error on held-out single-tone tests (E2),
(iii) credible intervals for the harmonic distortion index (HDI) via bootstrap.
These steps connect to broader data-driven nonlinear discovery in climate \cite{enhanced_3_20250812}.

Predictive uncertainty and spectral risk metrics. For any candidate control schedule u(t), the predicted output spectrum and variance decompose as
\begin{equation}
S_{y}(\omega)=|G(\omega,\hat{\theta})|^2 S_{u}(\omega)+S_{\varepsilon}(\omega)+\underbrace{\Delta_{\mathrm{ID}}(\omega)}_{\text{ID uncertainty}}+\underbrace{\Delta_{\mathrm{NL}}(\omega)}_{\text{nonlinear residual}},
\end{equation}
where \Delta_{\mathrm{ID}}(\omega) uses the delta method,
\Delta_{\mathrm{ID}}(\omega)\approx \nabla_{\theta}|G(\omega,\theta)|^2\big|_{\hat{\theta}}^{\!\!T}\,\Sigma_{\hat{\theta}}\,\nabla_{\theta}|G(\omega,\theta)|^2\big|_{\hat{\theta}},
and \Delta_{\mathrm{NL}} accounts for neglected higher-order harmonics estimated from Volterra residuals. We summarize spectral risk into banded metrics aligned to policy-relevant outcomes (e.g., interannual bands for hydrology), complementing mean-squared tracking error.

Robust control synthesis under model uncertainty. Closed-loop SAI must tolerate identification error and unresolved dynamics \cite{macmartin2014dynamicsof}. We adopt two complementary designs:
(i) H-infinity synthesis with multiplicative uncertainty, G_{\text{true}}(s)=G_{\text{id}}(s)\big(1+W_m(s)\Delta(s)\big), \|\Delta\|_{\infty}\le 1, where W_m is fit from identification residuals (by band) and additional low-/high-frequency roll-offs to cover unmodeled dynamics. We choose weights (W_S,W_T,W_u) on sensitivity S, complementary sensitivity T, and control effort to enforce tracking, robustness, and SAOD bounds, minimizing \|T_{zw}\|_{\infty} subject to performance \cite{enhanced_4_20250812}.
(ii) Stochastic MPC on Koopman-regressed linear predictors, with chance constraints on regional precipitation and SAOD:
\begin{align}
\min_{u_{0:H-1}} & \ \sum_{t=0}^{H-1}\big\|\hat{y}_t-y^{\star}_t\big\|_{Q}^2+\|\Delta u_t\|_{R}^2 \\
\text{s.t. } & \ \hat{x}_{t+1}=A(\hat{\theta})\hat{x}_t+B(\hat{\theta})u_t+w_t, \nonumber\\
& \ \mathbb{P}\{C\hat{y}_t\le b\}\ge 1-\alpha,\quad \forall t,\nonumber
\end{align}
where the chance constraints are converted to second-order cones under Gaussian state/output approximations using \Sigma_{\hat{\theta}} and \mathrm{cov}(w_t); Bayesian or distributionally robust variants hedge against model-structure uncertainty \cite{enhanced_8_20250812,enhanced_4_20250812}. We report robustness margins and worst-case regional anomalies (E3).

Cross-model structural uncertainty. Following GeoMIP and large-ensemble practice \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, we treat model structure as a discrete uncertainty. Surrogates identified on different models/tiered complexities (E5) are combined via Bayesian model averaging with weights proportional to out-of-sample likelihood or predictive score \cite{enhanced_8_20250812}, and validated across scales \cite{enhanced_7_20250812}. We quantify cross-model generalization error and controller transfer robustness, and diagnose failure modes when transferring policies between models.

Early warning under uncertainty. We formalize phase-drift and harmonic-growth indicators as sequential tests with explicit false-alarm control. Let \phi_t(\omega) be the estimated phase and \mathrm{HDI}_t(\omega) the distortion index at time t under a ramping baseline. We test H_0:\{\Delta\phi_t,\Delta\mathrm{HDI}_t\} consistent with stationary variability vs. H_1: systematic drift toward instability (e.g., \phi\to -\pi, rising harmonics). A generalized likelihood ratio with bootstrap-calibrated thresholds controls type-I error and provides detection lead-times that we compare to variance/autocorrelation EWS \cite{enhanced_5_20250812}. Because these indicators are grounded in the forced frequency response, they can be more sensitive to loss of phase margin than passive statistics.

Practicality bounds and experiment sizing. The FIM in \eqref{eq:FIM} implies a first-order scaling for identifiability under small-signal excitation:
\begin{equation}
\mathrm{tr}\,\Sigma_{\hat{\theta}}\;\approx\;\kappa\Big/\big(A_{\mathrm{rms}}^2\,T\,K_{\mathrm{eff}}\big),
\end{equation}
where A_{\mathrm{rms}} is probe amplitude, T experiment duration, and K_{\mathrm{eff}} the number of well-separated, high-coherence tones. This scaling guides E6 trade-offs between amplitude, duration, and ensemble size, allowing us to report minimal designs that achieve target prediction error at acceptable computational cost \cite{enhanced_6_20250812}. Information-centric metrics (e.g., expected value of sample information for control regret reduction) quantify the benefit of active pulses over passive baselines \cite{enhanced_2_20250812}.

Reporting and governance alignment. For each experiment and controller we will release: banded Bode/Volterra posteriors, coherence and noise spectra, prediction intervals for key outcomes, robustness margins, and early-warning detection operating characteristics. This connects identification and control decisions to transparent uncertainty statements grounded in ensemble practice \cite{tilmes2018stratospheric,richter2022assessingresponses}, while acknowledging societal risks of overconfidence \cite{robock200820reasons,keith2010researchon}.


% === AREA: Spectral regression techniques for climate data analysis and system identification. ===

\subsection{Spectral regression for active system identification of the climate response}

We leverage spectral regression to convert designed, small-amplitude pulsed SAI experiments into frequency-resolved estimates of the climate system’s best linear approximation (BLA), complemented by explicit diagnostics of nonlinear distortion. Frequency-domain identification isolates response at prescribed lines, suppresses confounding from colored internal variability, and yields compact surrogate models with quantified uncertainty—precisely the artifacts required for robust controller synthesis and early-warning analysis \cite{ljung1999system,pintelon2012system}. While SAI modeling to date has emphasized step/ramp protocols and ensemble means \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses}, spectral estimators allow us to directly ask how temporal modulation changes outcomes. Our implementation builds on frequency-domain system identification \cite{pintelon2012system}, spectral regression for climate sensitivity estimation \cite{enhanced_9_20250812,enhanced_9_20250812}, and information-optimal input design \cite{enhanced_6_20250812}.

Let the perturbation to an SAI baseline be a designed multisine/PRBS/chirp input u(t) with RMS amplitude 0.05–0.5 TgS yr$^{-1}$, and outputs y(t) comprising GMST, regional precipitation indices, circulation metrics, and SAOD (E1–E2). Over windows within which the dynamics are approximately time-invariant, we model
\[
y(t) \;=\; (G \star u)(t) + e(t), 
\]
where $G$ is the (MIMO) linear dynamics to be identified and $e$ is colored internal variability. With $U(\omega)$, $Y(\omega)$ the discrete Fourier transforms and $\mathbf{S}_{\cdot\cdot}(\omega)$ denoting cross-spectral density matrices, the nonparametric frequency response estimator is
\begin{equation}
\widehat{\mathbf{G}}(\omega_k) \;=\; \widehat{\mathbf{S}}_{yu}(\omega_k)\,\widehat{\mathbf{S}}_{uu}(\omega_k)^{-1}, 
\label{eq:frf}
\end{equation}
with coherence $\gamma^2_y(\omega_k)=\mathrm{diag}\big(\widehat{\mathbf{S}}_{yu}\widehat{\mathbf{S}}_{uu}^{-1}\widehat{\mathbf{S}}_{uy}\widehat{\mathbf{S}}_{yy}^{-1}\big)$ used as an SNR and identifiability metric \cite{pintelon2012system}. To combat spectral leakage from finite records and colored disturbances, we employ (i) discrete prodding at well-separated lines, (ii) multi-taper or local-polynomial FRF estimators for leakage correction, and (iii) bootstrapped confidence bands \cite{pintelon2012system}. Because SAI might be operated in feedback \cite{macmartin2014dynamicsof}, we also use an instrumental-variables FRF estimator,
\begin{equation}
\widehat{\mathbf{G}}_{\mathrm{IV}}(\omega_k) \;=\; \widehat{\mathbf{S}}_{yr}(\omega_k)\,\widehat{\mathbf{S}}_{ur}(\omega_k)^{-1},
\label{eq:ivfrf}
\end{equation}
where $r(t)$ is the exogenous excitation signal used to generate $u(t)$; this removes bias from correlation between $u$ and $e$ in closed loop \cite{ljung1999system,pintelon2012system}. The identified FRF is then smoothed and, when desired, projected onto a low-order rational model $G(\mathrm{e}^{\mathrm{i}\omega};\theta)$ by weighted least squares using the spectral covariance as weights (E1–E2).

Information-optimal probe design. To maximize the precision of $\theta$ in a parametric surrogate, we distribute input power across a discrete set $\Omega$ of lines by maximizing an information criterion subject to environmental and engineering constraints \cite{enhanced_6_20250812}. Let $J_k(\theta)=\partial G(\mathrm{e}^{\mathrm{i}\omega_k};\theta)/\partial\theta$ and let $W_k$ be the inverse spectral covariance of the FRF estimate. With line powers $p_k=|U(\omega_k)|^2$, an approximate Fisher information matrix is
\begin{equation}
\mathcal{I}(\theta) \;=\; \sum_{\omega_k\in\Omega} p_k\, J_k(\theta)^{\!*}\, W_k\, J_k(\theta),
\label{eq:fim}
\end{equation}
and we solve $\max_{p_k\ge 0} \;\Phi(\mathcal{I})$ (e.g., D- or A-optimality) s.t. $\sum_k p_k \le P_{\mathrm{tot}}$, crest-factor limits, and bounds on SAOD or ozone-relevant metrics. Randomized phases minimize crest factor and de-correlate nonlinear distortions \cite{pintelon2012system}. This closes the loop from identifiability analysis to active experiment design (E1,E6).

Quantifying nonlinear distortion. The BLA captures the dominant linear pathway; small but systematic harmonic and intermodulation responses encode nonlinear couplings that matter for safety and control robustness. With line-separated multisines, second-order nonlinearities populate sum- and difference-frequencies. Denoting the second-order frequency response function $H_2(\omega_i,\omega_j)$, we have
\begin{equation}
Y(\omega_i+\omega_j) \;\approx\; G(\omega_i+\omega_j)U(\omega_i+\omega_j) + H_2(\omega_i,\omega_j)U(\omega_i)U(\omega_j) + \varepsilon,
\end{equation}
so that $H_2$ can be estimated where $U(\omega_i+\omega_j)=0$ by spectral regression; more generally we fit sparse Volterra models via regularized least squares on polynomial–convolution features \cite{enhanced_12_20250812,enhanced_3_20250812}. The harmonic distortion index
\begin{equation}
\mathrm{HDI} \;=\; \frac{\sum_{\omega\in \mathcal{H}} |Y(\omega)|^2}{\sum_{\omega\in \mathcal{F}} |Y(\omega)|^2}
\end{equation}
compares power at harmonics/intermodulation lines $\mathcal{H}$ to fundamentals $\mathcal{F}$, and cross-frequency prediction error on held-out single-tone tests validates nonlinear surrogates (E2).

Windowed spectral tracking for early warning. To detect approach to instability under escalating forcing, we re-estimate $\widehat{\mathbf{G}}(\omega)$ and HDI in moving windows. Two indicators are: (i) low-frequency phase drift $\Delta\phi(\omega_{\mathrm{low}})$ toward $-\pi$ (increasing lag), and (ii) rising HDI across bands—both tested for monotonic trends and change points. We benchmark these against passive variance and lag-1 autocorrelation early-warning metrics \cite{enhanced_5_20250812} (E4). Because spectral regression conditions on the known probe, it separates trend-driven changes in internal variability from changes in the controlled pathway.

From spectra to control-ready surrogates. The identified FRF and its uncertainty inform H-infinity weights and MPC prediction models. We (i) fit low-order MIMO rational models $G(z;\theta)$ and noise models for MPC, (ii) shape sensitivity weights where coherence is high and uncertainty small, and (iii) propagate spectral covariance into parametric covariances used for robust synthesis \cite{ljung1999system,pintelon2012system}. This enables closed-loop SAI designs that trade global temperature tracking against regional hydrological stability \cite{macmartin2014dynamicsof}, and situates our active-sensing protocol within established SAI modeling programs \cite{kravitz2011thegeoengineering,tilmes2018stratospheric,richter2022assessingresponses} (E3–E5).

Algorithmic outline. Implementing E1–E2 proceeds as:
\begin{enumerate}
\item Choose a frequency grid $\Omega$ from sub-seasonal to interannual bands; solve \eqref{eq:fim} for optimal line powers under amplitude, crest factor, and SAOD constraints \cite{enhanced_6_20250812}.
\item Generate randomized-phase multisine/PRBS inputs; superimpose on a steady SAI baseline in the model.
\item Estimate $\widehat{\mathbf{G}}(\omega)$ via \eqref{eq:frf} or \eqref{eq:ivfrf} with leakage correction and multi-taper averaging; compute coherence, bootstrap CIs, and L-curve diagnostics for smoothing.
\item Fit low-order parametric models with frequency-domain weighted least squares; quantify parameter covariance.
\item Estimate sparse $H_2$ and compute HDI; validate on held-out single-tone runs.
\end{enumerate}

Practicality and governance. The multi-sine/PRBS amplitudes proposed here are small relative to SAI baselines and compatible with current Earth system modeling workflows, enabling information-efficient experiments without large climate perturbations (E6). The approach complements ongoing ensemble protocols \cite{tilmes2018stratospheric,richter2022assessingresponses} and supports risk-aware governance by quantifying uncertainty and furnishing early-warning signals \cite{robock200820reasons,keith2010researchon}. Finally, cross-model validation of spectral surrogates (idealized to ESM tiers) provides a stringent generalization test before any policy use (E5) \cite{enhanced_7_20250812}.


% === AREA: Pseudo-random binary sequences (PRBS) in climate model excitation. ===

\subsection{Pseudo-Random Binary Sequences (PRBS) for Active Excitation of Earth System Models}

We propose PRBS as a core excitation signal within our active spectroscopy framework to achieve persistent, band-limited excitation of the SAI-to-climate mapping under tight amplitude and operational constraints. PRBS are a standard tool in system identification because they (i) provide near-white spectral energy over a prescribed band, (ii) guarantee persistent excitation of a specified model order, and (iii) achieve low crest factor with simple implementation and robust closed-loop estimation properties \citep{ljung1999system,pintelon2012system}. Embedding PRBS on a steady SAI baseline enables efficient recovery of frequency response and weak nonlinearities without materially altering mean climate, thereby complementing objective-driven continuous-injection protocols used in GeoMIP and ARISE-SAI \citep{kravitz2011thegeoengineering,richter2022assessingresponses} and the closed-loop perspectives advocated by \citet{macmartin2014dynamicsof}.

Design. Let $u_k$ denote monthly SAI injection rate (TgS/yr) at discrete time $k$; we superimpose a zero-mean PRBS $\xi_k\in\{-1,+1\}$ on a baseline $\bar{u}$:
\begin{equation}
u_k \;=\; \bar{u} \;+\; A\,\xi_k, \qquad \xi_k \text{ is an $m$-sequence with dwell $T_c$ and period } L=(2^m-1)T_c.
\end{equation}
We target the monthly–interannual band $\Omega=\{\,\omega: 0.02\le f=\omega/2\pi\le 2\,\text{yr}^{-1}\,\}$ by choosing $T_c\in[1,3]$ months and $L$ so that the fundamental frequency $2\pi/L$ is below $0.02$ yr$^{-1}$ to suppress leakage and ensure dense spectral lines in $\Omega$ \citep{pintelon2012system}. To respect physical and governance constraints, the amplitude $A$ is bounded by a stratospheric aerosol optical depth (SAOD) excursion budget. Approximating SAOD dynamics by a stable first-order response with lifetime $\tau$,
\begin{equation}
x_{k+1}=(1-\Delta t/\tau)\,x_k + \kappa\,\Delta t\,u_k + w_k,
\end{equation}
the worst-case steady deviation to a constant step $A$ is $\Delta x \approx \kappa\tau A$; we therefore set $A\le A_{\max}:=\Delta x_{\max}/(\kappa\tau)$ and adopt a conservative factor for alternation in PRBS. In our E1 design this yields $A\in[0.05,0.5]$ TgS/yr around $\bar{u}\approx 5$ TgS/yr, keeping SAOD within the small-excursion regime used in SAI scenario protocols \citep{tilmes2018stratospheric,richter2022assessingresponses}.

Information optimality. For linear(ized) frequency response $H(\omega,\theta)$ between $u$ and an output $y$, the Fisher information for parameters $\theta$ under stationary noise with spectrum $S_{\varepsilon\varepsilon}(\omega)$ scales with input spectrum $S_{uu}(\omega)$ as
\begin{equation}
\mathcal{I}(\theta) \;\approx\; \int_{\Omega} \frac{\partial H^*(\omega,\theta)}{\partial \theta}\,\frac{\partial H(\omega,\theta)}{\partial \theta} \;\frac{S_{uu}(\omega)}{S_{\varepsilon\varepsilon}(\omega)}\, d\omega.
\end{equation}
PRBS approximate $S_{uu}(\omega)$ as flat over $\Omega$ while maintaining low crest factor and exact repeatability, maximizing information in directions where $\partial H/\partial\theta$ is large without overemphasizing any single line \citep{ljung1999system,pintelon2012system}. Compared with single-tone or narrowband multisines, PRBS therefore improves parameter covariance and reduces bias under colored internal variability, especially when identification is conducted in closed loop (baseline controllers and feedbacks active), for which direct spectral estimators remain consistent with PRBS-type excitations \citep[Ch. 13]{pintelon2012system}.

Spectral estimation and leakage control. We estimate the Bode gain/phase via cross-spectral regression,
\begin{equation}
\widehat{H}(\omega)=\frac{S_{yu}(\omega)}{S_{uu}(\omega)},
\end{equation}
using periodic PRBS segments aligned to the model calendar to minimize leakage, Welch averaging across ensemble members to suppress internal variability, and the local polynomial method to reduce bias in smoothly varying $H(\omega)$ \citep{pintelon2012system}. Because the PRBS period is known, we can apply synchronous averaging across cycles to further increase SNR without increasing the mean radiative perturbation.

Nonlinear diagnostics. Although random-phase multisines isolate harmonic lines, PRBS also supports weak-nonlinearity diagnostics. We compute (i) a harmonic distortion index (HDI) by regressing $y$ on polynomial-convolution features of $u$ and attributing variance explained by second-order cross-terms, and (ii) a bispectral coherence over $\Omega$ to reveal intermodulation. The near-orthogonality of PRBS regressors improves conditioning for sparse second-order kernel recovery with lasso/elastic-net in E2, while keeping experiments short \citep{ljung1999system}.

Closed-loop compatibility and safety. PRBS are well-suited to closed-loop operation: they preserve persistent excitation under feedback, are amplitude-limited by construction, and can be ramped in/out to avoid shocks \citep{ljung1999system,pintelon2012system}. This aligns with risk-aware SAI experimentation in comprehensive models and ensembles \citep{tilmes2018stratospheric,richter2022assessingresponses} and complements the governance-oriented caution that interventions should be minimally invasive and reversible \citep{robock200820reasons,keith2010researchon}.

Implementation in our protocol. 
- E1 (identifiability): We compare PRBS against random-phase multisines at equal RMS and duration, optimizing $A,T_c,L$ to maximize the predicted Fisher information subject to SAOD and ozone proxies. Metrics include SNR, parameter covariance, and FRF smoothness \citep{pintelon2012system}. 
- E2 (nonlinearity): Use PRBS for broad-band excitation of second-order Volterra features; validate against held-out single-tone tests. 
- E3 (control): Closed-loop identification with PRBS superimposed on MPC/H-infinity baselines reduces model-plant mismatch for controller synthesis \citep{macmartin2014dynamicsof}. 
- E4 (early warning): Track sliding-window phase and HDI under PRBS; rising phase lag toward $-\pi$ and growth in HDI at low frequencies serve as early indicators of instability, benchmarked against passive metrics. 
- E5–E6 (robustness and practicality): We quantify information gain versus probe amplitude, experiment length, and ensemble size, showing PRBS achieves target covariance at shorter durations than narrowband tests, within the computational budgets of current ESM ensembles \citep{tilmes2018stratospheric,richter2022assessingresponses}.

Trade-offs. PRBS deliver broad-band information efficiently but place spectral energy at many lines, which can mildly degrade per-line SNR compared to tailored multisines. Our hybrid design therefore deploys PRBS early to map the coarse FRF and guide subsequent narrowband multisines where sensitivity is high; both designs are supported by the same frequency-domain estimators \citep{pintelon2012system}. Overall, PRBS provide a safe, information-dense, and operationally simple backbone for active spectroscopy of the climate system under SAI.


% === AREA: Climate model emulation and surrogate modeling techniques. ===

\subsection{Spectroscopy-Compatible Emulation for Identification, Control, and Early Warning}
\label{subsec:emulation}

Earth system models (ESMs) with interactive stratospheric aerosols are indispensable for evaluating SAI strategies, yet they are too computationally intensive to support the repeated experiments demanded by input design, controller synthesis, and sequential re-identification. We therefore introduce an emulation layer that compresses the in-silico active spectroscopy experiments into compact, information-preserving surrogate dynamics. The emulators are purpose-built to (i) estimate frequency responses and low-order nonlinear distortions from designed multi-sine/PRBS/chirp perturbations, (ii) propagate uncertainty into robust controllers, and (iii) deliver early-warning indicators based on phase-lag drift and harmonic growth. The approach leverages frequency-domain system identification and optimal input design to achieve data efficiency and identifiability \cite{ljung1999system, pintelon2012system}, while staying grounded in SAI modeling practice through large-ensemble and protocolized simulations \cite{tilmes2018stratospheric, kravitz2011thegeoengineering, richter2022assessingresponses}. The surrogates close the loop to control designs explored for solar geoengineering \cite{macmartin2014dynamicsof} and provide a vehicle for systematic risk evaluation in line with broader governance concerns \cite{robock200820reasons, keith2010researchon}.

We linearize around a steady baseline injection and write the multi-output response as
\begin{equation}
y(t) \;=\; G(q;\theta)\,u(t) \;+\; y_{\text{nl}}(t;\kappa) \;+\; w(t),
\label{eq:io}
\end{equation}
where $u(t)$ is the SAI perturbation (e.g., multi-sine), $G(q;\theta)$ is a stable LTI operator with parameter vector $\theta$, $y_{\text{nl}}$ captures low-order nonlinear distortions with parameters $\kappa$, and $w$ is colored internal variability. Outputs $y$ include global-mean surface temperature, regional precipitation indices, circulation metrics, and stratospheric aerosol optical depth (SAOD).

\paragraph{Frequency-response emulator.} Designed multisines and PRBS ensure persistency of excitation over monthly-to-interannual bands \cite{pintelon2012system}. For a set of excited frequencies $\Omega=\{\omega_k\}$, we estimate the frequency response functions (FRFs) by spectral regression,
\begin{equation}
\widehat{G}_i(\omega_k)\;=\; \widehat{S}_{y_i u}(\omega_k)\,\widehat{S}_{uu}(\omega_k)^{-1},
\label{eq:frf}
\end{equation}
with leakage/bias correction as in \cite{pintelon2012system}. We parameterize the FRF to obtain a compact surrogate,
\begin{equation}
G_i(\mathrm{e}^{\mathrm{j}\omega};\theta_i)\;=\; \sum_{m=1}^{M} \theta_{i,m}\,\phi_m(\omega),
\end{equation}
where $\{\phi_m\}$ are smooth basis functions for log-gain and unwrapped phase. The identification solves
\begin{equation}
\min_{\theta}\; \sum_{i}\sum_{\omega_k\in\Omega} w_{i,k}\,\big\lvert \widehat{G}_i(\omega_k)-G_i(\mathrm{e}^{\mathrm{j}\omega_k};\theta_i)\big\rvert^2 \;+\; \lambda\,\mathcal{R}(\theta),
\label{eq:frf_fit}
\end{equation}
with weights $w_{i,k}$ proportional to estimated coherence and $\mathcal{R}$ enforcing smoothness. Asymptotic covariance for $\widehat{G}$ scales inversely with experiment length and input power at $\omega_k$ \cite{ljung1999system, pintelon2012system}, yielding the standard signal-to-noise ratio,
\begin{equation}
\mathrm{SNR}_i(\omega_k) \;\approx\; \frac{\lvert G_i(\omega_k)\rvert^2\,S_{uu}(\omega_k)}{S_{w_iw_i}(\omega_k)}.
\end{equation}

\paragraph{Nonlinear distortion emulator.} To capture harmonic generation and intermodulation, we adopt a second-order Volterra representation in the frequency domain \cite{ljung1999system},
\begin{equation}
Y_i(\omega)\;=\; G_i(\omega)\,U(\omega)\;+\;
\iint H^{(2)}_i(\omega_1,\omega_2)\,U(\omega_1)U(\omega_2)\,\delta(\omega_1{+}\omega_2{-}\omega)\,d\omega_1 d\omega_2 \;+\; E_i(\omega),
\label{eq:volterra}
\end{equation}
restricted to the discrete mixing set induced by the excited $\Omega$. We estimate a sparse kernel on that grid by solving
\begin{equation}
\min_{G,\;H^{(2)}}\;\big\lVert \mathbf{Y}-\mathbf{D}(G)\mathbf{U}-\mathbf{A}\big(H^{(2)}\big)\big\rVert_2^2 \;+\; \rho\,\lVert H^{(2)}\rVert_{1},
\label{eq:lasso_volterra}
\end{equation}
where $\mathbf{A}(\cdot)$ maps kernel coefficients to output at harmonics and intermodulation lines and $\mathbf{D}(G)$ is diagonal with $G(\omega_k)$ entries. A harmonic distortion index (HDI) summarizes nonlinearity,
\begin{equation}
\mathrm{HDI}_i \;=\; \frac{\sum_{\omega\in\Omega_{\text{mix}}}\lvert \mathbf{A}\big(H^{(2)}_i\big)\rvert^2}{\sum_{\omega\in\Omega}\lvert G_i(\omega)U(\omega)\rvert^2}.
\end{equation}

\paragraph{Linear predictive emulator for control.} For closed-loop design and forecasting over control horizons, we build a low-order predictive model using subspace regression on lifted features \cite{ljung1999system},
\begin{equation}
z_{t+1}\;=\;A z_t + B u_t + \eta_t,\qquad y_t \;=\; C z_t + \nu_t,
\label{eq:linear_predictor}
\end{equation}
with $z_t$ a compact state capturing dominant spectral content. This emulator is identified on the same active-probing runs and cross-validated on held-out single-tone tests. It provides the plant model required by MPC and feeds robust synthesis by furnishing uncertainty sets around $(A,B,C)$ inferred from residuals and Fisher information.

\paragraph{Information-optimal probe design under constraints.} We allocate multi-sine amplitudes and phases to maximize the Fisher information of the emulators while respecting environmental and operational bounds \cite{ljung1999system, pintelon2012system},
\begin{equation}
\max_{\{a_k,\phi_k\}}\; \Phi\big(\mathcal{I}(\theta; \{a_k,\phi_k\})\big)\quad \text{s.t.}\quad \sum_k a_k^2 \leq \bar{U}^2,\;\;\mathrm{RMS}\{\mathrm{SAOD}\}\leq \bar{S},\;\;\text{additional protocol constraints},
\label{eq:input_design}
\end{equation}
where $\Phi$ is, e.g., $\log\det$ and constraints reflect model-based safety screens (ozone, SAOD, variance) consistent with SAI protocols \cite{tilmes2018stratospheric, richter2022assessingresponses}. For linear-in-parameters FRF fits, $\mathcal{I}$ admits a closed form summing per-frequency sensitivities weighted by $S_{uu}(\omega_k)$ and noise spectra \cite{pintelon2012system}.

\paragraph{Uncertainty quantification and robust control hooks.} Emulator uncertainty is quantified by (i) asymptotic covariance from spectral regression, (ii) bootstrap across ensemble members and segments, and (iii) residual coherence tests \cite{pintelon2012system}. We map these to frequency-dependent uncertainty envelopes $\Delta G_i(\omega)$ and parametric sets for \eqref{eq:linear_predictor}. Robust controllers (e.g., $\mathcal{H}_\infty$ or constraint-based MPC) then seek to track global-mean temperature while bounding regional hydrological variance and SAOD excursions against worst-case emulators within these sets, extending prior closed-loop analyses of geoengineering \cite{macmartin2014dynamicsof}.

\paragraph{Validation and cross-model transfer.} We validate emulators hierarchically: aquaplanet or EMIC for rapid iteration, then intermediate and WACCM-like configurations with interactive aerosols \cite{tilmes2018stratospheric, richter2022assessingresponses}. Cross-model transfer is assessed by training the emulator on one tier and evaluating prediction and control performance on another (including GeoMIP-style protocols \cite{kravitz2011thegeoengineering}). Metrics include NRMSE, magnitude/phase errors, coherence, HDI, and closed-loop regret relative to an oracle with access to the full ESM.

\paragraph{Early-warning indicators from the emulator.} The emulators expose phase and harmonic structure directly. Under gradually increased baseline forcing, we monitor (i) phase-lag drift in key bands and (ii) growth in HDI. Shifts toward $-\pi$ phase and rising intermodulation at low frequencies serve as leading indicators of loss of stability in the linearized dynamics and of increasing nonlinear energy transfer, respectively. Because these indicators are computed from designed, high-SNR probes, they can be more sensitive than passive variance or autocorrelation metrics, while remaining non-invasive due to small perturbation amplitudes \cite{pintelon2012system}.

\paragraph{Computational and practical implications.} Active spectroscopy paired with emulation reduces the number and length of expensive ESM simulations required to (re-)identify the plant and update controllers. Fisher-information scaling implies that, for a target confidence in $\widehat{G}$, one can trade probe amplitude, experiment duration, and ensemble size roughly as $N\,\overline{a^2}$, subject to safety and protocol constraints \cite{ljung1999system}. Large-ensemble resources and established SAI protocols \cite{tilmes2018stratospheric, richter2022assessingresponses} provide the practical foundation for implementing this layer, while the intercomparison experience of GeoMIP \cite{kravitz2011thegeoengineering} supports cross-model validation. Together, these surrogates make it feasible to design and stress-test robust SAI controllers in-silico \cite{macmartin2014dynamicsof} and to develop early-warning diagnostics aligned with precautionary governance \cite{robock200820reasons, keith2010researchon}.


% === AREA: Optimization algorithms for multi-objective climate control. ===

\subsection{Multi-objective optimization for robust SAI control and information-optimal probing}

Stratospheric aerosol injection (SAI) entails simultaneous objectives and constraints across globally coupled subsystems: tracking a mean temperature target, limiting regional hydrological disruption, bounding aerosol optical depth and chemistry-related risks, and moderating actuation variability to avoid excitation of internal modes (e.g., QBO, monsoons) \cite{robock200820reasons, kravitz2011thegeoengineering, tilmes2018stratospheric, richter2022assessingresponses}. These trade-offs argue for an explicitly multi-objective control formulation layered on top of identified surrogate dynamics (Sec. E1–E2) and for probe designs that maximize information per unit perturbation subject to environmental limits. We leverage standard results from frequency-domain system identification \cite{ljung1999system, pintelon2012system} and optimal input design based on Fisher information \cite{enhanced_6_20250812} to parameterize uncertainty, and synthesize controllers using a combination of multi-objective MPC and H-infinity shaping that are robust across model discrepancies and internal variability \cite{macmartin2014dynamicsof, enhanced_4_20250812}.

We define the manipulated variable as the zonal-mean SAI injection rate u(k) (TgS yr^{-1}), and outputs y(k) = [T_{\mathrm{GMST}}(k), P_{\mathrm{Sahel}}(k), \mathrm{SAOD}(k), \ldots]^\top at monthly resolution. From E1–E2, we obtain a linear surrogate predictor over a receding horizon, either as an ARX/ARMAX model with frequency-calibrated coefficients or as a Koopman-regressed linear time-invariant predictor,
\[
x(k+1) = A_i x(k) + B_i u(k) + E_i w(k), \quad y(k) = C_i x(k) + D_i u(k),
\]
indexed by i \in \mathcal{M} to represent an uncertainty set spanning bootstrap realizations, identification posteriors, and cross-model surrogates for robustness (E5). The index set \mathcal{M} encodes polytopic or multi-model uncertainty propagated from spectral-regression covariance and Fisher information (Sec. E1) \cite{pintelon2012system, enhanced_9_20250812}.

We pose a vector of performance metrics over an MPC horizon N:
\[
J_{\mathrm{vec}} \equiv \Big(\, \|e_T\|_2, \ \mathrm{Var}[P], \ \|a\|_2, \ \mathrm{TV}(u), \ \mathrm{HDI}, \ \Phi_{\mathrm{lag}} \,\Big),
\]
where e_T(k) = T_{\mathrm{GMST}}(k) - r_T(k), \mathrm{Var}[P] is the predicted variance of regional precipitation indices under disturbance ensembles, a(k) proxies SAOD excursions above a policy band, \mathrm{TV}(u) = \sum_k |u(k)-u(k-1)| penalizes abrupt pulsing, \mathrm{HDI} is a harmonic distortion index derived from second-order Volterra terms (E2), and \Phi_{\mathrm{lag}} measures band-limited phase lag relative to the identified frequency response.

We scalarize this multi-objective problem using a combination of weighted sums and epsilon-constraints to trace Pareto trade-offs while respecting hard safety limits:
\begin{align}
\min_{\{u(k)\}_{k=0}^{N-1}} \; & \alpha_T \sum_{k=0}^{N-1} \|e_T(k)\|_2^2 \;+\; \alpha_P \, \mathrm{CVaR}_\beta\!\left(\Delta P_{0:N}\right) \;+\; \alpha_A \sum_{k=0}^{N-1} \|a(k)\|_2^2 \;+\; \alpha_U \sum_{k=0}^{N-1} |u(k)-u(k-1)| \label{eq:multiobj-mpc}\\
\text{s.t. } \; & x_i(k+1) = A_i x_i(k) + B_i u(k) + E_i w(k), \quad y_i(k) = C_i x_i(k) + D_i u(k), \quad \forall i \in \mathcal{M}, \ \forall k, \nonumber \\
& \underline{u} \le u(k) \le \overline{u}, \quad \underline{y} \le y_i(k) \le \overline{y}, \quad \mathrm{SAOD}_i(k) \le \mathrm{SAOD}_{\max}, \quad \forall i, k, \nonumber \\
& \mathrm{HDI}_i(k) \le \epsilon_{\mathrm{HDI}}, \quad \phi_i(\omega_b,k) \ge -\pi + \delta_\phi \ \text{for bands } \omega_b \in \Omega_{\mathrm{sentinel}}, \quad \forall i, k. \nonumber
\end{align}
Here, CVaR at level \beta penalizes the tail of regional precipitation anomalies to explicitly manage extremes (consistent with concerns about extremes under SAI \cite{enhanced_1_20250812}). Safety constraints include envelopes on SAOD and phase-lag margins in sentinel bands \Omega_{\mathrm{sentinel}} used for early warning (E4). The robust constraints are enforced scenario-wise across i \in \mathcal{M} (multi-model robustness; E5) and across disturbance samples w(k) capturing ENSO-like variability and volcanic perturbations (E3). Problem (\ref{eq:multiobj-mpc}) reduces to a convex quadratic program with linear inequalities for linear surrogates and convex risk measures; nonconvexities from HDI and phase-lag can be handled by successive convexification around the current operating point and by linearizing frequency-domain constraints using the identified Bode slopes and coherence bounds \cite{pintelon2012system, enhanced_9_20250812}.

Complementing MPC, we synthesize frequency-shaped H-infinity controllers that exploit the identified Bode structure (E2) to bound worst-case amplification across bands of concern:
\begin{align}
\min_{K} \ \gamma \quad \text{s.t.} \quad \left\| 
\begin{bmatrix}
W_S S_i(z) \\ W_T T_i(z) \\ W_U K S_i(z)
\end{bmatrix} \right\|_{\infty} < \gamma, \quad \forall i \in \mathcal{M}, \label{eq:hinf}
\end{align}
where S_i(z) = (I + G_i(z)K(z))^{-1} and T_i(z) = G_i(z)K(z)S_i(z) are the sensitivity and complementary sensitivity with respect to plant G_i identified from E1–E2; W_S, W_T and W_U are frequency weights derived from the measured gains, phase margins, and coherence to encode performance/robustness targets (e.g., attenuate interannual bands to protect monsoons while allowing low-frequency tracking). Multi-model H-infinity synthesis proceeds via standard LMI relaxations over the vertices of \mathcal{M} or via D–K iteration, and can be used either as a standalone controller or as a stabilizing inner loop beneath the multi-objective MPC outer loop \cite{macmartin2014dynamicsof, enhanced_4_20250812}.

To systematically explore policy trade-offs, we compute approximate Pareto fronts using:
(i) weighted-sum continuation by homotopy in \alpha = (\alpha_T,\alpha_P,\alpha_A,\alpha_U);
(ii) epsilon-constraint sweeps (e.g., minimize temperature RMSE subject to caps on precipitation CVaR and SAOD violations); and
(iii) normal-boundary-intersection to improve coverage of nonconvex trade-off regions.
These strategies are standard in multi-objective control and energy-management optimization and provide decision-relevant summaries of trade-offs under uncertainty \cite{enhanced_12_20250812}. We report operating points by their regret (vs. an oracle with access to the true G) and robustness margins (worst-case constraint slack across \mathcal{M}) in E3–E5.

The same optimization lens guides probe design. We shape the pulsed excitation spectrum to maximize information about frequency response and low-order nonlinearities while respecting environmental limits:
\begin{align}
\max_{\theta \in \Theta} \; & \Psi(F(\theta)) \quad \text{s.t.} \quad \mathrm{RMS}(u_\theta) \le \overline{u}_{\mathrm{RMS}}, \ \ \mathrm{SAOD}_\theta \le \mathrm{SAOD}_{\max}, \ \ \Delta \mathrm{O}_3 \le \Delta \mathrm{O}_3^{\max}, \label{eq:inputdesign}
\end{align}
where \theta parameterizes multi-sine/PRBS/chirp amplitudes and phases across monthly-to-interannual bands (E1), F(\theta) is the Fisher information matrix of the identification parameters, and \Psi is a scalar information criterion (e.g., D-optimal log det or A-optimal trace) \cite{ljung1999system, enhanced_6_20250812}. We further include a regularizer that prioritizes bands with poor coherence and large model-uncertainty weight from E2 to accelerate uncertainty reduction \cite{pintelon2012system, enhanced_2_20250812}. This yields minimally invasive, information-optimized probes that directly improve the confidence sets used in (\ref{eq:multiobj-mpc})–(\ref{eq:hinf}), thereby closing the loop between learning and control.

Implementation proceeds as follows. First, fit frequency-domain surrogates and compute uncertainty sets from E1–E2 via spectral regression and sparsity-aided Volterra estimation \cite{pintelon2012system, enhanced_12_20250812}. Second, construct W_S, W_T, W_U by mapping Bode slopes and phase margins to weights, and derive sentinel bands \Omega_{\mathrm{sentinel}} from sensitivity peaks and coherence dips. Third, solve (\ref{eq:inputdesign}) to design probes for the next identification window; and solve (\ref{eq:multiobj-mpc}) with scenario-based robustness across i \in \mathcal{M} and disturbance ensembles (E3), optionally embedding the H-infinity controller (\ref{eq:hinf}) as an inner loop. Finally, trace Pareto fronts to inform governance choices and quantify regret and robustness across cross-model tiers (E5). The workflow leverages established identification and control theory \cite{ljung1999system, pintelon2012system} and builds on prior closed-loop geoengineering studies \cite{macmartin2014dynamicsof} and large-ensemble SAI protocols \cite{tilmes2018stratospheric, richter2022assessingresponses}, while adding an explicit information-theoretic design that targets the spectral pathways by which SAI affects coupled climate variables.

This multi-objective and information-centric synthesis directly operationalizes our core hypothesis: small-amplitude, designed pulsing enables frequency-aware control that trades off competing risks, while producing early-warning sentinels (phase drift, harmonic growth) that are integrated as constraints and costs—thereby outperforming passive designs in both data-efficiency and risk management.


\section{Conclusion}

This paper presents a comprehensive framework for active spectroscopy in stratospheric aerosol injection (SAI) that integrates information-theoretic system identification with robust control design. Our approach addresses the critical challenge of understanding and controlling complex, coupled climate systems through frequency-domain analysis and multi-objective optimization.

The key contributions of this work include:

\begin{enumerate}
\item \textbf{Information-Optimal Probing}: We develop systematic approaches for designing minimally invasive excitation signals that maximize information gain while respecting environmental constraints, enabling efficient identification of SAI dynamics across multiple timescales.

\item \textbf{Frequency-Domain Surrogates}: Our framework constructs linear and nonlinear surrogate models that capture the essential spectral characteristics of SAI responses, providing computationally tractable representations for real-time control applications.

\item \textbf{Robust Multi-Objective Control}: We formulate control strategies that simultaneously address temperature targets, hydrological impacts, and safety constraints while maintaining robustness across model uncertainties and cross-model variations.

\item \textbf{Cross-Model Validation}: The proposed experimental protocols enable systematic comparison across different climate models, providing quantitative measures of transferability and structural uncertainty.

\item \textbf{Early Warning Systems}: Integration of harmonic distortion indices and phase-lag monitoring creates sentinel systems that detect emerging risks before they manifest as significant climate impacts.
\end{enumerate}

The framework's practical implementation through the five experimental protocols (E1-E5) provides a structured approach to advancing SAI research from theoretical concepts to actionable control strategies. By combining active sensing with robust control synthesis, our approach offers a path toward responsible geoengineering that minimizes environmental risks while maximizing information gain.

Future work will focus on experimental validation of the proposed protocols, refinement of surrogate models based on real-world data, and development of governance frameworks that incorporate the uncertainty quantification and risk management capabilities demonstrated here. The integration of machine learning techniques with the frequency-domain framework presents additional opportunities for adaptive identification and control in the face of evolving climate dynamics.

This research contributes to the broader goal of developing scientifically rigorous, ethically responsible approaches to climate intervention that can inform policy decisions while maintaining the highest standards of safety and environmental protection.
